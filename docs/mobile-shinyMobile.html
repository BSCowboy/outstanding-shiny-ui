<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 24 Reconstruct {shinyMobile} | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- CSS --><link rel="stylesheet" href="css/style.css">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.2/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.2/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">2</span> Discover Shiny dependencies</a></li>
<li class="book-part">From R to HTML: discover and master {htmltools}:</li>
<li><a class="" href="htmltools-overview.html"><span class="header-section-number">3</span> htmltools overview</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li class="book-part">Beautify with CSS and SASS</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">5</span> CSS for Shiny</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">6</span> Introduction to SASS</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">7</span> Beautify with fresh</a></li>
<li><a class="" href="beautify-with-bootstraplib.html"><span class="header-section-number">8</span> Beautify with bslib</a></li>
<li><a class="" href="beautify-other-tools.html"><span class="header-section-number">9</span> Other tools</a></li>
<li class="book-part">Unleash interactivity with JavaScript</li>
<li><a class="" href="survival-kit-javascript.html"><span class="header-section-number">10</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">11</span> Shiny’s internal: session and websockets</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">12</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">13</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">14</span> Hidden gems about inputs</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">15</span> Dynamically manage content with handlers</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-selection.html"><span class="header-section-number">16</span> Template selection</a></li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">17</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">18</span> Template skeleton</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">19</span> Testing and validating templates elements</a></li>
<li><a class="" href="custom-templates-inputs.html"><span class="header-section-number">20</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">21</span> Adding more interactivity</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">22</span> Introduction to {charpente}</a></li>
<li class="book-part">Case study 2: Mobile development with Shiny</li>
<li><a class="" href="mobile-shiny-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="active" href="mobile-shinyMobile.html"><span class="header-section-number">24</span> Reconstruct {shinyMobile}</a></li>
<li><a class="" href="mobile-pwa.html"><span class="header-section-number">25</span> {shinyMobile} and PWA</a></li>
<li class="book-part">Going further</li>
<li><a class="" href="going-further-reactR.html"><span class="header-section-number">26</span> R + Shiny + React: welcome {reactR}</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source</a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="mobile-shinyMobile" class="section level1">
<h1>
<span class="header-section-number">24</span> Reconstruct <code>{shinyMobile}</code><a class="anchor" aria-label="anchor" href="#mobile-shinyMobile"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Disclaimer</strong>: This section has been written and tested with Framework7 <code>5.7.14</code>.
Some feature may change in future releases.</p>
<div id="introduction-to-framework7" class="section level2">
<h2>
<span class="header-section-number">24.1</span> Introduction to Framework7<a class="anchor" aria-label="anchor" href="#introduction-to-framework7"><i class="fas fa-link"></i></a>
</h2>
<p>Framework7 is the HTML/CSS/JavaScript engine that fuels <a href="https://github.com/RinteRface/shinyMobile">shinyMobile</a>.
It is a flexible toolkit to build native looking web apps or progressive
web apps (PWA). It has an incredibly rich ecosystem:</p>
<ul>
<li>Provides a core JavaScript API, React API, Vue API, Svelte API.</li>
<li>A CLI to ease the creation of PWA, provide boilerplate and started templates.</li>
<li>A full set of native <a href="https://framework7.io/icons/">icons</a>.</li>
<li>Hundreds of components with different look for iOS and material design, even desktop.</li>
<li>A comprehensive set of <a href="https://framework7.io/docs/">documentation</a>.</li>
<li>A supportive <a href="https://forum.framework7.io/">community</a>.</li>
</ul>
</div>
<div id="initiate-the-package" class="section level2">
<h2>
<span class="header-section-number">24.2</span> Initiate the package<a class="anchor" aria-label="anchor" href="#initiate-the-package"><i class="fas fa-link"></i></a>
</h2>
<p>This is time to initialize the package structure and extract the Framework7 dependencies.
To get an idea of the package file structure, we run:</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RinteRface/charpente">charpente</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/charpente/man/get_dependency_assets.html">get_dependency_assets</a></span><span class="op">(</span><span class="st">"framework7"</span><span class="op">)</span></code></pre></div>
<pre><code>## ℹ Trying with https://data.jsdelivr.com/v1/package/npm/framework7</code></pre>
<pre><code>## ✓ Success!</code></pre>
<pre><code>## ────────────────────────────────────────────────────────────────────────────────</code></pre>
<pre><code>## $url
## [1] "https://cdn.jsdelivr.net/npm/framework7@6.0.1/"
## 
## $files
##  [1] "esm"                           "core"                         
##  [3] "components"                    "cjs"                          
##  [5] "bundle"                        "less"                         
##  [7] "lite"                          "lite-bundle"                  
##  [9] "modules"                       "types"                        
## [11] "framework7.css"                "framework7.d.ts"              
## [13] "framework7.js"                 "framework7.js.map"            
## [15] "framework7.less"               "framework7.min.css"           
## [17] "framework7.min.js"             "framework7.min.js.map"        
## [19] "framework7-bundle.css"         "framework7-bundle.js"         
## [21] "framework7-bundle.js.map"      "framework7-bundle.less"       
## [23] "framework7-bundle.min.css"     "framework7-bundle.min.js"     
## [25] "framework7-bundle.min.js.map"  "framework7-bundle-rtl.css"    
## [27] "framework7-bundle-rtl.min.css" "framework7-rtl.css"           
## [29] "framework7-rtl.min.css"        "LICENSE"                      
## [31] "package.json"                  "README.md"                    
## 
## $hasSubfolders
## [1] FALSE</code></pre>
<p>We browse to the <a href="https://framework7.io/docs/package.html">package</a> structure page,
which provides details about necessary components. We are going to use the bundle version since
the lite approach is missing several components. We therefore only need <code>framework7.bundle.min.js</code> and
<code>framework7.bundle.min.css</code>, which is the default options of <code>create_dependency</code>:</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"shinyMobile"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/charpente/man/create_charpente.html">create_charpente</a></span><span class="op">(</span><span class="va">path</span>, license <span class="op">=</span> <span class="st">"mit"</span><span class="op">)</span></code></pre></div>
<p>Once the package created and opened, we download Framework7 dependencies. We specify
the latest stable version that is <code>5.7.14</code> and we target <code>bundle.min</code> files since minified
files do not contain the code to make all components working:</p>
<div class="sourceCode" id="cb527"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/charpente/man/create_dependency.html">create_dependency</a></span><span class="op">(</span><span class="st">"framework7"</span>, tag <span class="op">=</span> <span class="st">"5.7.14"</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/charpente/man/charpente_options.html">charpente_options</a></span><span class="op">(</span>bundle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>which generates the <code>framework7-dependencies.R</code> script:</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">add_framework7_deps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">framework7_deps</span> <span class="op">&lt;-</span> <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlDependency.html">htmlDependency</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"framework7"</span>,
  version <span class="op">=</span> <span class="st">"5.7.14"</span>,
  src <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"framework7-5.7.14"</span><span class="op">)</span>,
  script <span class="op">=</span> <span class="st">"js/framework7.bundle.min.js"</span>,
  stylesheet <span class="op">=</span> <span class="st">"css/framework7.bundle.min.css"</span>,
  package <span class="op">=</span> <span class="st">"shinyMobile"</span>,
 <span class="op">)</span>
 <span class="fu">htmltools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span><span class="va">tag</span>, <span class="va">framework7_deps</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="framework7-layouts" class="section level2">
<h2>
<span class="header-section-number">24.3</span> Framework7 Layouts<a class="anchor" aria-label="anchor" href="#framework7-layouts"><i class="fas fa-link"></i></a>
</h2>
<p>Framework7 has 3 predefined layouts (Figure <a href="mobile-shinyMobile.html#fig:mobile-framework7-layouts">24.1</a>):</p>
<ul>
<li>Single page layout.</li>
<li>Multi tabs layout.</li>
<li>Split layout: this template is focused for tablet/desktop use.
It is composed of a sidebar and a main panel.</li>
</ul>
<div class="figure">
<span id="fig:mobile-framework7-layouts"></span>
<img src="images/mobile/mobile-shinymobile-single-layout.png" alt="Framework7 layouts" width="33%"><img src="images/mobile/mobile-shinymobile-tabs-layout.png" alt="Framework7 layouts" width="33%"><img src="images/mobile/mobile-shinymobile-split-layout.png" alt="Framework7 layouts" width="33%"><p class="caption">
FIGURE 24.1: Framework7 layouts
</p>
</div>
<p>Let’s start simple and select the single page layout, whose corresponding HTML is
given by:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb529-1"><a href="mobile-shinyMobile.html#cb529-1"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb529-2"><a href="mobile-shinyMobile.html#cb529-2"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb529-3"><a href="mobile-shinyMobile.html#cb529-3"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb529-4"><a href="mobile-shinyMobile.html#cb529-4"></a>    <span class="co">&lt;!-- Required meta tags--&gt;</span></span>
<span id="cb529-5"><a href="mobile-shinyMobile.html#cb529-5"></a>    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">"utf-8"</span><span class="kw">&gt;</span></span>
<span id="cb529-6"><a href="mobile-shinyMobile.html#cb529-6"></a>    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">"viewport"</span><span class="ot"> content=</span><span class="st">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover"</span><span class="kw">&gt;</span></span>
<span id="cb529-7"><a href="mobile-shinyMobile.html#cb529-7"></a>    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">"apple-mobile-web-app-capable"</span><span class="ot"> content=</span><span class="st">"yes"</span><span class="kw">&gt;</span></span>
<span id="cb529-8"><a href="mobile-shinyMobile.html#cb529-8"></a>    <span class="co">&lt;!-- Color theme for statusbar (Android only) --&gt;</span></span>
<span id="cb529-9"><a href="mobile-shinyMobile.html#cb529-9"></a>    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">"theme-color"</span><span class="ot"> content=</span><span class="st">"#2196f3"</span><span class="kw">&gt;</span></span>
<span id="cb529-10"><a href="mobile-shinyMobile.html#cb529-10"></a>    <span class="co">&lt;!-- Your app title --&gt;</span></span>
<span id="cb529-11"><a href="mobile-shinyMobile.html#cb529-11"></a>    <span class="kw">&lt;title&gt;</span>My App<span class="kw">&lt;/title&gt;</span></span>
<span id="cb529-12"><a href="mobile-shinyMobile.html#cb529-12"></a>    <span class="co">&lt;!-- Path to Framework7 Library Bundle CSS --&gt;</span></span>
<span id="cb529-13"><a href="mobile-shinyMobile.html#cb529-13"></a>    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">"stylesheet"</span><span class="ot"> href=</span><span class="st">"path/to/framework7.bundle.min.css"</span><span class="kw">&gt;</span></span>
<span id="cb529-14"><a href="mobile-shinyMobile.html#cb529-14"></a>    <span class="co">&lt;!-- Path to your custom app styles--&gt;</span></span>
<span id="cb529-15"><a href="mobile-shinyMobile.html#cb529-15"></a>    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">"stylesheet"</span><span class="ot"> href=</span><span class="st">"path/to/my-app.css"</span><span class="kw">&gt;</span></span>
<span id="cb529-16"><a href="mobile-shinyMobile.html#cb529-16"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb529-17"><a href="mobile-shinyMobile.html#cb529-17"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb529-18"><a href="mobile-shinyMobile.html#cb529-18"></a>    <span class="co">&lt;!-- App root element --&gt;</span></span>
<span id="cb529-19"><a href="mobile-shinyMobile.html#cb529-19"></a>    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">"app"</span><span class="kw">&gt;</span></span>
<span id="cb529-20"><a href="mobile-shinyMobile.html#cb529-20"></a></span>
<span id="cb529-21"><a href="mobile-shinyMobile.html#cb529-21"></a>      <span class="co">&lt;!-- Your main view, should have "view-main" class --&gt;</span></span>
<span id="cb529-22"><a href="mobile-shinyMobile.html#cb529-22"></a>      <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"view view-main"</span><span class="kw">&gt;</span></span>
<span id="cb529-23"><a href="mobile-shinyMobile.html#cb529-23"></a>        <span class="co">&lt;!-- Initial Page, "data-name" contains page name --&gt;</span></span>
<span id="cb529-24"><a href="mobile-shinyMobile.html#cb529-24"></a>        <span class="kw">&lt;div</span><span class="ot"> data-name=</span><span class="st">"home"</span><span class="ot"> class=</span><span class="st">"page"</span><span class="kw">&gt;</span></span>
<span id="cb529-25"><a href="mobile-shinyMobile.html#cb529-25"></a></span>
<span id="cb529-26"><a href="mobile-shinyMobile.html#cb529-26"></a>          <span class="co">&lt;!-- Top Navbar --&gt;</span></span>
<span id="cb529-27"><a href="mobile-shinyMobile.html#cb529-27"></a>          <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"navbar"</span><span class="kw">&gt;</span></span>
<span id="cb529-28"><a href="mobile-shinyMobile.html#cb529-28"></a>            <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"navbar-bg"</span><span class="kw">&gt;&lt;/div&gt;</span></span>
<span id="cb529-29"><a href="mobile-shinyMobile.html#cb529-29"></a>            <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"navbar-inner"</span><span class="kw">&gt;</span></span>
<span id="cb529-30"><a href="mobile-shinyMobile.html#cb529-30"></a>              <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"title"</span><span class="kw">&gt;</span>Awesome App<span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-31"><a href="mobile-shinyMobile.html#cb529-31"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-32"><a href="mobile-shinyMobile.html#cb529-32"></a>          <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-33"><a href="mobile-shinyMobile.html#cb529-33"></a></span>
<span id="cb529-34"><a href="mobile-shinyMobile.html#cb529-34"></a>          <span class="co">&lt;!-- Bottom Toolbar --&gt;</span></span>
<span id="cb529-35"><a href="mobile-shinyMobile.html#cb529-35"></a>          <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"toolbar toolbar-bottom"</span><span class="kw">&gt;</span></span>
<span id="cb529-36"><a href="mobile-shinyMobile.html#cb529-36"></a>            <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"toolbar-inner"</span><span class="kw">&gt;</span></span>
<span id="cb529-37"><a href="mobile-shinyMobile.html#cb529-37"></a>              <span class="co">&lt;!-- Toolbar links --&gt;</span></span>
<span id="cb529-38"><a href="mobile-shinyMobile.html#cb529-38"></a>              <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">"#"</span><span class="ot"> class=</span><span class="st">"link"</span><span class="kw">&gt;</span>Link 1<span class="kw">&lt;/a&gt;</span></span>
<span id="cb529-39"><a href="mobile-shinyMobile.html#cb529-39"></a>              <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">"#"</span><span class="ot"> class=</span><span class="st">"link"</span><span class="kw">&gt;</span>Link 2<span class="kw">&lt;/a&gt;</span></span>
<span id="cb529-40"><a href="mobile-shinyMobile.html#cb529-40"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-41"><a href="mobile-shinyMobile.html#cb529-41"></a>          <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-42"><a href="mobile-shinyMobile.html#cb529-42"></a></span>
<span id="cb529-43"><a href="mobile-shinyMobile.html#cb529-43"></a>          <span class="co">&lt;!-- Scrollable page content --&gt;</span></span>
<span id="cb529-44"><a href="mobile-shinyMobile.html#cb529-44"></a>          <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">"page-content"</span><span class="kw">&gt;</span></span>
<span id="cb529-45"><a href="mobile-shinyMobile.html#cb529-45"></a>            <span class="kw">&lt;p&gt;</span>Page content goes here<span class="kw">&lt;/p&gt;</span></span>
<span id="cb529-46"><a href="mobile-shinyMobile.html#cb529-46"></a>            <span class="co">&lt;!-- Link to another page --&gt;</span></span>
<span id="cb529-47"><a href="mobile-shinyMobile.html#cb529-47"></a>            <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">"/about/"</span><span class="kw">&gt;</span>About app<span class="kw">&lt;/a&gt;</span></span>
<span id="cb529-48"><a href="mobile-shinyMobile.html#cb529-48"></a>          <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-49"><a href="mobile-shinyMobile.html#cb529-49"></a>        <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-50"><a href="mobile-shinyMobile.html#cb529-50"></a>      <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-51"><a href="mobile-shinyMobile.html#cb529-51"></a>    <span class="kw">&lt;/div&gt;</span></span>
<span id="cb529-52"><a href="mobile-shinyMobile.html#cb529-52"></a>    <span class="co">&lt;!-- Path to Framework7 Library Bundle JS--&gt;</span></span>
<span id="cb529-53"><a href="mobile-shinyMobile.html#cb529-53"></a>    <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">"text/javascript"</span><span class="ot"> src=</span><span class="st">"path/to/framework7.bundle.min.js"</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb529-54"><a href="mobile-shinyMobile.html#cb529-54"></a>    <span class="co">&lt;!-- Path to your app js--&gt;</span></span>
<span id="cb529-55"><a href="mobile-shinyMobile.html#cb529-55"></a>    <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">"text/javascript"</span><span class="ot"> src=</span><span class="st">"path/to/my-app.js"</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb529-56"><a href="mobile-shinyMobile.html#cb529-56"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb529-57"><a href="mobile-shinyMobile.html#cb529-57"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>The <code>head</code> tag contains meta tags, some of them required for the PWA features.
The most important part is the dependencies that will be included there. Note that
the order matters: Framework7 dependencies go first, other dependencies follow.
The <code>body</code> tag is composed of several layers. The first one is the <code>app</code> root element, which
is crucial to the template initialization. We’ll come back on that point in the next section.
Then we find the <code>view view-main</code> component, inside which we find the <code>page</code>. The page contains
the <code>navbar</code>, <code>toolbar</code> (bottom bar) and the <code>page content</code>. Framework7 inserts JavaScript code
at the end of the body. Don’t worry, we can include them in the <code>head</code> as well.</p>
<p>Using <code>html_2_R</code> we convert the above code to R and extract the <code>f7_page</code> function. We replace
the title content by a title parameter, we remove all CSS and JS links since we add
them with the <code>add_dependencies</code> function applied to <code>body</code>. The page content is contained in a <code>...</code> parameter.
We also move the navbar and toolbar content to create 2 other layout functions:</p>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f7_page</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">navbar</span>, <span class="va">toolbar</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>charset <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"viewport"</span>,
        content <span class="op">=</span> <span class="st">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"apple-mobile-web-app-capable"</span>,
        content <span class="op">=</span> <span class="st">"yes"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"theme-color"</span>,
        content <span class="op">=</span> <span class="st">"#2196f3"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="va">title</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rinterface.github.io/shinyMobile/reference/add_dependencies.html">add_dependencies</a></span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">body</span><span class="op">(</span>
        <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
          id <span class="op">=</span> <span class="st">"app"</span>,
          <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
            class <span class="op">=</span> <span class="st">"view view-main"</span>,
            <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
              class <span class="op">=</span> <span class="st">"page"</span>,
              <span class="va">navbar</span>,
              <span class="va">toolbar</span>,
              <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
                class <span class="op">=</span> <span class="st">"page-content"</span>,
                <span class="va">...</span>
              <span class="op">)</span>
            <span class="op">)</span>
          <span class="op">)</span>
        <span class="op">)</span>
      <span class="op">)</span>,
      deps <span class="op">=</span> <span class="st">"framework7"</span>,
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Below are the <code>navbar</code> and <code>toolbar</code> components. The navbar has only a title parameter and
the toolbar may contain items in a <code>...</code> parameter. In practice they may contain more element
but this is enough for now:</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f7_navbar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
    class <span class="op">=</span> <span class="st">"navbar"</span>,
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>class <span class="op">=</span> <span class="st">"navbar-bg"</span><span class="op">)</span>,
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
      class <span class="op">=</span> <span class="st">"navbar-inner"</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"title"</span>,
        <span class="va">title</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">f7_toolbar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
    class <span class="op">=</span> <span class="st">"toolbar toolbar-bottom"</span>,
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
      class <span class="op">=</span> <span class="st">"toolbar-inner"</span>,
      <span class="va">...</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Don’t forget to regularly insert roxygen documentation with the insert roxygen skeleton
RStudio feature.</p>
<p>At that point, we can try to run a simple shiny app. Best practice is to save the <code>app.R</code> file in
the <code>inst/examples</code> folder:</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://shiny.rstudio.com">shiny</a></span><span class="op">)</span>

<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">f7_page</span><span class="op">(</span>
  <span class="st">"Test"</span>,
  navbar <span class="op">=</span> <span class="fu">f7_navbar</span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span>,
  toolbar <span class="op">=</span> <span class="fu">f7_toolbar</span><span class="op">(</span><span class="op">)</span>,
  title <span class="op">=</span> <span class="st">"shinyMobile"</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>
<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>which displays nothing, but returns no error. We are actually missing the app initialization step.</p>
</div>
<div id="app-initialization-1" class="section level2">
<h2>
<span class="header-section-number">24.4</span> App initialization<a class="anchor" aria-label="anchor" href="#app-initialization-1"><i class="fas fa-link"></i></a>
</h2>
<p>This step is mandatory to activate all template components (router, panels, …).
We create a custom script with <code>create_js</code>:</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/charpente/man/create_file.html">create_js</a></span><span class="op">(</span><span class="st">"init"</span><span class="op">)</span></code></pre></div>
<p>and add the following piece of JS inside:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb534-1"><a href="mobile-shinyMobile.html#cb534-1"></a><span class="at">$</span>( document ).<span class="at">ready</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb534-2"><a href="mobile-shinyMobile.html#cb534-2"></a>  <span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(<span class="op">{</span></span>
<span id="cb534-3"><a href="mobile-shinyMobile.html#cb534-3"></a>    <span class="co">// App root element</span></span>
<span id="cb534-4"><a href="mobile-shinyMobile.html#cb534-4"></a>    <span class="dt">root</span><span class="op">:</span> <span class="st">'#app'</span><span class="op">,</span></span>
<span id="cb534-5"><a href="mobile-shinyMobile.html#cb534-5"></a>    <span class="co">// App Name</span></span>
<span id="cb534-6"><a href="mobile-shinyMobile.html#cb534-6"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb534-7"><a href="mobile-shinyMobile.html#cb534-7"></a>    <span class="co">// other options</span></span>
<span id="cb534-8"><a href="mobile-shinyMobile.html#cb534-8"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb534-9"><a href="mobile-shinyMobile.html#cb534-9"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>This script creates the app instance so as to be able to use <a href="https://framework7.io/docs/app.html#app-methods-properties">methods</a>,
get other information, interact with layout elements and listen to app events (offline, online, …).
Since the root element is a direct child of the body, the <code>root</code> property is not
mandatory. The full configuration list may be found <a href="https://framework7.io/docs/app.html">here</a>.
The next step is to initialize the main view, we add this line right after the app creation:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb535-1"><a href="mobile-shinyMobile.html#cb535-1"></a><span class="kw">var</span> mainView <span class="op">=</span> <span class="va">app</span>.<span class="va">views</span>.<span class="at">create</span>(<span class="st">'.view-main'</span>)<span class="op">;</span></span></code></pre></div>
<p>Once done, we compress the corresponding JS file to create the <code>shinyMobile.min.js</code> code
and update the <code>f7_page</code> to include the new dependency, after the Framework7 one:</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/charpente/man/build_js.html">build_js</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># updated f7_page</span>
<span class="va">f7_page</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">navbar</span>, <span class="va">toolbar</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>charset <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"viewport"</span>,
        content <span class="op">=</span> <span class="st">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"apple-mobile-web-app-capable"</span>,
        content <span class="op">=</span> <span class="st">"yes"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"theme-color"</span>,
        content <span class="op">=</span> <span class="st">"#2196f3"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="va">title</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rinterface.github.io/shinyMobile/reference/add_dependencies.html">add_dependencies</a></span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">body</span><span class="op">(</span>
        <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
          id <span class="op">=</span> <span class="st">"app"</span>,
          <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
            class <span class="op">=</span> <span class="st">"view view-main"</span>,
            <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
              class <span class="op">=</span> <span class="st">"page"</span>,
              <span class="va">navbar</span>,
              <span class="va">toolbar</span>,
              <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
                class <span class="op">=</span> <span class="st">"page-content"</span>,
                <span class="va">...</span>
              <span class="op">)</span>
            <span class="op">)</span>
          <span class="op">)</span>
        <span class="op">)</span>
      <span class="op">)</span>,
      deps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"framework7"</span>, <span class="st">"shinyMobile"</span><span class="op">)</span>,
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>If you run the previous app again, it should work as shown on Figure <a href="mobile-shinyMobile.html#fig:mobile-shinyMobile-firstapp">24.2</a>.
The right panel displays the developer tools inside which we can seamlessly debug the JS code, by
leveraging source maps.</p>
<div class="figure">
<span id="fig:mobile-shinyMobile-firstapp"></span>
<img src="images/mobile/mobile-shinyMobile-firstapp.png" alt="First working {shinyMobile} app" width="100%"><p class="caption">
FIGURE 24.2: First working {shinyMobile} app
</p>
</div>
<p>From now, we can add a welcome notification message leveraging the <a href="https://framework7.io/docs/notification.html">notification</a> API.
There are 2 steps:</p>
<ul>
<li>Create the notification instance with <code>app.notification.create(parameters)</code>.</li>
<li>Tell the app to open the notification at start with <code>app.notification.open()</code>.</li>
</ul>
<p>We add the following code to <code>init.js</code> and call <code><a href="https://rdrr.io/pkg/charpente/man/build_js.html">build_js()</a></code>:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb537-1"><a href="mobile-shinyMobile.html#cb537-1"></a><span class="kw">var</span> notification <span class="op">=</span> <span class="va">app</span>.<span class="va">notification</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb537-2"><a href="mobile-shinyMobile.html#cb537-2"></a>  <span class="dt">text</span><span class="op">:</span> <span class="st">'Welcome to shinyMobile!'</span><span class="op">,</span></span>
<span id="cb537-3"><a href="mobile-shinyMobile.html#cb537-3"></a>  <span class="dt">on</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb537-4"><a href="mobile-shinyMobile.html#cb537-4"></a>    <span class="dt">opened</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb537-5"><a href="mobile-shinyMobile.html#cb537-5"></a>      <span class="va">console</span>.<span class="at">log</span>(<span class="st">'Notification opened'</span>)</span>
<span id="cb537-6"><a href="mobile-shinyMobile.html#cb537-6"></a>    <span class="op">}</span></span>
<span id="cb537-7"><a href="mobile-shinyMobile.html#cb537-7"></a>  <span class="op">}</span></span>
<span id="cb537-8"><a href="mobile-shinyMobile.html#cb537-8"></a><span class="op">}</span>).<span class="at">open</span>()<span class="op">;</span></span></code></pre></div>
<p>It will open at start up and close on swipe gesture. The Framework7 API is quite easy to
understand and extremely powerful.</p>
</div>
<div id="app-configuration" class="section level2">
<h2>
<span class="header-section-number">24.5</span> App configuration<a class="anchor" aria-label="anchor" href="#app-configuration"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://framework7.io/docs/app.html">app</a> object has a tremendous amount of methods and parameters.
In this section, we briefly describe the most significant and how to set it up.
Among all parameters, there are metadata parameters like <strong>name</strong> and <strong>version</strong>. Once the app initialized, all
app parameters are accessible with the <code>.</code> notation. For instance, if you setup a version number it is accessible
with <code>app.version</code>.</p>
<div id="global-theme" class="section level3">
<h3>
<span class="header-section-number">24.5.1</span> Global theme<a class="anchor" aria-label="anchor" href="#global-theme"><i class="fas fa-link"></i></a>
</h3>
<p>One of the most important parameter is the <strong>theme</strong> that controls the overall app design (Figure <a href="mobile-shinyMobile.html#fig:mobile-framework7-themes">24.3</a>):</p>
<ul>
<li>
<code>ios</code> corresponds the iOS design.</li>
<li>
<code>md</code> to material design.</li>
<li>
<code>aurora</code> to a desktop optimized design.</li>
</ul>
<p>The good new is that if this parameter is set to <code>auto</code>, Framework7 will detect the
current device and accordingly adapt the design. Nothing prevents you from forcing the
iOS layout on android devices, even though being irrelevant. Interestingly, one may recover the
current device with <code>app.device</code>. There are many properties to <a href="https://framework7.io/docs/device.html">review</a>.</p>
<div class="figure">
<span id="fig:mobile-framework7-themes"></span>
<img src="images/mobile/mobile-shinymobile-slider-ios.png" alt="Framework7 skins: iOS (left), md (right)." width="50%"><img src="images/mobile/mobile-shinymobile-slider-md.png" alt="Framework7 skins: iOS (left), md (right)." width="50%"><p class="caption">
FIGURE 24.3: Framework7 skins: iOS (left), md (right).
</p>
</div>
</div>
<div id="global-data-and-methods" class="section level3">
<h3>
<span class="header-section-number">24.5.2</span> Global data and methods<a class="anchor" aria-label="anchor" href="#global-data-and-methods"><i class="fas fa-link"></i></a>
</h3>
<p>The <strong>data</strong> parameters allows to pass parameters between all scripts. This is a convenient place
to store global options and we will use it in the theming section. Similarly <strong>methods</strong> hosts all global
app methods. This are function you may re-use in different parts. As mentioned above we respectively access them
with <code>app.data</code> and <code>app.methods</code>.</p>
<p><strong>Important note</strong>: this feature has been removed since Framework7 6.0.0!</p>
</div>
<div id="events-1" class="section level3">
<h3>
<span class="header-section-number">24.5.3</span> Events<a class="anchor" aria-label="anchor" href="#events-1"><i class="fas fa-link"></i></a>
</h3>
<p>The app is able to emit events whenever relevant like <code>init</code>, <code>resize</code>, <code>online</code>, <code>offline</code>, which
allows to add interactivity:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb538-1"><a href="mobile-shinyMobile.html#cb538-1"></a><span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(<span class="op">{</span></span>
<span id="cb538-2"><a href="mobile-shinyMobile.html#cb538-2"></a>  <span class="dt">on</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb538-3"><a href="mobile-shinyMobile.html#cb538-3"></a>    <span class="dt">init</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb538-4"><a href="mobile-shinyMobile.html#cb538-4"></a>      <span class="va">console</span>.<span class="at">log</span>(<span class="st">'App initialized'</span>)<span class="op">;</span></span>
<span id="cb538-5"><a href="mobile-shinyMobile.html#cb538-5"></a>    <span class="op">},</span></span>
<span id="cb538-6"><a href="mobile-shinyMobile.html#cb538-6"></a>    <span class="co">// other events</span></span>
<span id="cb538-7"><a href="mobile-shinyMobile.html#cb538-7"></a>  <span class="op">}</span></span>
<span id="cb538-8"><a href="mobile-shinyMobile.html#cb538-8"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="components-configuration" class="section level3">
<h3>
<span class="header-section-number">24.5.4</span> Components configuration<a class="anchor" aria-label="anchor" href="#components-configuration"><i class="fas fa-link"></i></a>
</h3>
<p>All Framework7 components are highly customizable. Yet, if you know that some
parameters are not going to change, it is a good idea to make them global and share
across all instances. For instance, notifications have global options. Let’s add this code
to the <code>init.js</code> script inside the <code>var app = new Framework7({ ... })</code>:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb539-1"><a href="mobile-shinyMobile.html#cb539-1"></a>notification<span class="op">:</span> <span class="op">{</span></span>
<span id="cb539-2"><a href="mobile-shinyMobile.html#cb539-2"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb539-3"><a href="mobile-shinyMobile.html#cb539-3"></a>  <span class="dt">closeTimeout</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span></span>
<span id="cb539-4"><a href="mobile-shinyMobile.html#cb539-4"></a><span class="op">}</span></span></code></pre></div>
<p>This means all notifications will close after 3 seconds and have the <code>My App</code> title.
We add another notification to the <code>init.js</code> script with a delay of 1 second so as to
test this global feature. Note the use of internal Framework7 <a href="https://framework7.io/docs/utils.html#nexttick">utils</a>
<code>app.utils.nextTick</code>,
which is nothing more
than a <code>setTimeout</code>. At this point it should look like this:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb540-1"><a href="mobile-shinyMobile.html#cb540-1"></a><span class="at">$</span>( document ).<span class="at">ready</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb540-2"><a href="mobile-shinyMobile.html#cb540-2"></a> <span class="co">// create app instance</span></span>
<span id="cb540-3"><a href="mobile-shinyMobile.html#cb540-3"></a> <span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(<span class="op">{</span></span>
<span id="cb540-4"><a href="mobile-shinyMobile.html#cb540-4"></a>    <span class="co">// App root element</span></span>
<span id="cb540-5"><a href="mobile-shinyMobile.html#cb540-5"></a>    <span class="dt">root</span><span class="op">:</span> <span class="st">'#app'</span><span class="op">,</span></span>
<span id="cb540-6"><a href="mobile-shinyMobile.html#cb540-6"></a>    <span class="co">// App Name</span></span>
<span id="cb540-7"><a href="mobile-shinyMobile.html#cb540-7"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb540-8"><a href="mobile-shinyMobile.html#cb540-8"></a>    <span class="co">// other options</span></span>
<span id="cb540-9"><a href="mobile-shinyMobile.html#cb540-9"></a>    <span class="dt">notification</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb540-10"><a href="mobile-shinyMobile.html#cb540-10"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb540-11"><a href="mobile-shinyMobile.html#cb540-11"></a>      <span class="dt">closeTimeout</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span></span>
<span id="cb540-12"><a href="mobile-shinyMobile.html#cb540-12"></a>    <span class="op">}</span></span>
<span id="cb540-13"><a href="mobile-shinyMobile.html#cb540-13"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb540-14"><a href="mobile-shinyMobile.html#cb540-14"></a></span>
<span id="cb540-15"><a href="mobile-shinyMobile.html#cb540-15"></a>  <span class="co">// init main view</span></span>
<span id="cb540-16"><a href="mobile-shinyMobile.html#cb540-16"></a>  <span class="kw">var</span> mainView <span class="op">=</span> <span class="va">app</span>.<span class="va">views</span>.<span class="at">create</span>(<span class="st">'.view-main'</span>)<span class="op">;</span></span>
<span id="cb540-17"><a href="mobile-shinyMobile.html#cb540-17"></a></span>
<span id="cb540-18"><a href="mobile-shinyMobile.html#cb540-18"></a></span>
<span id="cb540-19"><a href="mobile-shinyMobile.html#cb540-19"></a>  <span class="kw">var</span> notification <span class="op">=</span> <span class="va">app</span>.<span class="va">notification</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb540-20"><a href="mobile-shinyMobile.html#cb540-20"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">'Hello, how are you?'</span><span class="op">,</span></span>
<span id="cb540-21"><a href="mobile-shinyMobile.html#cb540-21"></a>    <span class="dt">on</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb540-22"><a href="mobile-shinyMobile.html#cb540-22"></a>      <span class="dt">opened</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb540-23"><a href="mobile-shinyMobile.html#cb540-23"></a>        <span class="va">console</span>.<span class="at">log</span>(<span class="st">'Notification opened'</span>)<span class="op">;</span></span>
<span id="cb540-24"><a href="mobile-shinyMobile.html#cb540-24"></a>      <span class="op">}</span></span>
<span id="cb540-25"><a href="mobile-shinyMobile.html#cb540-25"></a>    <span class="op">}</span></span>
<span id="cb540-26"><a href="mobile-shinyMobile.html#cb540-26"></a>  <span class="op">}</span>).<span class="at">open</span>()<span class="op">;</span></span>
<span id="cb540-27"><a href="mobile-shinyMobile.html#cb540-27"></a>  </span>
<span id="cb540-28"><a href="mobile-shinyMobile.html#cb540-28"></a>  </span>
<span id="cb540-29"><a href="mobile-shinyMobile.html#cb540-29"></a>  <span class="kw">var</span> otherMessage <span class="op">=</span> <span class="va">app</span>.<span class="va">notification</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb540-30"><a href="mobile-shinyMobile.html#cb540-30"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">'You look great!'</span></span>
<span id="cb540-31"><a href="mobile-shinyMobile.html#cb540-31"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb540-32"><a href="mobile-shinyMobile.html#cb540-32"></a>  </span>
<span id="cb540-33"><a href="mobile-shinyMobile.html#cb540-33"></a>  <span class="co">// equivalent to setTimeout ...</span></span>
<span id="cb540-34"><a href="mobile-shinyMobile.html#cb540-34"></a>  <span class="va">app</span>.<span class="va">utils</span>.<span class="at">nextTick</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb540-35"><a href="mobile-shinyMobile.html#cb540-35"></a>    <span class="va">otherMessage</span>.<span class="at">open</span>()<span class="op">;</span></span>
<span id="cb540-36"><a href="mobile-shinyMobile.html#cb540-36"></a>  <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb540-37"><a href="mobile-shinyMobile.html#cb540-37"></a>  </span>
<span id="cb540-38"><a href="mobile-shinyMobile.html#cb540-38"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="other-elements" class="section level3">
<h3>
<span class="header-section-number">24.5.5</span> Other elements<a class="anchor" aria-label="anchor" href="#other-elements"><i class="fas fa-link"></i></a>
</h3>
<p>Framework7 provides mobile specific modules like <code>touch</code>, which is a long press event (here 750 ms).
This is something you can usually do on many apps. To activate that feature, we pass
the following configuration to the app parameters list:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb541-1"><a href="mobile-shinyMobile.html#cb541-1"></a>touch<span class="op">:</span> <span class="op">{</span></span>
<span id="cb541-2"><a href="mobile-shinyMobile.html#cb541-2"></a>  <span class="dt">tapHold</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb541-3"><a href="mobile-shinyMobile.html#cb541-3"></a><span class="op">}</span></span></code></pre></div>
<p>To test that component, we create a button element and add it the <code>taphold</code> event in <code>init.js</code>:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb542-1"><a href="mobile-shinyMobile.html#cb542-1"></a><span class="at">$</span>(<span class="st">'#mybutton'</span>).<span class="at">on</span>(<span class="st">'taphold'</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb542-2"><a href="mobile-shinyMobile.html#cb542-2"></a>  <span class="va">app</span>.<span class="va">dialog</span>.<span class="at">alert</span>(<span class="st">'Tap hold fired!'</span>)<span class="op">;</span></span>
<span id="cb542-3"><a href="mobile-shinyMobile.html#cb542-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>The <code>app.R</code> script should look like:</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">f7_page</span><span class="op">(</span>
  <span class="st">"Test"</span>,
  <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
    class <span class="op">=</span> <span class="st">"list inset"</span>,
    <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span>
        <span class="va">tags</span><span class="op">$</span><span class="fu">a</span><span class="op">(</span>
          href <span class="op">=</span> <span class="st">"#"</span>,
          id <span class="op">=</span> <span class="st">"mybutton"</span>,
          class <span class="op">=</span> <span class="st">"list-button color-red"</span>,
          <span class="st">"Large Red Button"</span>
        <span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  navbar <span class="op">=</span> <span class="fu">f7_navbar</span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span>,
  toolbar <span class="op">=</span> <span class="fu">f7_toolbar</span><span class="op">(</span><span class="op">)</span>,
  title <span class="op">=</span> <span class="st">"shinyMobile"</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>Once the app is running don’t forget to open the developer tools and
set the device on mobile mode (iPhone or android) since <code>taphold</code> does not fire
on desktop (Figure <a href="mobile-shinyMobile.html#fig:mobile-shinyMobile-taphold">24.4</a>).</p>
<div class="figure">
<span id="fig:mobile-shinyMobile-taphold"></span>
<img src="images/mobile/mobile-shinymobile-taphold.png" alt="Long press or taphold event" width="100%"><p class="caption">
FIGURE 24.4: Long press or taphold event
</p>
</div>
<p>An important remark is the click handling in Framework7. Framework7 has its own internal <a href="https://framework7.io/docs/view.html">router</a> that allows to pass data between pages and perform quite
advanced actions. While extremely convenient for classic web apps,
this feature is not completely suited for Shiny that does not natively support multi pages apps.
The recent <a href="https://github.com/ColinFay/brochure">work</a> in the field is promising and works well
with <a href="https://github.com/RinteRface/shinyMobile">shinyMobile</a> (see <a href="https://github.com/RinteRface/shinyMobile/issues/136">here</a>) but this is out of the scope of this chapter. The internal router has strong implications, for instance clicking on
<code>&lt;a href="https://www.google.com/"&gt;Click me&lt;/a&gt;</code> will fail, while it works like
a charm for a classic shiny app, as shown below:</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mylink</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"external"</span>, href <span class="op">=</span> <span class="st">"https://www.google.com/"</span>, <span class="st">"Click me"</span><span class="op">)</span>

<span class="co"># shinyMobile</span>
<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">f7_page</span><span class="op">(</span>
  <span class="va">mylink</span>,
  navbar <span class="op">=</span> <span class="fu">f7_navbar</span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span>,
  toolbar <span class="op">=</span> <span class="fu">f7_toolbar</span><span class="op">(</span><span class="op">)</span>,
  title <span class="op">=</span> <span class="st">"shinyMobile"</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span>

<span class="co"># classic shiny</span>
<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/fluidPage.html">fluidPage</a></span><span class="op">(</span><span class="va">mylink</span><span class="op">)</span>
<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>To fix this issue, we may pass a valid CSS selector to the <code>externalLinks</code> property of the clicks module like:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb545-1"><a href="mobile-shinyMobile.html#cb545-1"></a>clicks<span class="op">:</span> <span class="op">{</span></span>
<span id="cb545-2"><a href="mobile-shinyMobile.html#cb545-2"></a>  <span class="dt">externalLinks</span><span class="op">:</span> <span class="st">'.external'</span><span class="op">,</span></span>
<span id="cb545-3"><a href="mobile-shinyMobile.html#cb545-3"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Note</strong>: one might be tempted to target all <code>a</code> elements: this is extremely dangerous, as it also target tabs navigation, which eventually fails!</p>
<p>Add this code to the <code>init.js</code> and try the app again.</p>
</div>
<div id="allow-end-user-configuration" class="section level3">
<h3>
<span class="header-section-number">24.5.6</span> Allow end-user configuration<a class="anchor" aria-label="anchor" href="#allow-end-user-configuration"><i class="fas fa-link"></i></a>
</h3>
<p>In the above sections, we described some parameters to configure the app. Yet,
we did setup all values directly in JavaScript. How do we allow the end user to provide
external values?</p>
<p>The idea is the following:</p>
<ul>
<li>We create an options parameter in the <code>f7_page</code> function which accepts a list
of parameters.</li>
<li>We convert it to the JSON format and store it in a tag. Ideally next to the <code>body</code> element.</li>
<li>We recover those data on the JS side and update the app initialization method.</li>
</ul>
<p>The <code>f7_page</code> may be adapted:</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f7_page</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">navbar</span>, <span class="va">toolbar</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">options</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">config_tag</span> <span class="op">&lt;-</span> <span class="va">tags</span><span class="op">$</span><span class="fu">script</span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"application/json"</span>,
    `data-for` <span class="op">=</span> <span class="st">"app"</span>,
    <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">options</span>,
      auto_unbox <span class="op">=</span> <span class="cn">TRUE</span>,
      json_verbatim <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>
  <span class="op">)</span>

  <span class="co"># create body_tag</span>
  <span class="va">body_tag</span> <span class="op">&lt;-</span> <span class="va">tags</span><span class="op">$</span><span class="fu">body</span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"app"</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"view view-main"</span>,
        <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
          class <span class="op">=</span> <span class="st">"page"</span>,
          <span class="va">navbar</span>,
          <span class="va">toolbar</span>,
          <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
            class <span class="op">=</span> <span class="st">"page-content"</span>,
            <span class="va">...</span>
          <span class="op">)</span>
        <span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">config_tag</span>
  <span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">head</span><span class="op">(</span>
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>charset <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"viewport"</span>,
        content <span class="op">=</span> <span class="st">"width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"apple-mobile-web-app-capable"</span>,
        content <span class="op">=</span> <span class="st">"yes"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">meta</span><span class="op">(</span>
        name <span class="op">=</span> <span class="st">"theme-color"</span>,
        content <span class="op">=</span> <span class="st">"#2196f3"</span>
      <span class="op">)</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">title</span><span class="op">(</span><span class="va">title</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rinterface.github.io/shinyMobile/reference/add_dependencies.html">add_dependencies</a></span><span class="op">(</span>
      <span class="va">body_tag</span>,
      deps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"framework7"</span>, <span class="st">"shinyMobile"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The above code deserves some explanations. We exploit a method already defined in section <a href="shiny-input-system.html#secondary-inputs">12.2</a>.
We convert the options list to a JSON with <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">jsonlite::toJSON</a></code> and embed it in a script tag.
The <code>data-for</code> attribute with the unique id guarantees the uniqueness of our configuration script.</p>
<div class="sourceCode" id="cb547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">config_tag</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tags</a></span><span class="op">$</span><span class="fu">script</span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"application/json"</span>,
    `data-for` <span class="op">=</span> <span class="st">"app"</span>,
    <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">options</span>,
      auto_unbox <span class="op">=</span> <span class="cn">TRUE</span>,
      json_verbatim <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>We then create an intermediate <code>body_tag</code> component where we insert the configuration tag.
On the JS side, the data collection must occur before the app initialization and is quite easy
with the jQuery <code>find</code> method:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb548-1"><a href="mobile-shinyMobile.html#cb548-1"></a><span class="kw">var</span> config <span class="op">=</span> <span class="at">$</span>(document).<span class="at">find</span>(<span class="st">"script[data-for='app']"</span>)<span class="op">;</span></span>
<span id="cb548-2"><a href="mobile-shinyMobile.html#cb548-2"></a>config <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(<span class="va">config</span>.<span class="at">html</span>())<span class="op">;</span></span></code></pre></div>
<p>We can accordingly update the app initialization:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb549-1"><a href="mobile-shinyMobile.html#cb549-1"></a><span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(<span class="op">{</span></span>
<span id="cb549-2"><a href="mobile-shinyMobile.html#cb549-2"></a>    <span class="co">// App root element</span></span>
<span id="cb549-3"><a href="mobile-shinyMobile.html#cb549-3"></a>    <span class="dt">root</span><span class="op">:</span> <span class="st">'#app'</span><span class="op">,</span></span>
<span id="cb549-4"><a href="mobile-shinyMobile.html#cb549-4"></a>    <span class="co">// App Name</span></span>
<span id="cb549-5"><a href="mobile-shinyMobile.html#cb549-5"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb549-6"><a href="mobile-shinyMobile.html#cb549-6"></a>    <span class="dt">version</span><span class="op">:</span> <span class="va">config</span> .<span class="at">version</span><span class="op">,</span></span>
<span id="cb549-7"><a href="mobile-shinyMobile.html#cb549-7"></a>    <span class="co">// other options</span></span>
<span id="cb549-8"><a href="mobile-shinyMobile.html#cb549-8"></a>    <span class="dt">theme</span><span class="op">:</span> <span class="va">config</span>.<span class="at">theme</span><span class="op">,</span></span>
<span id="cb549-9"><a href="mobile-shinyMobile.html#cb549-9"></a>    <span class="dt">notification</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb549-10"><a href="mobile-shinyMobile.html#cb549-10"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb549-11"><a href="mobile-shinyMobile.html#cb549-11"></a>      <span class="dt">closeTimeout</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span></span>
<span id="cb549-12"><a href="mobile-shinyMobile.html#cb549-12"></a>    <span class="op">},</span></span>
<span id="cb549-13"><a href="mobile-shinyMobile.html#cb549-13"></a>    <span class="dt">touch</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb549-14"><a href="mobile-shinyMobile.html#cb549-14"></a>      <span class="dt">tapHold</span><span class="op">:</span> <span class="va">config</span>.<span class="at">taphold</span><span class="op">,</span></span>
<span id="cb549-15"><a href="mobile-shinyMobile.html#cb549-15"></a>    <span class="op">},</span></span>
<span id="cb549-16"><a href="mobile-shinyMobile.html#cb549-16"></a>    <span class="dt">clicks</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb549-17"><a href="mobile-shinyMobile.html#cb549-17"></a>      <span class="dt">externalLinks</span><span class="op">:</span> <span class="st">'.external'</span><span class="op">,</span></span>
<span id="cb549-18"><a href="mobile-shinyMobile.html#cb549-18"></a>    <span class="op">},</span></span>
<span id="cb549-19"><a href="mobile-shinyMobile.html#cb549-19"></a>  <span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>What happens if the user forgets to supply the version number? <code>data.version</code> is undefined
and the app still works! The biggest advantage of this approach is the fact that all <code>TRUE</code>
and <code>FALSE</code> (R) are converted to <code>true</code> and <code>false</code> (JS), which avoids unnecessary conversion steps.</p>
<p>In theory, we could do:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb550-1"><a href="mobile-shinyMobile.html#cb550-1"></a><span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(config)<span class="op">;</span></span></code></pre></div>
<p>which assumes that the user exactly knows what to provide in the list, especially mandatory elements.
Knowing the crazy number of options, it might be slightly too complex for a new user.
What we suggest is to extract the most important components as direct <code>f7_page</code> parameters and
keep less important parameters in the options list. For example,
if you think that <strong>theme</strong> is super important (and it truly is), you could do:</p>
<div class="sourceCode" id="cb551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f7_page</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">navbar</span>, <span class="va">toolbar</span>, <span class="va">theme</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ios"</span>, <span class="st">"md"</span>, <span class="st">"aurora"</span><span class="op">)</span>, 
                    <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">options</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html">match.arg</a></span><span class="op">(</span><span class="va">theme</span><span class="op">)</span>
  <span class="va">options</span><span class="op">$</span><span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span>
  
  <span class="va">config_tag</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">tags</a></span><span class="op">$</span><span class="fu">script</span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"application/json"</span>,
    `data-for` <span class="op">=</span> <span class="st">"app"</span>,
    <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">options</span>,
      auto_unbox <span class="op">=</span> <span class="cn">TRUE</span>,
      json_verbatim <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>
  <span class="op">)</span>
  
<span class="co"># ...</span>
  
<span class="op">}</span></code></pre></div>
<p>which makes the API a bit more accessible (event though more complex to maintain)
and you only need to add one line of documentation in the roxygen part.
It would be disheartening to redirect them to the Framework7 API documentation and have to
look for the relevant option!</p>
<p>Don’t forget that since <code>config</code> is an object,
you may add any other properties, methods, on the fly with the <code>.</code> notation or <code>app.utils.extend</code>.</p>
</div>
</div>
<div id="theming-and-colors" class="section level2">
<h2>
<span class="header-section-number">24.6</span> Theming and colors<a class="anchor" aria-label="anchor" href="#theming-and-colors"><i class="fas fa-link"></i></a>
</h2>
<p>Framework7 has 15 color <a href="https://framework7.io/docs/color-themes.html?theme=light&amp;bars=empty&amp;color=%09+%23673ab7">themes</a> with a dark/light global appearance. To apply them, we add <code>color-theme-COLOR</code> to the
parent element. Best practice is to target the <code>body</code> since its the parent of all the page
content. This ensures global consistency. The dark theme is triggered by adding the
<code>theme-dark</code> class to <code>html</code>. Since <code>body</code> belongs to <code>f7_page</code> but not <code>html</code> (added by
Shiny at startup), we can apply the color in R but the dark mode has to be activated
from JS:</p>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f7_page</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">navbar</span>, <span class="va">toolbar</span>, <span class="va">theme</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ios"</span>, <span class="st">"md"</span>, <span class="st">"aurora"</span><span class="op">)</span>, 
                    <span class="va">color</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">options</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">body_cl</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="va">body_cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"color-theme-color"</span><span class="op">)</span>
  
  <span class="co"># Modify the body tag to add a class</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">body</span><span class="op">(</span>
    class <span class="op">=</span> <span class="va">body_cl</span>,
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"app"</span>,
      <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"view view-main"</span>,
        <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
          class <span class="op">=</span> <span class="st">"page"</span>,
          <span class="va">navbar</span>,
          <span class="va">toolbar</span>,
          <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
            class <span class="op">=</span> <span class="st">"page-content"</span>,
            <span class="va">...</span>
          <span class="op">)</span>
        <span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">config_tag</span>
  <span class="op">)</span>
  
  <span class="co"># ...</span>
  
<span class="op">}</span></code></pre></div>
<p>This approach assumes the user to pass the color name as parameter like <code>pink</code>, <code>yellow</code>.
What if we want to allow more flexibility and add any existing HEX color?
Framework7 has tools, namely <code>app.utils.colorThemeCSSProperties</code>, that is a JS method
creating the required CSS on the fly depending on the provided HEX color. For instance, if we select a
cyberpunk green color:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb553-1"><a href="mobile-shinyMobile.html#cb553-1"></a><span class="va">app</span>.<span class="va">utils</span>.<span class="at">colorThemeCSSProperties</span>(<span class="st">'#42f5a1'</span>)<span class="op">;</span></span>
<span id="cb553-2"><a href="mobile-shinyMobile.html#cb553-2"></a><span class="co">// /* Custom color theme */</span></span>
<span id="cb553-3"><a href="mobile-shinyMobile.html#cb553-3"></a><span class="co">// {</span></span>
<span id="cb553-4"><a href="mobile-shinyMobile.html#cb553-4"></a><span class="co">//   "--f7-theme-color": "#42f5a1";</span></span>
<span id="cb553-5"><a href="mobile-shinyMobile.html#cb553-5"></a><span class="co">//   "--f7-theme-color-rgb": "66, 245, 161";</span></span>
<span id="cb553-6"><a href="mobile-shinyMobile.html#cb553-6"></a><span class="co">//   "--f7-theme-color-shade": "#1bf38e";</span></span>
<span id="cb553-7"><a href="mobile-shinyMobile.html#cb553-7"></a><span class="co">//   "--f7-theme-color-tint": "#69f7b4";</span></span>
<span id="cb553-8"><a href="mobile-shinyMobile.html#cb553-8"></a><span class="co">// }</span></span></code></pre></div>
<p>The commented code has to be injected in the app CSS. I personally don’t think its a problem
to look for a specific HEX code, knowing that many tools can help. Therefore, I prefer the
second approach. We edit the <code>init.js</code> code by adding the following JS snippet:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb554-1"><a href="mobile-shinyMobile.html#cb554-1"></a><span class="cf">if</span> (<span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'color'</span>)) <span class="op">{</span></span>
<span id="cb554-2"><a href="mobile-shinyMobile.html#cb554-2"></a>  <span class="kw">var</span> colorCSS <span class="op">=</span> <span class="va">app</span>.<span class="va">utils</span>.<span class="at">colorThemeCSSProperties</span>(<span class="va">config</span>.<span class="at">color</span>)<span class="op">;</span></span>
<span id="cb554-3"><a href="mobile-shinyMobile.html#cb554-3"></a>  <span class="at">$</span>(<span class="st">'&lt;style&gt;'</span>)</span>
<span id="cb554-4"><a href="mobile-shinyMobile.html#cb554-4"></a>    .<span class="at">prop</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)</span>
<span id="cb554-5"><a href="mobile-shinyMobile.html#cb554-5"></a>    .<span class="at">html</span>(<span class="vs">`:root {</span></span>
<span id="cb554-6"><a href="mobile-shinyMobile.html#cb554-6"></a><span class="vs">      --f7-theme-color: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb554-7"><a href="mobile-shinyMobile.html#cb554-7"></a><span class="vs">      --f7-theme-color-rgb: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-rgb"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb554-8"><a href="mobile-shinyMobile.html#cb554-8"></a><span class="vs">      --f7-theme-color-shade: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-shade"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb554-9"><a href="mobile-shinyMobile.html#cb554-9"></a><span class="vs">      --f7-theme-color-tint: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-tint"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb554-10"><a href="mobile-shinyMobile.html#cb554-10"></a><span class="vs">    }`</span>)</span>
<span id="cb554-11"><a href="mobile-shinyMobile.html#cb554-11"></a>    .<span class="at">appendTo</span>(<span class="st">"head"</span>)<span class="op">;</span></span>
<span id="cb554-12"><a href="mobile-shinyMobile.html#cb554-12"></a><span class="op">}</span></span></code></pre></div>
<p><code>config.hasOwnProperty('color')</code> ensures that this code does not run if color is missing from the
provided config. Then, we generate an object containing the theme color properties with <code>app.utils.colorThemeCSSProperties(config.color)</code>.
Importantly, as this is an object, we can’t insert it in a string. However, we can extract its
properties 1 by 1 to generate the relevant piece of CSS. Then we add a <code>style</code> tag to the <code>head</code>
containing the following CSS rule:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb555-1"><a href="mobile-shinyMobile.html#cb555-1"></a><span class="co">/* Custom color theme */</span></span>
<span id="cb555-2"><a href="mobile-shinyMobile.html#cb555-2"></a><span class="in">:root</span> {</span>
<span id="cb555-3"><a href="mobile-shinyMobile.html#cb555-3"></a>  --f7-theme-color: <span class="cn">#42f5a1</span><span class="op">;</span></span>
<span id="cb555-4"><a href="mobile-shinyMobile.html#cb555-4"></a>  --f7-theme-color-rgb: <span class="dv">66</span><span class="op">,</span> <span class="dv">245</span><span class="op">,</span> <span class="dv">161</span><span class="op">;</span></span>
<span id="cb555-5"><a href="mobile-shinyMobile.html#cb555-5"></a>  --f7-theme-color-shade: <span class="cn">#1bf38e</span><span class="op">;</span></span>
<span id="cb555-6"><a href="mobile-shinyMobile.html#cb555-6"></a>  --f7-theme-color-tint: <span class="cn">#69f7b4</span><span class="op">;</span></span>
<span id="cb555-7"><a href="mobile-shinyMobile.html#cb555-7"></a>}</span></code></pre></div>
<p>For each property like <code>--f7-theme-color</code>, we recover the corresponding value in the
<code>colorCSS</code> object, that is <code>colorCSS["--f7-theme-color"]</code>. Once done, recompile the JS
with <code>build_js</code> and try with the following app:</p>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/load_all.html">load_all</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">f7_page</span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"list inset"</span>,
        <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span>
            <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span>
                <span class="va">tags</span><span class="op">$</span><span class="fu">a</span><span class="op">(</span>
                    href <span class="op">=</span> <span class="st">"#"</span>,
                    id <span class="op">=</span> <span class="st">"mybutton"</span>,
                    class <span class="op">=</span> <span class="st">"list-button"</span>,
                    <span class="st">"Large Green Button"</span>
                <span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    navbar <span class="op">=</span> <span class="fu">f7_navbar</span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span>,
    toolbar <span class="op">=</span> <span class="fu">f7_toolbar</span><span class="op">(</span><span class="op">)</span>,
    title <span class="op">=</span> <span class="st">"shinyMobile"</span>,
    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="st">"ios"</span>, version <span class="op">=</span> <span class="st">"1.0.0"</span>, taphold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"#42f5a1"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>We can go further and apply the <code>filled</code> theme, which is a reverted design where all
<code>navbar</code>, <code>toolbar</code>, … are filled with the theme color. For this, we need to add the following CSS:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb557-1"><a href="mobile-shinyMobile.html#cb557-1"></a><span class="co">/* Invert navigation bars to fill style */</span></span>
<span id="cb557-2"><a href="mobile-shinyMobile.html#cb557-2"></a><span class="in">:root</span><span class="op">,</span></span>
<span id="cb557-3"><a href="mobile-shinyMobile.html#cb557-3"></a><span class="in">:root</span><span class="fu">.theme-dark</span><span class="op">,</span></span>
<span id="cb557-4"><a href="mobile-shinyMobile.html#cb557-4"></a><span class="in">:root</span> <span class="fu">.theme-dark</span> {</span>
<span id="cb557-5"><a href="mobile-shinyMobile.html#cb557-5"></a>  --f7-bars-bg-color: <span class="fu">var(</span><span class="va">--f7-theme-color</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-6"><a href="mobile-shinyMobile.html#cb557-6"></a>  --f7-bars-bg-color-rgb: <span class="fu">var(</span><span class="va">--f7-theme-color-rgb</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-7"><a href="mobile-shinyMobile.html#cb557-7"></a>  --f7-bars-translucent-opacity: <span class="dv">0.9</span><span class="op">;</span></span>
<span id="cb557-8"><a href="mobile-shinyMobile.html#cb557-8"></a>  --f7-bars-text-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-9"><a href="mobile-shinyMobile.html#cb557-9"></a>  --f7-bars-link-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-10"><a href="mobile-shinyMobile.html#cb557-10"></a>  --f7-navbar-subtitle-text-color: <span class="fu">rgba(</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">0.85</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-11"><a href="mobile-shinyMobile.html#cb557-11"></a>  --f7-bars-border-color: <span class="dv">transparent</span><span class="op">;</span></span>
<span id="cb557-12"><a href="mobile-shinyMobile.html#cb557-12"></a>  --f7-tabbar-link-active-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-13"><a href="mobile-shinyMobile.html#cb557-13"></a>  --f7-tabbar-link-inactive-color: <span class="fu">rgba(</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">0.54</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-14"><a href="mobile-shinyMobile.html#cb557-14"></a>  --f7-sheet-border-color: <span class="dv">transparent</span><span class="op">;</span></span>
<span id="cb557-15"><a href="mobile-shinyMobile.html#cb557-15"></a>  --f7-tabbar-link-active-border-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-16"><a href="mobile-shinyMobile.html#cb557-16"></a>}</span>
<span id="cb557-17"><a href="mobile-shinyMobile.html#cb557-17"></a><span class="fu">.appbar</span><span class="op">,</span></span>
<span id="cb557-18"><a href="mobile-shinyMobile.html#cb557-18"></a><span class="fu">.navbar</span><span class="op">,</span></span>
<span id="cb557-19"><a href="mobile-shinyMobile.html#cb557-19"></a><span class="fu">.toolbar</span><span class="op">,</span></span>
<span id="cb557-20"><a href="mobile-shinyMobile.html#cb557-20"></a><span class="fu">.subnavbar</span><span class="op">,</span></span>
<span id="cb557-21"><a href="mobile-shinyMobile.html#cb557-21"></a><span class="fu">.calendar-header</span><span class="op">,</span></span>
<span id="cb557-22"><a href="mobile-shinyMobile.html#cb557-22"></a><span class="fu">.calendar-footer</span> {</span>
<span id="cb557-23"><a href="mobile-shinyMobile.html#cb557-23"></a>  --f7-touch-ripple-color: <span class="fu">var(</span><span class="va">--f7-touch-ripple-white</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-24"><a href="mobile-shinyMobile.html#cb557-24"></a>  --f7-link-highlight-color: <span class="fu">var(</span><span class="va">--f7-link-highlight-white</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-25"><a href="mobile-shinyMobile.html#cb557-25"></a>  --f7-button-text-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-26"><a href="mobile-shinyMobile.html#cb557-26"></a>  --f7-button-pressed-bg-color: <span class="fu">rgba(</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">0.1</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-27"><a href="mobile-shinyMobile.html#cb557-27"></a>}</span>
<span id="cb557-28"><a href="mobile-shinyMobile.html#cb557-28"></a><span class="fu">.navbar-large-transparent</span><span class="op">,</span></span>
<span id="cb557-29"><a href="mobile-shinyMobile.html#cb557-29"></a><span class="fu">.navbar-large.navbar-transparent</span> {</span>
<span id="cb557-30"><a href="mobile-shinyMobile.html#cb557-30"></a>  --f7-navbar-large-title-text-color: <span class="cn">#000</span><span class="op">;</span></span>
<span id="cb557-31"><a href="mobile-shinyMobile.html#cb557-31"></a></span>
<span id="cb557-32"><a href="mobile-shinyMobile.html#cb557-32"></a>  <span class="va">--r</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb557-33"><a href="mobile-shinyMobile.html#cb557-33"></a>  <span class="va">--g</span>: <span class="dv">122</span><span class="op">;</span></span>
<span id="cb557-34"><a href="mobile-shinyMobile.html#cb557-34"></a>  <span class="va">--b</span>: <span class="dv">255</span><span class="op">;</span></span>
<span id="cb557-35"><a href="mobile-shinyMobile.html#cb557-35"></a>  <span class="va">--progress</span>: <span class="fu">var(</span><span class="va">--f7-navbar-large-collapse-progress</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb557-36"><a href="mobile-shinyMobile.html#cb557-36"></a>  --f7-bars-link-color: <span class="fu">rgb(</span></span>
<span id="cb557-37"><a href="mobile-shinyMobile.html#cb557-37"></a>    calc(var(--r<span class="fu">)</span> + (<span class="dv">255</span> - <span class="fu">var(</span><span class="va">--r</span><span class="fu">)</span>) * <span class="fu">var(</span><span class="va">--progress</span><span class="fu">)</span>)<span class="op">,</span></span>
<span id="cb557-38"><a href="mobile-shinyMobile.html#cb557-38"></a>    <span class="fu">calc(var(</span><span class="va">--g</span><span class="fu">)</span> <span class="op">+</span> (<span class="dv">255</span> <span class="op">-</span> <span class="fu">var(</span><span class="va">--g</span><span class="fu">)</span>) <span class="op">*</span> <span class="fu">var(</span><span class="va">--progress</span><span class="fu">))</span><span class="op">,</span></span>
<span id="cb557-39"><a href="mobile-shinyMobile.html#cb557-39"></a>    <span class="fu">calc(var(</span><span class="va">--b</span><span class="fu">)</span> <span class="op">+</span> (<span class="dv">255</span> <span class="op">-</span> <span class="fu">var(</span><span class="va">--b</span><span class="fu">)</span>) <span class="op">*</span> <span class="fu">var(</span><span class="va">--progress</span><span class="fu">))</span></span>
<span id="cb557-40"><a href="mobile-shinyMobile.html#cb557-40"></a>  )<span class="op">;</span></span>
<span id="cb557-41"><a href="mobile-shinyMobile.html#cb557-41"></a>}</span>
<span id="cb557-42"><a href="mobile-shinyMobile.html#cb557-42"></a><span class="fu">.theme-dark</span> <span class="fu">.navbar-large-transparent</span><span class="op">,</span></span>
<span id="cb557-43"><a href="mobile-shinyMobile.html#cb557-43"></a><span class="fu">.theme-dark</span> <span class="fu">.navbar-large.navbar-transparent</span> {</span>
<span id="cb557-44"><a href="mobile-shinyMobile.html#cb557-44"></a>  --f7-navbar-large-title-text-color: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb557-45"><a href="mobile-shinyMobile.html#cb557-45"></a>}</span></code></pre></div>
<p>Like above, we do this on the JS side in <code>init.js</code>:</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb558-1"><a href="mobile-shinyMobile.html#cb558-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'filled'</span>)) <span class="va">config</span>.<span class="at">filled</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb558-2"><a href="mobile-shinyMobile.html#cb558-2"></a><span class="cf">if</span> (<span class="va">config</span>.<span class="at">filled</span>) <span class="op">{</span></span>
<span id="cb558-3"><a href="mobile-shinyMobile.html#cb558-3"></a>  <span class="kw">var</span> filledCSS <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb558-4"><a href="mobile-shinyMobile.html#cb558-4"></a><span class="vs">    :root,</span></span>
<span id="cb558-5"><a href="mobile-shinyMobile.html#cb558-5"></a><span class="vs">    :root.theme-dark,</span></span>
<span id="cb558-6"><a href="mobile-shinyMobile.html#cb558-6"></a><span class="vs">    :root .theme-dark {</span></span>
<span id="cb558-7"><a href="mobile-shinyMobile.html#cb558-7"></a><span class="vs">      --f7-bars-bg-color: var(--f7-theme-color);</span></span>
<span id="cb558-8"><a href="mobile-shinyMobile.html#cb558-8"></a><span class="vs">      --f7-bars-bg-color-rgb: var(--f7-theme-color-rgb);</span></span>
<span id="cb558-9"><a href="mobile-shinyMobile.html#cb558-9"></a><span class="vs">      --f7-bars-translucent-opacity: 0.9;</span></span>
<span id="cb558-10"><a href="mobile-shinyMobile.html#cb558-10"></a><span class="vs">      --f7-bars-text-color: #fff;</span></span>
<span id="cb558-11"><a href="mobile-shinyMobile.html#cb558-11"></a><span class="vs">      --f7-bars-link-color: #fff;</span></span>
<span id="cb558-12"><a href="mobile-shinyMobile.html#cb558-12"></a><span class="vs">      --f7-navbar-subtitle-text-color: rgba(255,255,255,0.85);</span></span>
<span id="cb558-13"><a href="mobile-shinyMobile.html#cb558-13"></a><span class="vs">      --f7-bars-border-color: transparent;</span></span>
<span id="cb558-14"><a href="mobile-shinyMobile.html#cb558-14"></a><span class="vs">      --f7-tabbar-link-active-color: #fff;</span></span>
<span id="cb558-15"><a href="mobile-shinyMobile.html#cb558-15"></a><span class="vs">      --f7-tabbar-link-inactive-color: rgba(255,255,255,0.54);</span></span>
<span id="cb558-16"><a href="mobile-shinyMobile.html#cb558-16"></a><span class="vs">      --f7-sheet-border-color: transparent;</span></span>
<span id="cb558-17"><a href="mobile-shinyMobile.html#cb558-17"></a><span class="vs">      --f7-tabbar-link-active-border-color: #fff;</span></span>
<span id="cb558-18"><a href="mobile-shinyMobile.html#cb558-18"></a><span class="vs">    }</span></span>
<span id="cb558-19"><a href="mobile-shinyMobile.html#cb558-19"></a><span class="vs">    .appbar,</span></span>
<span id="cb558-20"><a href="mobile-shinyMobile.html#cb558-20"></a><span class="vs">    .navbar,</span></span>
<span id="cb558-21"><a href="mobile-shinyMobile.html#cb558-21"></a><span class="vs">    .toolbar,</span></span>
<span id="cb558-22"><a href="mobile-shinyMobile.html#cb558-22"></a><span class="vs">    .subnavbar,</span></span>
<span id="cb558-23"><a href="mobile-shinyMobile.html#cb558-23"></a><span class="vs">    .calendar-header,</span></span>
<span id="cb558-24"><a href="mobile-shinyMobile.html#cb558-24"></a><span class="vs">    .calendar-footer {</span></span>
<span id="cb558-25"><a href="mobile-shinyMobile.html#cb558-25"></a><span class="vs">      --f7-touch-ripple-color: var(--f7-touch-ripple-white);</span></span>
<span id="cb558-26"><a href="mobile-shinyMobile.html#cb558-26"></a><span class="vs">      --f7-link-highlight-color: var(--f7-link-highlight-white);</span></span>
<span id="cb558-27"><a href="mobile-shinyMobile.html#cb558-27"></a><span class="vs">      --f7-button-text-color: #fff;</span></span>
<span id="cb558-28"><a href="mobile-shinyMobile.html#cb558-28"></a><span class="vs">      --f7-button-pressed-bg-color: rgba(255,255,255,0.1);</span></span>
<span id="cb558-29"><a href="mobile-shinyMobile.html#cb558-29"></a><span class="vs">    }</span></span>
<span id="cb558-30"><a href="mobile-shinyMobile.html#cb558-30"></a><span class="vs">    .navbar-large-transparent,</span></span>
<span id="cb558-31"><a href="mobile-shinyMobile.html#cb558-31"></a><span class="vs">    .navbar-large.navbar-transparent {</span></span>
<span id="cb558-32"><a href="mobile-shinyMobile.html#cb558-32"></a><span class="vs">      --f7-navbar-large-title-text-color: #000;</span></span>
<span id="cb558-33"><a href="mobile-shinyMobile.html#cb558-33"></a><span class="vs">    </span></span>
<span id="cb558-34"><a href="mobile-shinyMobile.html#cb558-34"></a><span class="vs">      --r: 0;</span></span>
<span id="cb558-35"><a href="mobile-shinyMobile.html#cb558-35"></a><span class="vs">      --g: 122;</span></span>
<span id="cb558-36"><a href="mobile-shinyMobile.html#cb558-36"></a><span class="vs">      --b: 255;</span></span>
<span id="cb558-37"><a href="mobile-shinyMobile.html#cb558-37"></a><span class="vs">      --progress: var(--f7-navbar-large-collapse-progress);</span></span>
<span id="cb558-38"><a href="mobile-shinyMobile.html#cb558-38"></a><span class="vs">      --f7-bars-link-color: rgb(</span></span>
<span id="cb558-39"><a href="mobile-shinyMobile.html#cb558-39"></a><span class="vs">        calc(var(--r) + (255 - var(--r)) * var(--progress)),</span></span>
<span id="cb558-40"><a href="mobile-shinyMobile.html#cb558-40"></a><span class="vs">        calc(var(--g) + (255 - var(--g)) * var(--progress)),</span></span>
<span id="cb558-41"><a href="mobile-shinyMobile.html#cb558-41"></a><span class="vs">        calc(var(--b) + (255 - var(--b)) * var(--progress))</span></span>
<span id="cb558-42"><a href="mobile-shinyMobile.html#cb558-42"></a><span class="vs">      );</span></span>
<span id="cb558-43"><a href="mobile-shinyMobile.html#cb558-43"></a><span class="vs">    }</span></span>
<span id="cb558-44"><a href="mobile-shinyMobile.html#cb558-44"></a><span class="vs">    .theme-dark .navbar-large-transparent,</span></span>
<span id="cb558-45"><a href="mobile-shinyMobile.html#cb558-45"></a><span class="vs">    .theme-dark .navbar-large.navbar-transparent {</span></span>
<span id="cb558-46"><a href="mobile-shinyMobile.html#cb558-46"></a><span class="vs">      --f7-navbar-large-title-text-color: #fff;</span></span>
<span id="cb558-47"><a href="mobile-shinyMobile.html#cb558-47"></a><span class="vs">  }`</span><span class="op">;</span></span>
<span id="cb558-48"><a href="mobile-shinyMobile.html#cb558-48"></a>  </span>
<span id="cb558-49"><a href="mobile-shinyMobile.html#cb558-49"></a>  <span class="at">$</span>(<span class="st">'&lt;style&gt;'</span>)</span>
<span id="cb558-50"><a href="mobile-shinyMobile.html#cb558-50"></a>    .<span class="at">prop</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)</span>
<span id="cb558-51"><a href="mobile-shinyMobile.html#cb558-51"></a>    .<span class="at">html</span>(<span class="vs">`</span><span class="sc">${</span>filledCSS<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb558-52"><a href="mobile-shinyMobile.html#cb558-52"></a>    .<span class="at">appendTo</span>(<span class="st">"head"</span>)<span class="op">;</span></span>
<span id="cb558-53"><a href="mobile-shinyMobile.html#cb558-53"></a><span class="op">}</span></span></code></pre></div>
<p>The result is displayed on Figure @reg(fig:mobile-shinyMobile-theming). Don’t forget
to pass the <code>filled</code> property to the config list.</p>
<div class="figure">
<span id="fig:mobile-shinyMobile-theming"></span>
<img src="images/mobile/mobile-shinymobile-theming.png" alt="Filled green color theme" width="100%"><p class="caption">
FIGURE 24.5: Filled green color theme
</p>
</div>
<p>Let’s finish this section with the dark mode. We leverage the Framework7 app method
element since we could also toggle the dark mode under other circumstances. We add a
<code>toggleDarkTheme</code> function to the methods object then trigger it depending on the value
of the config. If the user don’t provide any value, we set <code>config.dark</code> to <code>false</code>:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb559-1"><a href="mobile-shinyMobile.html#cb559-1"></a><span class="va">app</span>.<span class="at">methods</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb559-2"><a href="mobile-shinyMobile.html#cb559-2"></a>  <span class="dt">toggleDarkTheme</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb559-3"><a href="mobile-shinyMobile.html#cb559-3"></a>    <span class="kw">var</span> self <span class="op">=</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb559-4"><a href="mobile-shinyMobile.html#cb559-4"></a>    <span class="kw">var</span> $html <span class="op">=</span> <span class="va">self</span>.<span class="at">$</span>(<span class="st">'html'</span>)<span class="op">;</span></span>
<span id="cb559-5"><a href="mobile-shinyMobile.html#cb559-5"></a>    <span class="va">$html</span>.<span class="at">toggleClass</span>(<span class="st">'theme-dark'</span>)<span class="op">;</span></span>
<span id="cb559-6"><a href="mobile-shinyMobile.html#cb559-6"></a>  <span class="op">}</span></span>
<span id="cb559-7"><a href="mobile-shinyMobile.html#cb559-7"></a><span class="op">}</span></span>
<span id="cb559-8"><a href="mobile-shinyMobile.html#cb559-8"></a></span>
<span id="cb559-9"><a href="mobile-shinyMobile.html#cb559-9"></a><span class="cf">if</span> (<span class="op">!</span><span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'dark'</span>)) <span class="va">config</span>.<span class="at">dark</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb559-10"><a href="mobile-shinyMobile.html#cb559-10"></a></span>
<span id="cb559-11"><a href="mobile-shinyMobile.html#cb559-11"></a><span class="cf">if</span> (<span class="va">config</span>.<span class="at">dark</span>) <span class="op">{</span></span>
<span id="cb559-12"><a href="mobile-shinyMobile.html#cb559-12"></a>  <span class="va">app</span>.<span class="va">methods</span>.<span class="at">toggleDarkTheme</span>()<span class="op">;</span></span>
<span id="cb559-13"><a href="mobile-shinyMobile.html#cb559-13"></a><span class="op">}</span></span></code></pre></div>
<p>At this point <code>init.js</code> should be:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb560-1"><a href="mobile-shinyMobile.html#cb560-1"></a><span class="at">$</span>( document ).<span class="at">ready</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb560-2"><a href="mobile-shinyMobile.html#cb560-2"></a> <span class="co">// collect all data elements stored in body</span></span>
<span id="cb560-3"><a href="mobile-shinyMobile.html#cb560-3"></a> <span class="kw">var</span> config <span class="op">=</span> <span class="at">$</span>(document).<span class="at">find</span>(<span class="st">"script[data-for='app']"</span>)<span class="op">;</span></span>
<span id="cb560-4"><a href="mobile-shinyMobile.html#cb560-4"></a> config <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(<span class="va">config</span>.<span class="at">html</span>())<span class="op">;</span></span>
<span id="cb560-5"><a href="mobile-shinyMobile.html#cb560-5"></a></span>
<span id="cb560-6"><a href="mobile-shinyMobile.html#cb560-6"></a> <span class="co">// create app instance</span></span>
<span id="cb560-7"><a href="mobile-shinyMobile.html#cb560-7"></a> <span class="kw">var</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">Framework7</span>(<span class="op">{</span></span>
<span id="cb560-8"><a href="mobile-shinyMobile.html#cb560-8"></a>    <span class="co">// App root element</span></span>
<span id="cb560-9"><a href="mobile-shinyMobile.html#cb560-9"></a>    <span class="dt">root</span><span class="op">:</span> <span class="st">'#app'</span><span class="op">,</span></span>
<span id="cb560-10"><a href="mobile-shinyMobile.html#cb560-10"></a>    <span class="co">// App Name</span></span>
<span id="cb560-11"><a href="mobile-shinyMobile.html#cb560-11"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb560-12"><a href="mobile-shinyMobile.html#cb560-12"></a>    <span class="dt">version</span><span class="op">:</span> <span class="va">config</span>.<span class="at">version</span><span class="op">,</span></span>
<span id="cb560-13"><a href="mobile-shinyMobile.html#cb560-13"></a>    <span class="co">// other options</span></span>
<span id="cb560-14"><a href="mobile-shinyMobile.html#cb560-14"></a>    <span class="dt">theme</span><span class="op">:</span> <span class="va">config</span>.<span class="at">theme</span><span class="op">,</span></span>
<span id="cb560-15"><a href="mobile-shinyMobile.html#cb560-15"></a>    <span class="dt">notification</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb560-16"><a href="mobile-shinyMobile.html#cb560-16"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">'My App'</span><span class="op">,</span></span>
<span id="cb560-17"><a href="mobile-shinyMobile.html#cb560-17"></a>      <span class="dt">closeTimeout</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span></span>
<span id="cb560-18"><a href="mobile-shinyMobile.html#cb560-18"></a>    <span class="op">},</span></span>
<span id="cb560-19"><a href="mobile-shinyMobile.html#cb560-19"></a>    <span class="dt">touch</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb560-20"><a href="mobile-shinyMobile.html#cb560-20"></a>      <span class="dt">tapHold</span><span class="op">:</span> <span class="va">config</span>.<span class="at">taphold</span><span class="op">,</span></span>
<span id="cb560-21"><a href="mobile-shinyMobile.html#cb560-21"></a>    <span class="op">},</span></span>
<span id="cb560-22"><a href="mobile-shinyMobile.html#cb560-22"></a>    <span class="dt">clicks</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb560-23"><a href="mobile-shinyMobile.html#cb560-23"></a>      <span class="dt">externalLinks</span><span class="op">:</span> <span class="st">'.external'</span><span class="op">,</span></span>
<span id="cb560-24"><a href="mobile-shinyMobile.html#cb560-24"></a>    <span class="op">},</span></span>
<span id="cb560-25"><a href="mobile-shinyMobile.html#cb560-25"></a>    <span class="dt">methods</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb560-26"><a href="mobile-shinyMobile.html#cb560-26"></a>      <span class="dt">toggleDarkTheme</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb560-27"><a href="mobile-shinyMobile.html#cb560-27"></a>        <span class="kw">var</span> self <span class="op">=</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb560-28"><a href="mobile-shinyMobile.html#cb560-28"></a>        <span class="kw">var</span> $html <span class="op">=</span> <span class="va">self</span>.<span class="at">$</span>(<span class="st">'html'</span>)<span class="op">;</span></span>
<span id="cb560-29"><a href="mobile-shinyMobile.html#cb560-29"></a>        <span class="va">$html</span>.<span class="at">toggleClass</span>(<span class="st">'theme-dark'</span>)<span class="op">;</span></span>
<span id="cb560-30"><a href="mobile-shinyMobile.html#cb560-30"></a>      <span class="op">}</span></span>
<span id="cb560-31"><a href="mobile-shinyMobile.html#cb560-31"></a>    <span class="op">},</span></span>
<span id="cb560-32"><a href="mobile-shinyMobile.html#cb560-32"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb560-33"><a href="mobile-shinyMobile.html#cb560-33"></a></span>
<span id="cb560-34"><a href="mobile-shinyMobile.html#cb560-34"></a>  <span class="co">// init main view</span></span>
<span id="cb560-35"><a href="mobile-shinyMobile.html#cb560-35"></a>  <span class="kw">var</span> mainView <span class="op">=</span> <span class="va">app</span>.<span class="va">views</span>.<span class="at">create</span>(<span class="st">'.view-main'</span>)<span class="op">;</span></span>
<span id="cb560-36"><a href="mobile-shinyMobile.html#cb560-36"></a></span>
<span id="cb560-37"><a href="mobile-shinyMobile.html#cb560-37"></a></span>
<span id="cb560-38"><a href="mobile-shinyMobile.html#cb560-38"></a>  <span class="kw">var</span> notification <span class="op">=</span> <span class="va">app</span>.<span class="va">notification</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb560-39"><a href="mobile-shinyMobile.html#cb560-39"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">'Hello, how are you?'</span><span class="op">,</span></span>
<span id="cb560-40"><a href="mobile-shinyMobile.html#cb560-40"></a>    <span class="dt">on</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb560-41"><a href="mobile-shinyMobile.html#cb560-41"></a>      <span class="dt">opened</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb560-42"><a href="mobile-shinyMobile.html#cb560-42"></a>        <span class="va">console</span>.<span class="at">log</span>(<span class="st">'Notification opened'</span>)<span class="op">;</span></span>
<span id="cb560-43"><a href="mobile-shinyMobile.html#cb560-43"></a>      <span class="op">}</span></span>
<span id="cb560-44"><a href="mobile-shinyMobile.html#cb560-44"></a>    <span class="op">}</span></span>
<span id="cb560-45"><a href="mobile-shinyMobile.html#cb560-45"></a>  <span class="op">}</span>).<span class="at">open</span>()<span class="op">;</span></span>
<span id="cb560-46"><a href="mobile-shinyMobile.html#cb560-46"></a></span>
<span id="cb560-47"><a href="mobile-shinyMobile.html#cb560-47"></a>  <span class="kw">var</span> otherMessage <span class="op">=</span> <span class="va">app</span>.<span class="va">notification</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb560-48"><a href="mobile-shinyMobile.html#cb560-48"></a>    <span class="dt">text</span><span class="op">:</span> <span class="st">'You look great!'</span></span>
<span id="cb560-49"><a href="mobile-shinyMobile.html#cb560-49"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb560-50"><a href="mobile-shinyMobile.html#cb560-50"></a></span>
<span id="cb560-51"><a href="mobile-shinyMobile.html#cb560-51"></a>  <span class="co">// equivalent to setTimeout ...</span></span>
<span id="cb560-52"><a href="mobile-shinyMobile.html#cb560-52"></a>  <span class="va">app</span>.<span class="va">utils</span>.<span class="at">nextTick</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb560-53"><a href="mobile-shinyMobile.html#cb560-53"></a>    <span class="va">otherMessage</span>.<span class="at">open</span>()<span class="op">;</span></span>
<span id="cb560-54"><a href="mobile-shinyMobile.html#cb560-54"></a>  <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb560-55"><a href="mobile-shinyMobile.html#cb560-55"></a></span>
<span id="cb560-56"><a href="mobile-shinyMobile.html#cb560-56"></a>  <span class="co">// taphold test</span></span>
<span id="cb560-57"><a href="mobile-shinyMobile.html#cb560-57"></a>  <span class="at">$</span>(<span class="st">'#mybutton'</span>).<span class="at">on</span>(<span class="st">'taphold'</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb560-58"><a href="mobile-shinyMobile.html#cb560-58"></a>    <span class="va">app</span>.<span class="va">dialog</span>.<span class="at">alert</span>(<span class="st">'Tap hold fired!'</span>)<span class="op">;</span></span>
<span id="cb560-59"><a href="mobile-shinyMobile.html#cb560-59"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb560-60"><a href="mobile-shinyMobile.html#cb560-60"></a></span>
<span id="cb560-61"><a href="mobile-shinyMobile.html#cb560-61"></a>  <span class="co">// Set color theme</span></span>
<span id="cb560-62"><a href="mobile-shinyMobile.html#cb560-62"></a>  <span class="cf">if</span> (<span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'color'</span>)) <span class="op">{</span></span>
<span id="cb560-63"><a href="mobile-shinyMobile.html#cb560-63"></a>    <span class="kw">var</span> colorCSS <span class="op">=</span> <span class="va">app</span>.<span class="va">utils</span>.<span class="at">colorThemeCSSProperties</span>(<span class="va">config</span>.<span class="at">color</span>)<span class="op">;</span></span>
<span id="cb560-64"><a href="mobile-shinyMobile.html#cb560-64"></a>    <span class="at">$</span>(<span class="st">'&lt;style&gt;'</span>)</span>
<span id="cb560-65"><a href="mobile-shinyMobile.html#cb560-65"></a>      .<span class="at">prop</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)</span>
<span id="cb560-66"><a href="mobile-shinyMobile.html#cb560-66"></a>      .<span class="at">html</span>(<span class="vs">`:root {</span></span>
<span id="cb560-67"><a href="mobile-shinyMobile.html#cb560-67"></a><span class="vs">        --f7-theme-color: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb560-68"><a href="mobile-shinyMobile.html#cb560-68"></a><span class="vs">        --f7-theme-color-rgb: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-rgb"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb560-69"><a href="mobile-shinyMobile.html#cb560-69"></a><span class="vs">        --f7-theme-color-shade: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-shade"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb560-70"><a href="mobile-shinyMobile.html#cb560-70"></a><span class="vs">        --f7-theme-color-tint: </span><span class="sc">${</span>colorCSS[<span class="st">"--f7-theme-color-tint"</span>]<span class="sc">}</span><span class="vs">;</span></span>
<span id="cb560-71"><a href="mobile-shinyMobile.html#cb560-71"></a><span class="vs">      }`</span>)</span>
<span id="cb560-72"><a href="mobile-shinyMobile.html#cb560-72"></a>      .<span class="at">appendTo</span>(<span class="st">"head"</span>)<span class="op">;</span></span>
<span id="cb560-73"><a href="mobile-shinyMobile.html#cb560-73"></a>  <span class="op">}</span></span>
<span id="cb560-74"><a href="mobile-shinyMobile.html#cb560-74"></a></span>
<span id="cb560-75"><a href="mobile-shinyMobile.html#cb560-75"></a>  <span class="co">// Filled theme</span></span>
<span id="cb560-76"><a href="mobile-shinyMobile.html#cb560-76"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'filled'</span>)) <span class="va">config</span>.<span class="at">filled</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb560-77"><a href="mobile-shinyMobile.html#cb560-77"></a>  <span class="cf">if</span> (<span class="va">config</span>.<span class="at">filled</span>) <span class="op">{</span></span>
<span id="cb560-78"><a href="mobile-shinyMobile.html#cb560-78"></a>    <span class="kw">var</span> filledCSS <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb560-79"><a href="mobile-shinyMobile.html#cb560-79"></a><span class="vs">      :root,</span></span>
<span id="cb560-80"><a href="mobile-shinyMobile.html#cb560-80"></a><span class="vs">      :root.theme-dark,</span></span>
<span id="cb560-81"><a href="mobile-shinyMobile.html#cb560-81"></a><span class="vs">      :root .theme-dark {</span></span>
<span id="cb560-82"><a href="mobile-shinyMobile.html#cb560-82"></a><span class="vs">        --f7-bars-bg-color: var(--f7-theme-color);</span></span>
<span id="cb560-83"><a href="mobile-shinyMobile.html#cb560-83"></a><span class="vs">        --f7-bars-bg-color-rgb: var(--f7-theme-color-rgb);</span></span>
<span id="cb560-84"><a href="mobile-shinyMobile.html#cb560-84"></a><span class="vs">        --f7-bars-translucent-opacity: 0.9;</span></span>
<span id="cb560-85"><a href="mobile-shinyMobile.html#cb560-85"></a><span class="vs">        --f7-bars-text-color: #fff;</span></span>
<span id="cb560-86"><a href="mobile-shinyMobile.html#cb560-86"></a><span class="vs">        --f7-bars-link-color: #fff;</span></span>
<span id="cb560-87"><a href="mobile-shinyMobile.html#cb560-87"></a><span class="vs">        --f7-navbar-subtitle-text-color: rgba(255,255,255,0.85);</span></span>
<span id="cb560-88"><a href="mobile-shinyMobile.html#cb560-88"></a><span class="vs">        --f7-bars-border-color: transparent;</span></span>
<span id="cb560-89"><a href="mobile-shinyMobile.html#cb560-89"></a><span class="vs">        --f7-tabbar-link-active-color: #fff;</span></span>
<span id="cb560-90"><a href="mobile-shinyMobile.html#cb560-90"></a><span class="vs">        --f7-tabbar-link-inactive-color: rgba(255,255,255,0.54);</span></span>
<span id="cb560-91"><a href="mobile-shinyMobile.html#cb560-91"></a><span class="vs">        --f7-sheet-border-color: transparent;</span></span>
<span id="cb560-92"><a href="mobile-shinyMobile.html#cb560-92"></a><span class="vs">        --f7-tabbar-link-active-border-color: #fff;</span></span>
<span id="cb560-93"><a href="mobile-shinyMobile.html#cb560-93"></a><span class="vs">      }</span></span>
<span id="cb560-94"><a href="mobile-shinyMobile.html#cb560-94"></a><span class="vs">      .appbar,</span></span>
<span id="cb560-95"><a href="mobile-shinyMobile.html#cb560-95"></a><span class="vs">      .navbar,</span></span>
<span id="cb560-96"><a href="mobile-shinyMobile.html#cb560-96"></a><span class="vs">      .toolbar,</span></span>
<span id="cb560-97"><a href="mobile-shinyMobile.html#cb560-97"></a><span class="vs">      .subnavbar,</span></span>
<span id="cb560-98"><a href="mobile-shinyMobile.html#cb560-98"></a><span class="vs">      .calendar-header,</span></span>
<span id="cb560-99"><a href="mobile-shinyMobile.html#cb560-99"></a><span class="vs">      .calendar-footer {</span></span>
<span id="cb560-100"><a href="mobile-shinyMobile.html#cb560-100"></a><span class="vs">        --f7-touch-ripple-color: var(--f7-touch-ripple-white);</span></span>
<span id="cb560-101"><a href="mobile-shinyMobile.html#cb560-101"></a><span class="vs">        --f7-link-highlight-color: var(--f7-link-highlight-white);</span></span>
<span id="cb560-102"><a href="mobile-shinyMobile.html#cb560-102"></a><span class="vs">        --f7-button-text-color: #fff;</span></span>
<span id="cb560-103"><a href="mobile-shinyMobile.html#cb560-103"></a><span class="vs">        --f7-button-pressed-bg-color: rgba(255,255,255,0.1);</span></span>
<span id="cb560-104"><a href="mobile-shinyMobile.html#cb560-104"></a><span class="vs">      }</span></span>
<span id="cb560-105"><a href="mobile-shinyMobile.html#cb560-105"></a><span class="vs">      .navbar-large-transparent,</span></span>
<span id="cb560-106"><a href="mobile-shinyMobile.html#cb560-106"></a><span class="vs">      .navbar-large.navbar-transparent {</span></span>
<span id="cb560-107"><a href="mobile-shinyMobile.html#cb560-107"></a><span class="vs">        --f7-navbar-large-title-text-color: #000;</span></span>
<span id="cb560-108"><a href="mobile-shinyMobile.html#cb560-108"></a><span class="vs">      </span></span>
<span id="cb560-109"><a href="mobile-shinyMobile.html#cb560-109"></a><span class="vs">        --r: 0;</span></span>
<span id="cb560-110"><a href="mobile-shinyMobile.html#cb560-110"></a><span class="vs">        --g: 122;</span></span>
<span id="cb560-111"><a href="mobile-shinyMobile.html#cb560-111"></a><span class="vs">        --b: 255;</span></span>
<span id="cb560-112"><a href="mobile-shinyMobile.html#cb560-112"></a><span class="vs">        --progress: var(--f7-navbar-large-collapse-progress);</span></span>
<span id="cb560-113"><a href="mobile-shinyMobile.html#cb560-113"></a><span class="vs">        --f7-bars-link-color: rgb(</span></span>
<span id="cb560-114"><a href="mobile-shinyMobile.html#cb560-114"></a><span class="vs">          calc(var(--r) + (255 - var(--r)) * var(--progress)),</span></span>
<span id="cb560-115"><a href="mobile-shinyMobile.html#cb560-115"></a><span class="vs">          calc(var(--g) + (255 - var(--g)) * var(--progress)),</span></span>
<span id="cb560-116"><a href="mobile-shinyMobile.html#cb560-116"></a><span class="vs">          calc(var(--b) + (255 - var(--b)) * var(--progress))</span></span>
<span id="cb560-117"><a href="mobile-shinyMobile.html#cb560-117"></a><span class="vs">        );</span></span>
<span id="cb560-118"><a href="mobile-shinyMobile.html#cb560-118"></a><span class="vs">      }</span></span>
<span id="cb560-119"><a href="mobile-shinyMobile.html#cb560-119"></a><span class="vs">      .theme-dark .navbar-large-transparent,</span></span>
<span id="cb560-120"><a href="mobile-shinyMobile.html#cb560-120"></a><span class="vs">      .theme-dark .navbar-large.navbar-transparent {</span></span>
<span id="cb560-121"><a href="mobile-shinyMobile.html#cb560-121"></a><span class="vs">        --f7-navbar-large-title-text-color: #fff;</span></span>
<span id="cb560-122"><a href="mobile-shinyMobile.html#cb560-122"></a><span class="vs">    }`</span><span class="op">;</span></span>
<span id="cb560-123"><a href="mobile-shinyMobile.html#cb560-123"></a>    </span>
<span id="cb560-124"><a href="mobile-shinyMobile.html#cb560-124"></a>    <span class="at">$</span>(<span class="st">'&lt;style&gt;'</span>)</span>
<span id="cb560-125"><a href="mobile-shinyMobile.html#cb560-125"></a>      .<span class="at">prop</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)</span>
<span id="cb560-126"><a href="mobile-shinyMobile.html#cb560-126"></a>      .<span class="at">html</span>(<span class="vs">`</span><span class="sc">${</span>filledCSS<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb560-127"><a href="mobile-shinyMobile.html#cb560-127"></a>      .<span class="at">appendTo</span>(<span class="st">"head"</span>)<span class="op">;</span></span>
<span id="cb560-128"><a href="mobile-shinyMobile.html#cb560-128"></a>  <span class="op">}</span></span>
<span id="cb560-129"><a href="mobile-shinyMobile.html#cb560-129"></a></span>
<span id="cb560-130"><a href="mobile-shinyMobile.html#cb560-130"></a>  <span class="co">// dark mode</span></span>
<span id="cb560-131"><a href="mobile-shinyMobile.html#cb560-131"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="va">config</span>.<span class="at">hasOwnProperty</span>(<span class="st">'dark'</span>)) <span class="va">config</span>.<span class="at">dark</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb560-132"><a href="mobile-shinyMobile.html#cb560-132"></a>  <span class="cf">if</span> (<span class="va">config</span>.<span class="at">dark</span>) <span class="op">{</span></span>
<span id="cb560-133"><a href="mobile-shinyMobile.html#cb560-133"></a>    <span class="va">app</span>.<span class="va">methods</span>.<span class="at">toggleDarkTheme</span>()<span class="op">;</span></span>
<span id="cb560-134"><a href="mobile-shinyMobile.html#cb560-134"></a>  <span class="op">}</span></span>
<span id="cb560-135"><a href="mobile-shinyMobile.html#cb560-135"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>and the dark mode app example:</p>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">f7_page</span><span class="op">(</span>
    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>
        class <span class="op">=</span> <span class="st">"list inset"</span>,
        <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span>
            <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span>
                <span class="va">tags</span><span class="op">$</span><span class="fu">a</span><span class="op">(</span>
                    href <span class="op">=</span> <span class="st">"#"</span>,
                    id <span class="op">=</span> <span class="st">"mybutton"</span>,
                    class <span class="op">=</span> <span class="st">"list-button"</span>,
                    <span class="st">"Large Green Button"</span>
                <span class="op">)</span>
            <span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>,
    navbar <span class="op">=</span> <span class="fu">f7_navbar</span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span>,
    toolbar <span class="op">=</span> <span class="fu">f7_toolbar</span><span class="op">(</span><span class="op">)</span>,
    title <span class="op">=</span> <span class="st">"shinyMobile"</span>,
    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      theme <span class="op">=</span> <span class="st">"ios"</span>, 
      version <span class="op">=</span> <span class="st">"1.0.0"</span>, 
      taphold <span class="op">=</span> <span class="cn">TRUE</span>, 
      color <span class="op">=</span> <span class="st">"#42f5a1"</span>, 
      filled <span class="op">=</span> <span class="cn">TRUE</span>, 
      dark <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>The overall expected result is shown Figure <a href="mobile-shinyMobile.html#fig:mobile-shinyMobile-dark">24.6</a>.</p>
<div class="figure">
<span id="fig:mobile-shinyMobile-dark"></span>
<img src="images/mobile/mobile-shinymobile-dark.png" alt="Dark mode in {shinyMobile}" width="100%"><p class="caption">
FIGURE 24.6: Dark mode in {shinyMobile}
</p>
</div>
<p>We have now set all base pieces. In the next chapter, we see how to make <a href="https://github.com/RinteRface/shinyMobile">shinyMobile</a> apps
as progressive web apps.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="mobile-shiny-intro.html"><span class="header-section-number">23</span> Introduction</a></div>
<div class="next"><a href="mobile-pwa.html"><span class="header-section-number">25</span> {shinyMobile} and PWA</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#mobile-shinyMobile"><span class="header-section-number">24</span> Reconstruct {shinyMobile}</a></li>
<li><a class="nav-link" href="#introduction-to-framework7"><span class="header-section-number">24.1</span> Introduction to Framework7</a></li>
<li><a class="nav-link" href="#initiate-the-package"><span class="header-section-number">24.2</span> Initiate the package</a></li>
<li><a class="nav-link" href="#framework7-layouts"><span class="header-section-number">24.3</span> Framework7 Layouts</a></li>
<li><a class="nav-link" href="#app-initialization-1"><span class="header-section-number">24.4</span> App initialization</a></li>
<li>
<a class="nav-link" href="#app-configuration"><span class="header-section-number">24.5</span> App configuration</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#global-theme"><span class="header-section-number">24.5.1</span> Global theme</a></li>
<li><a class="nav-link" href="#global-data-and-methods"><span class="header-section-number">24.5.2</span> Global data and methods</a></li>
<li><a class="nav-link" href="#events-1"><span class="header-section-number">24.5.3</span> Events</a></li>
<li><a class="nav-link" href="#components-configuration"><span class="header-section-number">24.5.4</span> Components configuration</a></li>
<li><a class="nav-link" href="#other-elements"><span class="header-section-number">24.5.5</span> Other elements</a></li>
<li><a class="nav-link" href="#allow-end-user-configuration"><span class="header-section-number">24.5.6</span> Allow end-user configuration</a></li>
</ul>
</li>
<li><a class="nav-link" href="#theming-and-colors"><span class="header-section-number">24.6</span> Theming and colors</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/mobile-shinyMobile.Rmd">View source</a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/mobile-shinyMobile.Rmd">Edit this page</a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It waslast built on 2021-01-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This website is produced by the <a class="text-light" href="https://bookdown.org">bookdown</a> bs4_book template.</p>
  </div>

</div></div>
</footer>
</body>
</html>
