<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Adding more interactivity | Outstanding User Interfaces with Shiny</title>
  <meta name="description" content="This book will serve as content for the 2020 erum workshop." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Adding more interactivity | Outstanding User Interfaces with Shiny" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book will serve as content for the 2020 erum workshop." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Adding more interactivity | Outstanding User Interfaces with Shiny" />
  
  <meta name="twitter:description" content="This book will serve as content for the 2020 erum workshop." />
  

<meta name="author" content="David Granjon" />


<meta name="date" content="2020-05-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="custom-templates-inputs.html"/>
<link rel="next" href="beautify-with-fresh.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Outstanding User Interfaces with Shiny</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i>Disclaimer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#is-this-book-for-me"><i class="fa fa-check"></i>Is this book for me?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#related-content"><i class="fa fa-check"></i>Related content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#preliminary-exercices"><i class="fa fa-check"></i>Preliminary exercices</a></li>
</ul></li>
<li class="part"><span><b>Survival Kit</b></span></li>
<li class="chapter" data-level="2" data-path="survival-kit-html.html"><a href="survival-kit-html.html"><i class="fa fa-check"></i><b>2</b> HTML</a><ul>
<li class="chapter" data-level="2.1" data-path="survival-kit-html.html"><a href="survival-kit-html.html#html-basics"><i class="fa fa-check"></i><b>2.1</b> HTML Basics</a></li>
<li class="chapter" data-level="2.2" data-path="survival-kit-html.html"><a href="survival-kit-html.html#tag-attributes"><i class="fa fa-check"></i><b>2.2</b> Tag attributes</a></li>
<li class="chapter" data-level="2.3" data-path="survival-kit-html.html"><a href="survival-kit-html.html#html-page-skeleton"><i class="fa fa-check"></i><b>2.3</b> HTML page: skeleton</a></li>
<li class="chapter" data-level="2.4" data-path="survival-kit-html.html"><a href="survival-kit-html.html#about-the-document-object-model-dom"><i class="fa fa-check"></i><b>2.4</b> About the Document Object Model (DOM)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="survival-kit-html.html"><a href="survival-kit-html.html#visualizing-the-dom-the-html-inspector"><i class="fa fa-check"></i><b>2.4.1</b> Visualizing the DOM: the HTML inspector</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="survival-kit-html.html"><a href="survival-kit-html.html#preliminary-introduction-to-css-and-javascript"><i class="fa fa-check"></i><b>2.5</b> Preliminary introduction to CSS and JavaScript</a><ul>
<li class="chapter" data-level="2.5.1" data-path="survival-kit-html.html"><a href="survival-kit-html.html#html-and-css"><i class="fa fa-check"></i><b>2.5.1</b> HTML and CSS</a></li>
<li class="chapter" data-level="2.5.2" data-path="survival-kit-html.html"><a href="survival-kit-html.html#html-and-javascript"><i class="fa fa-check"></i><b>2.5.2</b> HTML and JavaScript</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html"><i class="fa fa-check"></i><b>3</b> JavaScript</a><ul>
<li class="chapter" data-level="3.1" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#setup"><i class="fa fa-check"></i><b>3.2</b> Setup</a><ul>
<li class="chapter" data-level="3.2.1" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#node"><i class="fa fa-check"></i><b>3.2.1</b> Node</a></li>
<li class="chapter" data-level="3.2.2" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#choose-a-good-ide"><i class="fa fa-check"></i><b>3.2.2</b> Choose a good IDE</a></li>
<li class="chapter" data-level="3.2.3" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#first-script"><i class="fa fa-check"></i><b>3.2.3</b> First Script</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#programming-with-js-basis"><i class="fa fa-check"></i><b>3.3</b> Programming with JS: basis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#js-types"><i class="fa fa-check"></i><b>3.3.1</b> JS types</a></li>
<li class="chapter" data-level="3.3.2" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#variables"><i class="fa fa-check"></i><b>3.3.2</b> Variables</a></li>
<li class="chapter" data-level="3.3.3" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#conditions"><i class="fa fa-check"></i><b>3.3.3</b> Conditions</a></li>
<li class="chapter" data-level="3.3.4" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#objects"><i class="fa fa-check"></i><b>3.3.4</b> Objects</a></li>
<li class="chapter" data-level="3.3.5" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#iterations"><i class="fa fa-check"></i><b>3.3.5</b> Iterations</a></li>
<li class="chapter" data-level="3.3.6" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#functions"><i class="fa fa-check"></i><b>3.3.6</b> Functions</a></li>
<li class="chapter" data-level="3.3.7" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#event-listeners"><i class="fa fa-check"></i><b>3.3.7</b> Event listeners</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#jquery"><i class="fa fa-check"></i><b>3.4</b> jQuery</a><ul>
<li class="chapter" data-level="3.4.1" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#introduction-1"><i class="fa fa-check"></i><b>3.4.1</b> Introduction</a></li>
<li class="chapter" data-level="3.4.2" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#syntax"><i class="fa fa-check"></i><b>3.4.2</b> Syntax</a></li>
<li class="chapter" data-level="3.4.3" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#useful-functions"><i class="fa fa-check"></i><b>3.4.3</b> Useful functions</a></li>
<li class="chapter" data-level="3.4.4" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#chaining-jquery-methods"><i class="fa fa-check"></i><b>3.4.4</b> Chaining jQuery methods</a></li>
<li class="chapter" data-level="3.4.5" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#iterations-1"><i class="fa fa-check"></i><b>3.4.5</b> Iterations</a></li>
<li class="chapter" data-level="3.4.6" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#good-practice"><i class="fa fa-check"></i><b>3.4.6</b> Good practice</a></li>
<li class="chapter" data-level="3.4.7" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#events"><i class="fa fa-check"></i><b>3.4.7</b> Events</a></li>
<li class="chapter" data-level="3.4.8" data-path="survival-kit-javascript.html"><a href="survival-kit-javascript.html#extending-objects"><i class="fa fa-check"></i><b>3.4.8</b> Extending objects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Shiny: What’s under the Hood?</b></span></li>
<li class="chapter" data-level="4" data-path="shiny-intro.html"><a href="shiny-intro.html"><i class="fa fa-check"></i><b>4</b> Introduction</a><ul>
<li class="chapter" data-level="4.1" data-path="shiny-intro.html"><a href="shiny-intro.html#shiny-html-css-and-javascript"><i class="fa fa-check"></i><b>4.1</b> Shiny, HTML, CSS and JavaScript</a></li>
<li class="chapter" data-level="4.2" data-path="shiny-intro.html"><a href="shiny-intro.html#shiny-websocket"><i class="fa fa-check"></i><b>4.2</b> Websocket: R/JS bidirectional communication</a></li>
<li class="chapter" data-level="4.3" data-path="shiny-intro.html"><a href="shiny-intro.html#shiny-session"><i class="fa fa-check"></i><b>4.3</b> The Shiny session object</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="shiny-input-system.html"><a href="shiny-input-system.html"><i class="fa fa-check"></i><b>5</b> Shiny’s input system</a><ul>
<li class="chapter" data-level="5.1" data-path="shiny-input-system.html"><a href="shiny-input-system.html#shiny-javascript-sources"><i class="fa fa-check"></i><b>5.1</b> Shiny JavaScript sources</a></li>
<li class="chapter" data-level="5.2" data-path="shiny-input-system.html"><a href="shiny-input-system.html#the-shiny-javascript-object"><i class="fa fa-check"></i><b>5.2</b> The Shiny JavaScript object</a></li>
<li class="chapter" data-level="5.3" data-path="shiny-input-system.html"><a href="shiny-input-system.html#initialization"><i class="fa fa-check"></i><b>5.3</b> Initialization</a></li>
<li class="chapter" data-level="5.4" data-path="shiny-input-system.html"><a href="shiny-input-system.html#input-bindings"><i class="fa fa-check"></i><b>5.4</b> Input bindings</a><ul>
<li class="chapter" data-level="5.4.1" data-path="shiny-input-system.html"><a href="shiny-input-system.html#input-structure"><i class="fa fa-check"></i><b>5.4.1</b> Input structure</a></li>
<li class="chapter" data-level="5.4.2" data-path="shiny-input-system.html"><a href="shiny-input-system.html#binding-shiny-inputs"><i class="fa fa-check"></i><b>5.4.2</b> Binding Shiny inputs</a></li>
<li class="chapter" data-level="5.4.3" data-path="shiny-input-system.html"><a href="shiny-input-system.html#binding-other-elements"><i class="fa fa-check"></i><b>5.4.3</b> Binding other elements</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="shiny-input-system.html"><a href="shiny-input-system.html#utilities-to-quickly-define-new-inputs"><i class="fa fa-check"></i><b>5.5</b> Utilities to quickly define new inputs</a></li>
<li class="chapter" data-level="5.6" data-path="shiny-input-system.html"><a href="shiny-input-system.html#miscellaneous"><i class="fa fa-check"></i><b>5.6</b> Miscellaneous</a><ul>
<li class="chapter" data-level="5.6.1" data-path="shiny-input-system.html"><a href="shiny-input-system.html#get-access-to-initial-values"><i class="fa fa-check"></i><b>5.6.1</b> Get access to initial values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny-custom-handler.html"><a href="shiny-custom-handler.html"><i class="fa fa-check"></i><b>6</b> Custom handlers: from R to JavaScript</a></li>
<li class="part"><span><b>htmltools</b></span></li>
<li class="chapter" data-level="7" data-path="htmltools-overview.html"><a href="htmltools-overview.html"><i class="fa fa-check"></i><b>7</b> htmltools overview</a><ul>
<li class="chapter" data-level="7.1" data-path="htmltools-overview.html"><a href="htmltools-overview.html#html-tags"><i class="fa fa-check"></i><b>7.1</b> HTML Tags</a></li>
<li class="chapter" data-level="7.2" data-path="htmltools-overview.html"><a href="htmltools-overview.html#notations"><i class="fa fa-check"></i><b>7.2</b> Notations</a></li>
<li class="chapter" data-level="7.3" data-path="htmltools-overview.html"><a href="htmltools-overview.html#adding-new-tags"><i class="fa fa-check"></i><b>7.3</b> Adding new tags</a></li>
<li class="chapter" data-level="7.4" data-path="htmltools-overview.html"><a href="htmltools-overview.html#alternative-way-to-write-tags"><i class="fa fa-check"></i><b>7.4</b> Alternative way to write tags</a></li>
<li class="chapter" data-level="7.5" data-path="htmltools-overview.html"><a href="htmltools-overview.html#playing-with-tags"><i class="fa fa-check"></i><b>7.5</b> Playing with tags</a><ul>
<li class="chapter" data-level="7.5.1" data-path="htmltools-overview.html"><a href="htmltools-overview.html#tags-structure"><i class="fa fa-check"></i><b>7.5.1</b> Tags structure</a></li>
<li class="chapter" data-level="7.5.2" data-path="htmltools-overview.html"><a href="htmltools-overview.html#useful-functions-for-tags"><i class="fa fa-check"></i><b>7.5.2</b> Useful functions for tags</a></li>
<li class="chapter" data-level="7.5.3" data-path="htmltools-overview.html"><a href="htmltools-overview.html#other-interesting-functions"><i class="fa fa-check"></i><b>7.5.3</b> Other interesting functions</a></li>
<li class="chapter" data-level="7.5.4" data-path="htmltools-overview.html"><a href="htmltools-overview.html#conditionally-set-attributes"><i class="fa fa-check"></i><b>7.5.4</b> Conditionally set attributes</a></li>
<li class="chapter" data-level="7.5.5" data-path="htmltools-overview.html"><a href="htmltools-overview.html#using"><i class="fa fa-check"></i><b>7.5.5</b> Using %&gt;%</a></li>
<li class="chapter" data-level="7.5.6" data-path="htmltools-overview.html"><a href="htmltools-overview.html#programmatically-create-children-elements"><i class="fa fa-check"></i><b>7.5.6</b> Programmatically create children elements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="htmltools-dependencies.html"><a href="htmltools-dependencies.html"><i class="fa fa-check"></i><b>8</b> Dependency utilities</a><ul>
<li class="chapter" data-level="8.1" data-path="htmltools-dependencies.html"><a href="htmltools-dependencies.html#the-dirty-approach"><i class="fa fa-check"></i><b>8.1</b> The dirty approach</a></li>
<li class="chapter" data-level="8.2" data-path="htmltools-dependencies.html"><a href="htmltools-dependencies.html#the-clean-approach"><i class="fa fa-check"></i><b>8.2</b> The clean approach</a></li>
<li class="chapter" data-level="8.3" data-path="htmltools-dependencies.html"><a href="htmltools-dependencies.html#another-example-importing-html-dependencies-from-other-packages"><i class="fa fa-check"></i><b>8.3</b> Another example: Importing HTML dependencies from other packages</a></li>
<li class="chapter" data-level="8.4" data-path="htmltools-dependencies.html"><a href="htmltools-dependencies.html#suppress-dependencies"><i class="fa fa-check"></i><b>8.4</b> Suppress dependencies</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="htmltools-other-tools.html"><a href="htmltools-other-tools.html"><i class="fa fa-check"></i><b>9</b> Other tools</a><ul>
<li class="chapter" data-level="9.1" data-path="htmltools-other-tools.html"><a href="htmltools-other-tools.html#css"><i class="fa fa-check"></i><b>9.1</b> CSS</a></li>
</ul></li>
<li class="part"><span><b>Practice</b></span></li>
<li class="chapter" data-level="10" data-path="custom-templates-selection.html"><a href="custom-templates-selection.html"><i class="fa fa-check"></i><b>10</b> Template selection</a></li>
<li class="chapter" data-level="11" data-path="custom-templates-dependencies.html"><a href="custom-templates-dependencies.html"><i class="fa fa-check"></i><b>11</b> Define dependencies</a><ul>
<li class="chapter" data-level="11.1" data-path="custom-templates-dependencies.html"><a href="custom-templates-dependencies.html#discover-the-project"><i class="fa fa-check"></i><b>11.1</b> Discover the project</a></li>
<li class="chapter" data-level="11.2" data-path="custom-templates-dependencies.html"><a href="custom-templates-dependencies.html#identify-mandatory-dependencies"><i class="fa fa-check"></i><b>11.2</b> Identify mandatory dependencies</a></li>
<li class="chapter" data-level="11.3" data-path="custom-templates-dependencies.html"><a href="custom-templates-dependencies.html#bundle-dependencies"><i class="fa fa-check"></i><b>11.3</b> Bundle dependencies</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html"><i class="fa fa-check"></i><b>12</b> Template skeleton</a><ul>
<li class="chapter" data-level="12.1" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#identify-template-elements"><i class="fa fa-check"></i><b>12.1</b> Identify template elements</a></li>
<li class="chapter" data-level="12.2" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#design-the-page-layout"><i class="fa fa-check"></i><b>12.2</b> Design the page layout</a><ul>
<li class="chapter" data-level="12.2.1" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#the-page-wrapper"><i class="fa fa-check"></i><b>12.2.1</b> The page wrapper</a></li>
<li class="chapter" data-level="12.2.2" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#the-body-content"><i class="fa fa-check"></i><b>12.2.2</b> The body content</a></li>
<li class="chapter" data-level="12.2.3" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#the-footer"><i class="fa fa-check"></i><b>12.2.3</b> The footer</a></li>
<li class="chapter" data-level="12.2.4" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#the-navbar-or-header"><i class="fa fa-check"></i><b>12.2.4</b> The navbar (or header)</a></li>
<li class="chapter" data-level="12.2.5" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#card-containers"><i class="fa fa-check"></i><b>12.2.5</b> Card containers</a></li>
<li class="chapter" data-level="12.2.6" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#ribbons-card-components"><i class="fa fa-check"></i><b>12.2.6</b> Ribbons: card components</a></li>
<li class="chapter" data-level="12.2.7" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#icons"><i class="fa fa-check"></i><b>12.2.7</b> Icons</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="custom-templates-skeleton.html"><a href="custom-templates-skeleton.html#exercises"><i class="fa fa-check"></i><b>12.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html"><i class="fa fa-check"></i><b>13</b> Testing and validating templates elements</a><ul>
<li class="chapter" data-level="13.1" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html#validate-template-functions"><i class="fa fa-check"></i><b>13.1</b> Validate template functions</a><ul>
<li class="chapter" data-level="13.1.1" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html#create-your-own-validations"><i class="fa fa-check"></i><b>13.1.1</b> Create your own validations</a></li>
<li class="chapter" data-level="13.1.2" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html#existing-utils-functions"><i class="fa fa-check"></i><b>13.1.2</b> Existing utils functions</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html#testing-templates-elements"><i class="fa fa-check"></i><b>13.2</b> Testing templates elements</a></li>
<li class="chapter" data-level="13.3" data-path="custom-templates-testing.html"><a href="custom-templates-testing.html#testing-javascript"><i class="fa fa-check"></i><b>13.3</b> Testing JavaScript</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html"><i class="fa fa-check"></i><b>14</b> Develop custom input widgets</a><ul>
<li class="chapter" data-level="14.1" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#tabler-action-button"><i class="fa fa-check"></i><b>14.1</b> Tabler action button</a><ul>
<li class="chapter" data-level="14.1.1" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#reminders-about-the-action-button"><i class="fa fa-check"></i><b>14.1.1</b> Reminders about the action button</a></li>
<li class="chapter" data-level="14.1.2" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#application-to-tabler"><i class="fa fa-check"></i><b>14.1.2</b> Application to Tabler</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#toggle-switch"><i class="fa fa-check"></i><b>14.2</b> Toggle Switch</a></li>
<li class="chapter" data-level="14.3" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#navbar-menu-input"><i class="fa fa-check"></i><b>14.3</b> Navbar menu input</a></li>
<li class="chapter" data-level="14.4" data-path="custom-templates-inputs.html"><a href="custom-templates-inputs.html#exercises-1"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html"><i class="fa fa-check"></i><b>15</b> Adding more interactivity</a><ul>
<li class="chapter" data-level="15.1" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#custom-progress-bars"><i class="fa fa-check"></i><b>15.1</b> Custom progress bars</a></li>
<li class="chapter" data-level="15.2" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#user-feedback-toasts"><i class="fa fa-check"></i><b>15.2</b> User feedback: toasts</a><ul>
<li class="chapter" data-level="15.2.1" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#toast-skeleton"><i class="fa fa-check"></i><b>15.2.1</b> Toast skeleton</a></li>
<li class="chapter" data-level="15.2.2" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#the-toast-api"><i class="fa fa-check"></i><b>15.2.2</b> The toast API</a></li>
<li class="chapter" data-level="15.2.3" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#r-implementation"><i class="fa fa-check"></i><b>15.2.3</b> R implementation</a></li>
<li class="chapter" data-level="15.2.4" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#wrap-up"><i class="fa fa-check"></i><b>15.2.4</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#transform-an-element-in-a-custom-action-button"><i class="fa fa-check"></i><b>15.3</b> Transform an element in a custom action button</a></li>
<li class="chapter" data-level="15.4" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#tab-events"><i class="fa fa-check"></i><b>15.4</b> Tab events</a><ul>
<li class="chapter" data-level="15.4.1" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#insert-tabs"><i class="fa fa-check"></i><b>15.4.1</b> Insert/Remove tabs in tabsetpanel</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="custom-templates-interactivity.html"><a href="custom-templates-interactivity.html#exercises-2"><i class="fa fa-check"></i><b>15.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>Beautify with CSS and SASS</b></span></li>
<li class="chapter" data-level="16" data-path="beautify-with-fresh.html"><a href="beautify-with-fresh.html"><i class="fa fa-check"></i><b>16</b> Beautify with fresh</a><ul>
<li class="chapter" data-level="16.1" data-path="beautify-with-fresh.html"><a href="beautify-with-fresh.html#fresh-the-big-picture"><i class="fa fa-check"></i><b>16.1</b> {fresh}, the big picture</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Outstanding User Interfaces with Shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="custom-templates-interactivity" class="section level1">
<h1><span class="header-section-number">Chapter 15</span> Adding more interactivity</h1>
<p>In this part, we are going to add more life to the template element. We first see how to enhance an existing static HTML component. Then we will explore complex feedback mechanisms to provide more interactivity to your app.</p>
<div id="custom-progress-bars" class="section level2">
<h2><span class="header-section-number">15.1</span> Custom progress bars</h2>
<p>Progress bars are a good way to display metric related to a progress, for instance tracking the number of remaining tasks for a project. In general, those elements are static HTML. Hence, it would be interesting to be able to update the current value from the server side. Since it is not an proper input element, implementing an input binding is inapropriate and we decide to proceed with the <code>sendCustomMessage</code>/<code>addCustomMessageHandler</code> pair. We first create the <code>tabler_progress</code> tag which is mainly composed of:</p>
<ul>
<li><code>style</code> gives the current progress value. This is the main element</li>
<li><code>min</code> and <code>max</code> are bounds, in general between 0 and 100</li>
<li><code>id</code> ensures the progress bar uniqueness, thereby avoiding conflicts</li>
</ul>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1">tabler_progress &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">id =</span> <span class="ot">NULL</span>, value) {</a>
<a class="sourceLine" id="cb214-2" data-line-number="2">  <span class="kw">div</span>(</a>
<a class="sourceLine" id="cb214-3" data-line-number="3">    <span class="dt">class =</span> <span class="st">&quot;progress&quot;</span>,</a>
<a class="sourceLine" id="cb214-4" data-line-number="4">    <span class="kw">div</span>(</a>
<a class="sourceLine" id="cb214-5" data-line-number="5">      <span class="dt">id =</span> id, </a>
<a class="sourceLine" id="cb214-6" data-line-number="6">      <span class="dt">class =</span> <span class="st">&quot;progress-bar&quot;</span>,</a>
<a class="sourceLine" id="cb214-7" data-line-number="7">      <span class="dt">style =</span> <span class="kw">paste0</span>(<span class="st">&quot;width: &quot;</span>, value, <span class="st">&quot;%&quot;</span>),</a>
<a class="sourceLine" id="cb214-8" data-line-number="8">      <span class="dt">role =</span> <span class="st">&quot;progressbar&quot;</span>,</a>
<a class="sourceLine" id="cb214-9" data-line-number="9">      <span class="st">`</span><span class="dt">aria-valuenow</span><span class="st">`</span> =<span class="st"> </span><span class="kw">as.character</span>(value),</a>
<a class="sourceLine" id="cb214-10" data-line-number="10">      <span class="st">`</span><span class="dt">aria-valuemin</span><span class="st">`</span> =<span class="st"> &quot;0&quot;</span>,</a>
<a class="sourceLine" id="cb214-11" data-line-number="11">      <span class="st">`</span><span class="dt">aria-valuemax</span><span class="st">`</span> =<span class="st"> &quot;100&quot;</span>,</a>
<a class="sourceLine" id="cb214-12" data-line-number="12">      <span class="kw">span</span>(<span class="dt">class =</span> <span class="st">&quot;sr-only&quot;</span>, <span class="st">&quot;38% Complete&quot;</span>)</a>
<a class="sourceLine" id="cb214-13" data-line-number="13">    )</a>
<a class="sourceLine" id="cb214-14" data-line-number="14">  )</a>
<a class="sourceLine" id="cb214-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb214-16" data-line-number="16"></a>
<a class="sourceLine" id="cb214-17" data-line-number="17">update_tabler_progress &lt;-<span class="st"> </span><span class="cf">function</span>(id, value, <span class="dt">session =</span> shiny<span class="op">::</span><span class="kw">getDefaultReactiveDomain</span>()) {</a>
<a class="sourceLine" id="cb214-18" data-line-number="18">  message &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">id =</span> session<span class="op">$</span><span class="kw">ns</span>(id), <span class="dt">value =</span> value)</a>
<a class="sourceLine" id="cb214-19" data-line-number="19">  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;update-progress&quot;</span>, message)</a>
<a class="sourceLine" id="cb214-20" data-line-number="20">}</a></code></pre></div>
<p>The next element is the <code>update_tabler_progress</code> function which sends 2 elements from R to JS:</p>
<ul>
<li>The progress <code>id</code></li>
<li>The new value</li>
</ul>
<p>On the JS side, we have a basic <code>addCustomMessageHandler</code>. As mentionned in Chapter <a href="survival-kit-javascript.html#survival-kit-javascript">3</a>, <code>sendCustomMessage</code> and <code>addCustomMessageHandler</code> are connected by the <code>type</code> parameter. This is crucial! Moreover, as the sent message is a R list, it becomes an JSON, meaning that elements must be accessed with a <code>.</code> in JS:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="at">$</span>(<span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb215-2" data-line-number="2">  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;update-progress&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb215-3" data-line-number="3">    <span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">id</span>).<span class="at">css</span>(<span class="st">&#39;width&#39;</span><span class="op">,</span> <span class="va">message</span>.<span class="at">value</span> <span class="op">+</span><span class="st">&#39;%&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb215-4" data-line-number="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb215-5" data-line-number="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>We finally test these components in a simple app, whom output is depicted in Figure <a href="custom-templates-interactivity.html#fig:tabler-progress">15.1</a>:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">tabler_page</span>(</a>
<a class="sourceLine" id="cb216-2" data-line-number="2">  tags<span class="op">$</span><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb216-3" data-line-number="3">    tags<span class="op">$</span><span class="kw">script</span>(</a>
<a class="sourceLine" id="cb216-4" data-line-number="4">      <span class="st">&quot;$(function() {</span></a>
<a class="sourceLine" id="cb216-5" data-line-number="5"><span class="st">        Shiny.addCustomMessageHandler(&#39;update-progress&#39;, function(message) {</span></a>
<a class="sourceLine" id="cb216-6" data-line-number="6"><span class="st">          $(&#39;#&#39; + message.id).css(&#39;width&#39;, message.value +&#39;%&#39;);</span></a>
<a class="sourceLine" id="cb216-7" data-line-number="7"><span class="st">        });</span></a>
<a class="sourceLine" id="cb216-8" data-line-number="8"><span class="st">      });</span></a>
<a class="sourceLine" id="cb216-9" data-line-number="9"><span class="st">      &quot;</span></a>
<a class="sourceLine" id="cb216-10" data-line-number="10">    )</a>
<a class="sourceLine" id="cb216-11" data-line-number="11">  ),</a>
<a class="sourceLine" id="cb216-12" data-line-number="12">  <span class="kw">tabler_body</span>(</a>
<a class="sourceLine" id="cb216-13" data-line-number="13">    <span class="kw">noUiSliderInput</span>(</a>
<a class="sourceLine" id="cb216-14" data-line-number="14">    <span class="dt">inputId =</span> <span class="st">&quot;progress_value&quot;</span>,</a>
<a class="sourceLine" id="cb216-15" data-line-number="15">    <span class="dt">label =</span> <span class="st">&quot;Progress value&quot;</span>,</a>
<a class="sourceLine" id="cb216-16" data-line-number="16">    <span class="dt">min =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb216-17" data-line-number="17">    <span class="dt">max =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb216-18" data-line-number="18">    <span class="dt">value =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb216-19" data-line-number="19">  ),</a>
<a class="sourceLine" id="cb216-20" data-line-number="20">    <span class="kw">tabler_progress</span>(<span class="dt">id =</span> <span class="st">&quot;progress1&quot;</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb216-21" data-line-number="21">  )</a>
<a class="sourceLine" id="cb216-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb216-23" data-line-number="23"></a>
<a class="sourceLine" id="cb216-24" data-line-number="24">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb216-25" data-line-number="25">  <span class="kw">observeEvent</span>(input<span class="op">$</span>progress_value, {</a>
<a class="sourceLine" id="cb216-26" data-line-number="26">    <span class="kw">update_tabler_progress</span>(</a>
<a class="sourceLine" id="cb216-27" data-line-number="27">      <span class="dt">id =</span> <span class="st">&quot;progress1&quot;</span>, </a>
<a class="sourceLine" id="cb216-28" data-line-number="28">      input<span class="op">$</span>progress_value</a>
<a class="sourceLine" id="cb216-29" data-line-number="29">    )</a>
<a class="sourceLine" id="cb216-30" data-line-number="30">  })</a>
<a class="sourceLine" id="cb216-31" data-line-number="31">}</a>
<a class="sourceLine" id="cb216-32" data-line-number="32"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<div class="figure"><span id="fig:tabler-progress"></span>
<img src="images/practice/tabler-progress.png" alt="Progress bar component updated by a slider" width="518" />
<p class="caption">
Figure 15.1: Progress bar component updated by a slider
</p>
</div>
<br>
<div class="callout callout-info">
<p>NOTE: How to handle custom messages in shiny modules? Well, it is pretty straightforward: we wrap any id with the module namespace given by <code>session$ns()</code> before sending it to JS. You may even do it by default (without modules) like in the previous example since <code>session$ns()</code> will be <code>&quot;&quot;</code>.</p>
</div>
<p><br></p>
</div>
<div id="user-feedback-toasts" class="section level2">
<h2><span class="header-section-number">15.2</span> User feedback: toasts</h2>
<p>Toasts are components to send discrete user feedback, contrary to modals which open in the middle of the page. Toasts may open on all sides of the window and are similar to the Shiny notifications (see <a href="https://shiny.rstudio.com/reference/shiny/0.14/showNotification.html">here</a>). The tabler toast component is built on top of <a href="https://getbootstrap.com/docs/4.3/components/toasts/">Bootstrap 4</a>. Therefore, we will rely on this documentation.</p>
<div id="toast-skeleton" class="section level3">
<h3><span class="header-section-number">15.2.1</span> Toast skeleton</h3>
<p>The skeleton is the HTML structure of the toast:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;toast show&quot;</span><span class="ot"> role=</span><span class="st">&quot;alert&quot;</span><span class="ot"> aria-live=</span><span class="st">&quot;assertive&quot;</span><span class="ot"> aria-atomic=</span><span class="st">&quot;true&quot;</span><span class="ot"> data-autohide=</span><span class="st">&quot;false&quot;</span><span class="ot"> data-toggle=</span><span class="st">&quot;toast&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2">  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;toast-header&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb217-3" data-line-number="3">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;avatar mr-2&quot;</span><span class="ot"> style=</span><span class="st">&quot;background-image: url(...)&quot;</span><span class="kw">&gt;&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb217-4" data-line-number="4">    <span class="kw">&lt;strong</span><span class="ot"> class=</span><span class="st">&quot;mr-auto&quot;</span><span class="kw">&gt;</span>Mallory Hulme<span class="kw">&lt;/strong&gt;</span></a>
<a class="sourceLine" id="cb217-5" data-line-number="5">    <span class="kw">&lt;small&gt;</span>11 mins ago<span class="kw">&lt;/small&gt;</span></a>
<a class="sourceLine" id="cb217-6" data-line-number="6">    <span class="kw">&lt;button</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> class=</span><span class="st">&quot;ml-2 close&quot;</span><span class="ot"> data-dismiss=</span><span class="st">&quot;toast&quot;</span><span class="ot"> aria-label=</span><span class="st">&quot;Close&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb217-7" data-line-number="7">      <span class="kw">&lt;span</span><span class="ot"> aria-hidden=</span><span class="st">&quot;true&quot;</span><span class="kw">&gt;</span><span class="dv">&amp;times;</span><span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb217-8" data-line-number="8">    <span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb217-9" data-line-number="9">  <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb217-10" data-line-number="10">  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;toast-body&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb217-11" data-line-number="11">  Hello, world! This is a toast message.</a>
<a class="sourceLine" id="cb217-12" data-line-number="12">  <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb217-13" data-line-number="13"><span class="kw">&lt;/div&gt;</span></a></code></pre></div>
<p>Toasts are mainly composed of a header and a body. There might be a close button in case the toast does not hide itself. If multiple toasts appear one after each others, they are stacked, the latest being at the bottom of the stack. The position is controled with the style attribute like <code>style=&quot;position: absolute; top: 0; right: 0;&quot;</code> for a top-right placement. Accessibility parameters like <code>aria-live</code> are detailed <a href="https://getbootstrap.com/docs/4.3/components/toasts/#accessibility">here</a>.</p>
</div>
<div id="the-toast-api" class="section level3">
<h3><span class="header-section-number">15.2.2</span> The toast API</h3>
<p>Toasts have a JS API to control their behaviour, for instance <code>$('&lt;toast_selector&gt;').toast(option)</code>, where option is a JSON with the following fields:</p>
<ul>
<li>animation applies a CSS fade transition to the toast and is TRUE by default</li>
<li>autohide automatically hides the toast (TRUE by default)</li>
<li>delay is the delay to hide the toast (500 ms)</li>
</ul>
<p>There are 3 methods: hide, show and dispose (dispose ensures the toast does not appear anymore). Finally, we may fine tune the toast behavior with 4 events: show.bs.toast, shown.bs.toast, hide.bs.toast, hide.bs.toast, hidden.bs.toast (like for tabs).</p>
</div>
<div id="r-implementation" class="section level3">
<h3><span class="header-section-number">15.2.3</span> R implementation</h3>
<p>We first create the toast skeleton. We assume our toast will hide automatically, so that we may remove the delete button as well as the <code>data-autohide=&quot;false</code> attribute. All parameters are optional except the toast id, which is required to toggle the toast:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1">tabler_toast &lt;-<span class="st"> </span><span class="cf">function</span>(id, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">subtitle =</span> <span class="ot">NULL</span>, ..., <span class="dt">img =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb218-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb218-3" data-line-number="3">  toast_header &lt;-<span class="st"> </span><span class="kw">div</span>(</a>
<a class="sourceLine" id="cb218-4" data-line-number="4">    <span class="dt">class =</span> <span class="st">&quot;toast-header&quot;</span>,</a>
<a class="sourceLine" id="cb218-5" data-line-number="5">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(img)) {</a>
<a class="sourceLine" id="cb218-6" data-line-number="6">      <span class="kw">span</span>(</a>
<a class="sourceLine" id="cb218-7" data-line-number="7">        <span class="dt">class =</span> <span class="st">&quot;avatar mr-2&quot;</span>, </a>
<a class="sourceLine" id="cb218-8" data-line-number="8">        <span class="dt">style =</span> <span class="kw">sprintf</span>(<span class="st">&quot;background-image: url(%s)&quot;</span>, img)</a>
<a class="sourceLine" id="cb218-9" data-line-number="9">      )</a>
<a class="sourceLine" id="cb218-10" data-line-number="10">    },</a>
<a class="sourceLine" id="cb218-11" data-line-number="11">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(title)) <span class="kw">strong</span>(<span class="dt">class =</span> <span class="st">&quot;mr-2&quot;</span>, title),</a>
<a class="sourceLine" id="cb218-12" data-line-number="12">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(subtitle)) tags<span class="op">$</span><span class="kw">small</span>(subtitle)</a>
<a class="sourceLine" id="cb218-13" data-line-number="13">  )</a>
<a class="sourceLine" id="cb218-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb218-15" data-line-number="15">  toast_body &lt;-<span class="st"> </span><span class="kw">div</span>(<span class="dt">class =</span> <span class="st">&quot;toast-body&quot;</span>, ...)</a>
<a class="sourceLine" id="cb218-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb218-17" data-line-number="17">  toast_wrapper &lt;-<span class="st"> </span><span class="kw">div</span>(</a>
<a class="sourceLine" id="cb218-18" data-line-number="18">    <span class="dt">id =</span> id,</a>
<a class="sourceLine" id="cb218-19" data-line-number="19">    <span class="dt">class =</span> <span class="st">&quot;toast&quot;</span>,</a>
<a class="sourceLine" id="cb218-20" data-line-number="20">    <span class="dt">role =</span> <span class="st">&quot;alert&quot;</span>,</a>
<a class="sourceLine" id="cb218-21" data-line-number="21">    <span class="dt">style =</span> <span class="st">&quot;position: absolute; top: 0; right: 0;&quot;</span>,</a>
<a class="sourceLine" id="cb218-22" data-line-number="22">    <span class="st">`</span><span class="dt">aria-live</span><span class="st">`</span> =<span class="st"> &quot;assertive&quot;</span>,</a>
<a class="sourceLine" id="cb218-23" data-line-number="23">    <span class="st">`</span><span class="dt">aria-atomic</span><span class="st">`</span> =<span class="st"> &quot;true&quot;</span>,</a>
<a class="sourceLine" id="cb218-24" data-line-number="24">    <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;toast&quot;</span></a>
<a class="sourceLine" id="cb218-25" data-line-number="25">  )</a>
<a class="sourceLine" id="cb218-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb218-27" data-line-number="27">  toast_wrapper <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tagAppendChildren</span>(toast_header, toast_body)</a>
<a class="sourceLine" id="cb218-28" data-line-number="28">}</a></code></pre></div>
<p>We create the <code>show_tabler_toast</code> function. Since the toast automatically hides, it does not make sense to create the hide function, as well as the dispose.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">show_tabler_toast &lt;-<span class="st"> </span><span class="cf">function</span>(id, <span class="dt">options =</span> <span class="ot">NULL</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</a>
<a class="sourceLine" id="cb219-2" data-line-number="2">  message &lt;-<span class="st"> </span>shiny<span class="op">:::</span><span class="kw">dropNulls</span>(</a>
<a class="sourceLine" id="cb219-3" data-line-number="3">    <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb219-4" data-line-number="4">      <span class="dt">id =</span> id,</a>
<a class="sourceLine" id="cb219-5" data-line-number="5">      <span class="dt">options =</span> options</a>
<a class="sourceLine" id="cb219-6" data-line-number="6">    )</a>
<a class="sourceLine" id="cb219-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb219-8" data-line-number="8">  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;tabler-toast&quot;</span>, message)</a>
<a class="sourceLine" id="cb219-9" data-line-number="9">}</a></code></pre></div>
<p>The corresponding JS handler is given by:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb220-1" data-line-number="1"><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2">  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;tabler-toast&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb220-3" data-line-number="3">    <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span><span class="va">message</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span>)</a>
<a class="sourceLine" id="cb220-4" data-line-number="4">      .<span class="at">toast</span>(<span class="va">message</span>.<span class="at">options</span>)</a>
<a class="sourceLine" id="cb220-5" data-line-number="5">      .<span class="at">toast</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb220-6" data-line-number="6"></a>
<a class="sourceLine" id="cb220-7" data-line-number="7">    <span class="co">// add custom Shiny input to listen to the toast state</span></a>
<a class="sourceLine" id="cb220-8" data-line-number="8">    <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span><span class="va">message</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span>).<span class="at">on</span>(<span class="st">&#39;hidden.bs.toast&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb220-9" data-line-number="9">      <span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="va">message</span>.<span class="at">id</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="op">{</span><span class="dt">priority</span><span class="op">:</span> <span class="st">&#39;event&#39;</span><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb220-10" data-line-number="10">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb220-11" data-line-number="11">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb220-12" data-line-number="12"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>We first configure the toast and show it. Notice how we chained jQuery methods (see Chapter <a href="survival-kit-javascript.html#survival-kit-javascript">3</a>)! We optionally add an event listener to capture the <code>hidden.bs.toast</code> event, so that we may trigger an action when the toast is closed. The <code>input$id</code> will be used for that purpose in combination with the <code>Shiny.setInputValue</code>. Notice the extra parameter <code>{priority: 'event'}</code>: basically, once the toast is closed, <code>input$id</code> will always be TRUE, thereby breaking the reactivity. Adding this extra parameter forces the evaluation of the input, although constant over time.</p>
</div>
<div id="wrap-up" class="section level3">
<h3><span class="header-section-number">15.2.4</span> Wrap up</h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">tabler_page</span>(</a>
<a class="sourceLine" id="cb221-2" data-line-number="2">  tags<span class="op">$</span><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb221-3" data-line-number="3">    tags<span class="op">$</span><span class="kw">script</span>(</a>
<a class="sourceLine" id="cb221-4" data-line-number="4">      <span class="st">&quot;$(function() {</span></a>
<a class="sourceLine" id="cb221-5" data-line-number="5"><span class="st">        Shiny.addCustomMessageHandler(&#39;tabler-toast&#39;, function(message) {</span></a>
<a class="sourceLine" id="cb221-6" data-line-number="6"><span class="st">          $(`#${message.id}`)</span></a>
<a class="sourceLine" id="cb221-7" data-line-number="7"><span class="st">            .toast(message.options)</span></a>
<a class="sourceLine" id="cb221-8" data-line-number="8"><span class="st">            .toast(&#39;show&#39;);</span></a>
<a class="sourceLine" id="cb221-9" data-line-number="9"><span class="st">          </span></a>
<a class="sourceLine" id="cb221-10" data-line-number="10"><span class="st">          // add custom Shiny input to listen to the toast state</span></a>
<a class="sourceLine" id="cb221-11" data-line-number="11"><span class="st">          $(`#${message.id}`).on(&#39;hidden.bs.toast&#39;, function() {</span></a>
<a class="sourceLine" id="cb221-12" data-line-number="12"><span class="st">            Shiny.setInputValue(message.id, true, {priority: &#39;event&#39;});</span></a>
<a class="sourceLine" id="cb221-13" data-line-number="13"><span class="st">          })</span></a>
<a class="sourceLine" id="cb221-14" data-line-number="14"><span class="st">        });</span></a>
<a class="sourceLine" id="cb221-15" data-line-number="15"><span class="st">      });</span></a>
<a class="sourceLine" id="cb221-16" data-line-number="16"><span class="st">      &quot;</span></a>
<a class="sourceLine" id="cb221-17" data-line-number="17">    )</a>
<a class="sourceLine" id="cb221-18" data-line-number="18">  ),</a>
<a class="sourceLine" id="cb221-19" data-line-number="19">  <span class="kw">tabler_toast</span>(</a>
<a class="sourceLine" id="cb221-20" data-line-number="20">    <span class="dt">id =</span> <span class="st">&quot;toast&quot;</span>, </a>
<a class="sourceLine" id="cb221-21" data-line-number="21">    <span class="dt">title =</span> <span class="st">&quot;Hello&quot;</span>, </a>
<a class="sourceLine" id="cb221-22" data-line-number="22">    <span class="dt">subtitle =</span> <span class="st">&quot;now&quot;</span>, </a>
<a class="sourceLine" id="cb221-23" data-line-number="23">    <span class="st">&quot;Toast body&quot;</span>,</a>
<a class="sourceLine" id="cb221-24" data-line-number="24">    <span class="dt">img =</span> <span class="st">&quot;https://preview-dev.tabler.io/static/logo.svg&quot;</span></a>
<a class="sourceLine" id="cb221-25" data-line-number="25">  ),</a>
<a class="sourceLine" id="cb221-26" data-line-number="26">  <span class="kw">tabler_button</span>(<span class="st">&quot;launch&quot;</span>, <span class="st">&quot;Go!&quot;</span>, <span class="dt">width =</span> <span class="st">&quot;25%&quot;</span>)</a>
<a class="sourceLine" id="cb221-27" data-line-number="27">)</a>
<a class="sourceLine" id="cb221-28" data-line-number="28"></a>
<a class="sourceLine" id="cb221-29" data-line-number="29">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb221-30" data-line-number="30">  <span class="kw">observe</span>(<span class="kw">print</span>(input<span class="op">$</span>toast))</a>
<a class="sourceLine" id="cb221-31" data-line-number="31">  <span class="kw">observeEvent</span>(input<span class="op">$</span>launch, {</a>
<a class="sourceLine" id="cb221-32" data-line-number="32">    <span class="kw">removeNotification</span>(<span class="st">&quot;notif&quot;</span>)</a>
<a class="sourceLine" id="cb221-33" data-line-number="33">    <span class="kw">show_tabler_toast</span>(</a>
<a class="sourceLine" id="cb221-34" data-line-number="34">      <span class="st">&quot;toast&quot;</span>, </a>
<a class="sourceLine" id="cb221-35" data-line-number="35">      <span class="dt">options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb221-36" data-line-number="36">        <span class="dt">animation =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb221-37" data-line-number="37">        <span class="dt">delay =</span> <span class="dv">3000</span></a>
<a class="sourceLine" id="cb221-38" data-line-number="38">      )</a>
<a class="sourceLine" id="cb221-39" data-line-number="39">    )</a>
<a class="sourceLine" id="cb221-40" data-line-number="40">  })</a>
<a class="sourceLine" id="cb221-41" data-line-number="41">  </a>
<a class="sourceLine" id="cb221-42" data-line-number="42">  <span class="kw">observeEvent</span>(input<span class="op">$</span>toast, {</a>
<a class="sourceLine" id="cb221-43" data-line-number="43">    <span class="kw">showNotification</span>(</a>
<a class="sourceLine" id="cb221-44" data-line-number="44">      <span class="dt">id =</span> <span class="st">&quot;notif&quot;</span>,</a>
<a class="sourceLine" id="cb221-45" data-line-number="45">      <span class="st">&quot;Toast was closed&quot;</span>, </a>
<a class="sourceLine" id="cb221-46" data-line-number="46">      <span class="dt">type =</span> <span class="st">&quot;warning&quot;</span>,</a>
<a class="sourceLine" id="cb221-47" data-line-number="47">      <span class="dt">duration =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb221-48" data-line-number="48">      </a>
<a class="sourceLine" id="cb221-49" data-line-number="49">    )</a>
<a class="sourceLine" id="cb221-50" data-line-number="50">  })</a>
<a class="sourceLine" id="cb221-51" data-line-number="51">}</a>
<a class="sourceLine" id="cb221-52" data-line-number="52"></a>
<a class="sourceLine" id="cb221-53" data-line-number="53"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<div class="figure"><span id="fig:tabler-toast"></span>
<img src="images/practice/tabler-toast.png" alt="Tabler toast element" width="54" />
<p class="caption">
Figure 15.2: Tabler toast element
</p>
</div>
</div>
</div>
<div id="transform-an-element-in-a-custom-action-button" class="section level2">
<h2><span class="header-section-number">15.3</span> Transform an element in a custom action button</h2>
<p>As seen in Chapter <a href="custom-templates-inputs.html#custom-templates-inputs">14</a>, any <code>&lt;button&gt;</code>, <code>&lt;a&gt;</code> element holding the <code>action-button</code> class may eventually become an action button. The tabler template has dropdown menus in the navbar and we would like to transform those dropdown items in action buttons. The <code>tabler_dropdown</code> functions takes the following parameters:</p>
<ul>
<li>id is required by the <code>show_tabler_dropdown</code> (see below) function which opens the menu</li>
<li>title is the dropdown menu name</li>
<li>subtitle is optional text</li>
<li>img is an optional image</li>
<li>… hosts the <code>tabler_dropdown_item</code> (see below)</li>
</ul>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1">tabler_dropdown &lt;-<span class="st"> </span><span class="cf">function</span>(..., <span class="dt">id =</span> <span class="ot">NULL</span>, title, <span class="dt">subtitle =</span> <span class="ot">NULL</span>, <span class="dt">img =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb222-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb222-3" data-line-number="3">  img_tag &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(img)) {</a>
<a class="sourceLine" id="cb222-4" data-line-number="4">    <span class="kw">span</span>(</a>
<a class="sourceLine" id="cb222-5" data-line-number="5">      <span class="dt">class =</span> <span class="st">&quot;avatar&quot;</span>, </a>
<a class="sourceLine" id="cb222-6" data-line-number="6">      <span class="dt">style =</span> <span class="kw">sprintf</span>(<span class="st">&quot;background-image: url(%s)&quot;</span>, img)</a>
<a class="sourceLine" id="cb222-7" data-line-number="7">    )</a>
<a class="sourceLine" id="cb222-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb222-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb222-10" data-line-number="10">  titles_tag &lt;-<span class="st"> </span><span class="kw">div</span>(</a>
<a class="sourceLine" id="cb222-11" data-line-number="11">    <span class="dt">class =</span> <span class="st">&quot;d-none d-xl-block pl-2&quot;</span>,</a>
<a class="sourceLine" id="cb222-12" data-line-number="12">    <span class="kw">div</span>(title),</a>
<a class="sourceLine" id="cb222-13" data-line-number="13">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(subtitle)) {</a>
<a class="sourceLine" id="cb222-14" data-line-number="14">      <span class="kw">div</span>(<span class="dt">class =</span> <span class="st">&quot;mt-1 small text-muted&quot;</span>, subtitle)</a>
<a class="sourceLine" id="cb222-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb222-16" data-line-number="16">  )</a>
<a class="sourceLine" id="cb222-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb222-18" data-line-number="18">  link_tag &lt;-<span class="st"> </span><span class="kw">a</span>(</a>
<a class="sourceLine" id="cb222-19" data-line-number="19">    <span class="dt">href =</span> <span class="st">&quot;#&quot;</span>,</a>
<a class="sourceLine" id="cb222-20" data-line-number="20">    <span class="dt">id =</span> id, </a>
<a class="sourceLine" id="cb222-21" data-line-number="21">    <span class="dt">class =</span> <span class="st">&quot;nav-link d-flex lh-1 text-reset p-0&quot;</span>,</a>
<a class="sourceLine" id="cb222-22" data-line-number="22">    <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;dropdown&quot;</span>,</a>
<a class="sourceLine" id="cb222-23" data-line-number="23">    <span class="st">`</span><span class="dt">aria-expanded</span><span class="st">`</span> =<span class="st"> &quot;false&quot;</span></a>
<a class="sourceLine" id="cb222-24" data-line-number="24">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb222-25" data-line-number="25"><span class="st">    </span><span class="kw">tagAppendChildren</span>(img_tag, titles_tag)</a>
<a class="sourceLine" id="cb222-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb222-27" data-line-number="27">  dropdown_tag &lt;-<span class="st"> </span><span class="kw">div</span>(</a>
<a class="sourceLine" id="cb222-28" data-line-number="28">    <span class="dt">class =</span> <span class="st">&quot;dropdown-menu dropdown-menu-right&quot;</span>, </a>
<a class="sourceLine" id="cb222-29" data-line-number="29">    <span class="st">`</span><span class="dt">aria-labelledby</span><span class="st">`</span> =<span class="st"> </span>id, </a>
<a class="sourceLine" id="cb222-30" data-line-number="30">    ...</a>
<a class="sourceLine" id="cb222-31" data-line-number="31">  )</a>
<a class="sourceLine" id="cb222-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb222-33" data-line-number="33">  <span class="kw">div</span>(<span class="dt">class =</span> <span class="st">&quot;nav-item dropdown&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tagAppendChildren</span>(</a>
<a class="sourceLine" id="cb222-34" data-line-number="34">    link_tag,</a>
<a class="sourceLine" id="cb222-35" data-line-number="35">    dropdown_tag</a>
<a class="sourceLine" id="cb222-36" data-line-number="36">  )</a>
<a class="sourceLine" id="cb222-37" data-line-number="37">}</a></code></pre></div>
<p>To convert a dropdown item in an action button , we add the <code>action-button</code> class as well as the <code>id</code> parameter to recover the corresponding input id.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1">tabler_dropdown_item &lt;-<span class="st"> </span><span class="cf">function</span>(..., <span class="dt">id =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb223-2" data-line-number="2">  <span class="kw">a</span>(<span class="dt">id =</span> id, <span class="dt">class =</span> <span class="st">&quot;dropdown-item action-button&quot;</span>, <span class="dt">href =</span> <span class="st">&quot;#&quot;</span>, ...)</a>
<a class="sourceLine" id="cb223-3" data-line-number="3">}</a></code></pre></div>
<p>We finally create the <code>show_tabler_dropdown</code> as well as the corresponding Shiny message handler.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1">show_tabler_dropdown &lt;-<span class="st"> </span><span class="cf">function</span>(id, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</a>
<a class="sourceLine" id="cb224-2" data-line-number="2">  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;show-dropdown&quot;</span>, <span class="dt">message =</span> id)</a>
<a class="sourceLine" id="cb224-3" data-line-number="3">}</a></code></pre></div>
<p>To show the dropdown, we use the <code>dropdown</code> method which is linked to the <code>data-toggle=&quot;dropdown&quot;</code> of <code>tabler_dropdown</code>.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb225-2" data-line-number="2">  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;show-dropdown&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb225-3" data-line-number="3">    <span class="at">$</span>(<span class="vs">`#</span><span class="sc">${</span>message<span class="sc">}</span><span class="vs">`</span>).<span class="at">dropdown</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb225-4" data-line-number="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb225-5" data-line-number="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Let’s play with it! (See Figure <a href="custom-templates-interactivity.html#fig:tabler-dropdown">15.3</a>)</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">tabler_page</span>(</a>
<a class="sourceLine" id="cb226-2" data-line-number="2">  tags<span class="op">$</span><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb226-3" data-line-number="3">    tags<span class="op">$</span><span class="kw">script</span>(</a>
<a class="sourceLine" id="cb226-4" data-line-number="4">      <span class="st">&quot;$(function() {</span></a>
<a class="sourceLine" id="cb226-5" data-line-number="5"><span class="st">        Shiny.addCustomMessageHandler(&#39;show-dropdown&#39;, function(message) {</span></a>
<a class="sourceLine" id="cb226-6" data-line-number="6"><span class="st">          $(`#${message}`).dropdown(&#39;show&#39;);</span></a>
<a class="sourceLine" id="cb226-7" data-line-number="7"><span class="st">        });</span></a>
<a class="sourceLine" id="cb226-8" data-line-number="8"><span class="st">      });</span></a>
<a class="sourceLine" id="cb226-9" data-line-number="9"><span class="st">      &quot;</span></a>
<a class="sourceLine" id="cb226-10" data-line-number="10">    )</a>
<a class="sourceLine" id="cb226-11" data-line-number="11">  ),</a>
<a class="sourceLine" id="cb226-12" data-line-number="12">  <span class="kw">tabler_navbar</span>(</a>
<a class="sourceLine" id="cb226-13" data-line-number="13">    <span class="dt">brand_url =</span> <span class="st">&quot;https://preview-dev.tabler.io&quot;</span>, </a>
<a class="sourceLine" id="cb226-14" data-line-number="14">    <span class="dt">brand_image =</span> <span class="st">&quot;https://preview-dev.tabler.io/static/logo.svg&quot;</span>, </a>
<a class="sourceLine" id="cb226-15" data-line-number="15">    <span class="dt">nav_menu =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb226-16" data-line-number="16">    <span class="kw">tabler_dropdown</span>(</a>
<a class="sourceLine" id="cb226-17" data-line-number="17">      <span class="dt">id =</span> <span class="st">&quot;mydropdown&quot;</span>,</a>
<a class="sourceLine" id="cb226-18" data-line-number="18">      <span class="dt">title =</span> <span class="st">&quot;Dropdown&quot;</span>,</a>
<a class="sourceLine" id="cb226-19" data-line-number="19">      <span class="dt">subtitle =</span> <span class="st">&quot;click me&quot;</span>,</a>
<a class="sourceLine" id="cb226-20" data-line-number="20">      <span class="kw">tabler_dropdown_item</span>(</a>
<a class="sourceLine" id="cb226-21" data-line-number="21">        <span class="dt">id =</span> <span class="st">&quot;item1&quot;</span>,</a>
<a class="sourceLine" id="cb226-22" data-line-number="22">        <span class="st">&quot;Show Notification&quot;</span></a>
<a class="sourceLine" id="cb226-23" data-line-number="23">      ),</a>
<a class="sourceLine" id="cb226-24" data-line-number="24">      <span class="kw">tabler_dropdown_item</span>(</a>
<a class="sourceLine" id="cb226-25" data-line-number="25">        <span class="st">&quot;Do nothing&quot;</span></a>
<a class="sourceLine" id="cb226-26" data-line-number="26">      )</a>
<a class="sourceLine" id="cb226-27" data-line-number="27">    )</a>
<a class="sourceLine" id="cb226-28" data-line-number="28">  ),</a>
<a class="sourceLine" id="cb226-29" data-line-number="29">  <span class="kw">tabler_body</span>(</a>
<a class="sourceLine" id="cb226-30" data-line-number="30">    <span class="kw">tabler_button</span>(<span class="st">&quot;show&quot;</span>, <span class="st">&quot;Open dropdown&quot;</span>, <span class="dt">width =</span> <span class="st">&quot;25%&quot;</span>),</a>
<a class="sourceLine" id="cb226-31" data-line-number="31">    <span class="dt">footer =</span> <span class="kw">tabler_footer</span>(</a>
<a class="sourceLine" id="cb226-32" data-line-number="32">      <span class="dt">left =</span> <span class="st">&quot;Rstats, 2020&quot;</span>, </a>
<a class="sourceLine" id="cb226-33" data-line-number="33">      <span class="dt">right =</span> <span class="kw">a</span>(<span class="dt">href =</span> <span class="st">&quot;https://www.google.com&quot;</span>)</a>
<a class="sourceLine" id="cb226-34" data-line-number="34">    )</a>
<a class="sourceLine" id="cb226-35" data-line-number="35">  )</a>
<a class="sourceLine" id="cb226-36" data-line-number="36">)</a>
<a class="sourceLine" id="cb226-37" data-line-number="37">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb226-38" data-line-number="38">  </a>
<a class="sourceLine" id="cb226-39" data-line-number="39">  <span class="kw">observeEvent</span>(input<span class="op">$</span>show, {</a>
<a class="sourceLine" id="cb226-40" data-line-number="40">    <span class="kw">show_tabler_dropdown</span>(<span class="st">&quot;mydropdown&quot;</span>)</a>
<a class="sourceLine" id="cb226-41" data-line-number="41">  })</a>
<a class="sourceLine" id="cb226-42" data-line-number="42">  </a>
<a class="sourceLine" id="cb226-43" data-line-number="43">  <span class="kw">observeEvent</span>(input<span class="op">$</span>item1, {</a>
<a class="sourceLine" id="cb226-44" data-line-number="44">    <span class="kw">showNotification</span>(</a>
<a class="sourceLine" id="cb226-45" data-line-number="45">      <span class="st">&quot;Success&quot;</span>, </a>
<a class="sourceLine" id="cb226-46" data-line-number="46">      <span class="dt">type =</span> <span class="st">&quot;message&quot;</span>,</a>
<a class="sourceLine" id="cb226-47" data-line-number="47">      <span class="dt">duration =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb226-48" data-line-number="48">      </a>
<a class="sourceLine" id="cb226-49" data-line-number="49">    )</a>
<a class="sourceLine" id="cb226-50" data-line-number="50">  })</a>
<a class="sourceLine" id="cb226-51" data-line-number="51">}</a>
<a class="sourceLine" id="cb226-52" data-line-number="52"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<div class="figure"><span id="fig:tabler-dropdown"></span>
<img src="images/practice/tabler-dropdown.png" alt="Tabler dropdown element" width="540" />
<p class="caption">
Figure 15.3: Tabler dropdown element
</p>
</div>
</div>
<div id="tab-events" class="section level2">
<h2><span class="header-section-number">15.4</span> Tab events</h2>
<p>Do you remember about the navbar element and the tabsetpanel system of Chapter <a href="custom-templates-skeleton.html#custom-templates-skeleton">12</a>? Navs allow to organize any app into several tabs, acting like pages. This is a powerful tool for Shiny since it is currently not straightforward to create <a href="https://community.rstudio.com/t/shiny-app-composed-of-many-many-pages/7698">multi-pages</a> Shiny apps like anyone would do with a website. Navs relie on the Bootstrap4 API but we only used few JS functions.</p>
<div id="insert-tabs" class="section level3">
<h3><span class="header-section-number">15.4.1</span> Insert/Remove tabs in tabsetpanel</h3>
<p>How about dynamically inserting/removing tabs from a <code>tabler_navbar</code>? I chose this example since it involves extra technical details about Shiny.</p>
<p>How do we proceed? if you remember about the <code>tabler_navbar_menu_item</code> and <code>tabler_tab_item</code> coupling, inserting a tab implies to insert the trigger in the navigation menu as well as the content in the dashboard body. Therefore, we need to know the structure of what we insert. Below is a reminder:</p>
<ul>
<li><code>tabler_navbar_menu_item</code> are <code>&lt;li&gt;</code> elements</li>
<li><code>tabler_navbar_menu_item</code> is a <code>&lt;div&gt;</code> element with specific classes</li>
</ul>
<div class="sourceCode" id="cb227"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb227-1" data-line-number="1"><span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;nav-item&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb227-2" data-line-number="2">  <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;nav-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;#ww&quot;</span><span class="ot"> data-toggle=</span><span class="st">&quot;pill&quot;</span><span class="ot"> data-value=</span><span class="st">&quot;ww&quot;</span><span class="ot"> role=</span><span class="st">&quot;tab&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb227-3" data-line-number="3">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;nav-link-icon d-md-none d-lg-inline-block&quot;</span><span class="kw">&gt;&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb227-4" data-line-number="4">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;nav-link-title&quot;</span><span class="kw">&gt;</span>ww<span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb227-5" data-line-number="5">  <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb227-6" data-line-number="6"><span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb227-7" data-line-number="7"></a>
<a class="sourceLine" id="cb227-8" data-line-number="8"><span class="kw">&lt;div</span><span class="ot"> role=</span><span class="st">&quot;tabpanel&quot;</span><span class="ot"> class=</span><span class="st">&quot;tab-pane fade container-fluid&quot;</span><span class="ot"> id=</span><span class="st">&quot;ww&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a></code></pre></div>
<p>We design the <code>insert_tabler_tab</code> function similar to the Shiny <code>insertTab</code>.
To handle shiny modules, we wrap the inputId in the session namespace <code>session$ns</code>. We create the menu item element based on the provided new tab.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1">insert_tabler_tab &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, tab, target, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>),</a>
<a class="sourceLine" id="cb228-2" data-line-number="2">                              <span class="dt">select =</span> <span class="ot">FALSE</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</a>
<a class="sourceLine" id="cb228-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb228-4" data-line-number="4">  inputId &lt;-<span class="st"> </span>session<span class="op">$</span><span class="kw">ns</span>(inputId)</a>
<a class="sourceLine" id="cb228-5" data-line-number="5">  position &lt;-<span class="st"> </span><span class="kw">match.arg</span>(position)</a>
<a class="sourceLine" id="cb228-6" data-line-number="6">  navbar_menu_item &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">li</span>(</a>
<a class="sourceLine" id="cb228-7" data-line-number="7">    <span class="dt">class =</span> <span class="st">&quot;nav-item&quot;</span>,</a>
<a class="sourceLine" id="cb228-8" data-line-number="8">    <span class="kw">a</span>(</a>
<a class="sourceLine" id="cb228-9" data-line-number="9">      <span class="dt">class =</span> <span class="st">&quot;nav-link&quot;</span>,</a>
<a class="sourceLine" id="cb228-10" data-line-number="10">      <span class="dt">href =</span> <span class="kw">paste0</span>(<span class="st">&quot;#&quot;</span>, session<span class="op">$</span><span class="kw">ns</span>(tab<span class="op">$</span>attribs<span class="op">$</span>id)),</a>
<a class="sourceLine" id="cb228-11" data-line-number="11">      <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;pill&quot;</span>,</a>
<a class="sourceLine" id="cb228-12" data-line-number="12">      <span class="st">`</span><span class="dt">data-value</span><span class="st">`</span> =<span class="st"> </span>tab<span class="op">$</span>attribs<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb228-13" data-line-number="13">      <span class="dt">role =</span> <span class="st">&quot;tab&quot;</span>,</a>
<a class="sourceLine" id="cb228-14" data-line-number="14">      tab<span class="op">$</span>attribs<span class="op">$</span>id</a>
<a class="sourceLine" id="cb228-15" data-line-number="15">    )</a>
<a class="sourceLine" id="cb228-16" data-line-number="16">  )</a>
<a class="sourceLine" id="cb228-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb228-18" data-line-number="18">  tab &lt;-<span class="st"> </span><span class="kw">force</span>(<span class="kw">as.character</span>(tab))</a>
<a class="sourceLine" id="cb228-19" data-line-number="19">  navbar_menu_item &lt;-<span class="st"> </span><span class="kw">force</span>(<span class="kw">as.character</span>(navbar_menu_item))</a>
<a class="sourceLine" id="cb228-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb228-21" data-line-number="21">  message &lt;-<span class="st"> </span>shiny<span class="op">:::</span><span class="kw">dropNulls</span>(</a>
<a class="sourceLine" id="cb228-22" data-line-number="22">    <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb228-23" data-line-number="23">      <span class="dt">inputId =</span> inputId,</a>
<a class="sourceLine" id="cb228-24" data-line-number="24">      <span class="dt">content =</span> tab,</a>
<a class="sourceLine" id="cb228-25" data-line-number="25">      <span class="dt">link =</span> navbar_menu_item,</a>
<a class="sourceLine" id="cb228-26" data-line-number="26">      <span class="dt">target =</span> target,</a>
<a class="sourceLine" id="cb228-27" data-line-number="27">      <span class="dt">position =</span> position,</a>
<a class="sourceLine" id="cb228-28" data-line-number="28">      <span class="dt">select =</span> select</a>
<a class="sourceLine" id="cb228-29" data-line-number="29">    )</a>
<a class="sourceLine" id="cb228-30" data-line-number="30">  )</a>
<a class="sourceLine" id="cb228-31" data-line-number="31">  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;insert-tab&quot;</span>, message)</a>
<a class="sourceLine" id="cb228-32" data-line-number="32">}</a></code></pre></div>
<p>On the JS side, we capture the R message (list) in two elements:</p>
<ul>
<li><code>$divTag</code> contains the tab content</li>
<li><code>$liTag</code> contains the tab link, ie the navigation part</li>
</ul>
<p>Depending on the position parameter, we use the <code>insertAfter</code> and <code>insertBefore</code> jQuery methods. Finally, if the newly inserted tab has to be
selected, we activate the corresponding tab element with <code>$(tablink).tab('show')</code>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb229-2" data-line-number="2">  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;insert-tab&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb229-3" data-line-number="3">    <span class="co">// define div and li targets</span></a>
<a class="sourceLine" id="cb229-4" data-line-number="4">    <span class="kw">let</span> $divTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="at">content</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-5" data-line-number="5">    <span class="kw">let</span> $liTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="at">link</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-6" data-line-number="6">    </a>
<a class="sourceLine" id="cb229-7" data-line-number="7">    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;after&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb229-8" data-line-number="8">      <span class="va">$divTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb229-9" data-line-number="9">      <span class="va">$liTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span> <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb229-10" data-line-number="10">    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;before&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb229-11" data-line-number="11">      <span class="va">$divTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb229-12" data-line-number="12">      <span class="va">$liTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span> <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb229-13" data-line-number="13">    <span class="op">}</span></a>
<a class="sourceLine" id="cb229-14" data-line-number="14">    </a>
<a class="sourceLine" id="cb229-15" data-line-number="15">    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">select</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb229-16" data-line-number="16">    <span class="co">// trigger a click on corresponding the new tab button. </span></a>
<a class="sourceLine" id="cb229-17" data-line-number="17">      <span class="kw">let</span> newTabId <span class="op">=</span> <span class="va">$divTag</span>.<span class="at">attr</span>(<span class="st">&#39;id&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-18" data-line-number="18">      <span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">inputId</span> <span class="op">+</span> <span class="st">&#39; a[href=&quot;#&#39;</span> <span class="op">+</span> newTabId <span class="op">+</span><span class="st">&#39;&quot;]&#39;</span>).<span class="at">tab</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-19" data-line-number="19">    <span class="op">}</span></a>
<a class="sourceLine" id="cb229-20" data-line-number="20">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-21" data-line-number="21"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">tabler_page</span>(</a>
<a class="sourceLine" id="cb230-2" data-line-number="2">  tags<span class="op">$</span><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb230-3" data-line-number="3">    tags<span class="op">$</span><span class="kw">script</span>(</a>
<a class="sourceLine" id="cb230-4" data-line-number="4">      <span class="kw">HTML</span>(</a>
<a class="sourceLine" id="cb230-5" data-line-number="5">        <span class="st">&quot;$(function() {</span></a>
<a class="sourceLine" id="cb230-6" data-line-number="6"><span class="st">          Shiny.addCustomMessageHandler(&#39;insert-tab&#39;, function(message) {</span></a>
<a class="sourceLine" id="cb230-7" data-line-number="7"><span class="st">            // define div and li targets</span></a>
<a class="sourceLine" id="cb230-8" data-line-number="8"><span class="st">            let $divTag = $(message.content);</span></a>
<a class="sourceLine" id="cb230-9" data-line-number="9"><span class="st">            let $liTag = $(message.link);</span></a>
<a class="sourceLine" id="cb230-10" data-line-number="10"><span class="st">            </span></a>
<a class="sourceLine" id="cb230-11" data-line-number="11"><span class="st">            if (message.position === &#39;after&#39;) {</span></a>
<a class="sourceLine" id="cb230-12" data-line-number="12"><span class="st">              $divTag.insertAfter($(&#39;#&#39; + message.target));</span></a>
<a class="sourceLine" id="cb230-13" data-line-number="13"><span class="st">              $liTag.insertAfter($(&#39;[href =</span><span class="ch">\&quot;</span><span class="st">#&#39; + message.target + &#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).parent());</span></a>
<a class="sourceLine" id="cb230-14" data-line-number="14"><span class="st">            } else if (message.position === &#39;before&#39;) {</span></a>
<a class="sourceLine" id="cb230-15" data-line-number="15"><span class="st">              $divTag.insertBefore($(&#39;#&#39; + message.target));</span></a>
<a class="sourceLine" id="cb230-16" data-line-number="16"><span class="st">              $liTag.insertBefore($(&#39;[href =</span><span class="ch">\&quot;</span><span class="st">#&#39; + message.target + &#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).parent());</span></a>
<a class="sourceLine" id="cb230-17" data-line-number="17"><span class="st">            }</span></a>
<a class="sourceLine" id="cb230-18" data-line-number="18"><span class="st">            </span></a>
<a class="sourceLine" id="cb230-19" data-line-number="19"><span class="st">            if (message.select) {</span></a>
<a class="sourceLine" id="cb230-20" data-line-number="20"><span class="st">              // trigger a click on corresponding the new tab button. </span></a>
<a class="sourceLine" id="cb230-21" data-line-number="21"><span class="st">              let newTabId = $divTag.attr(&#39;id&#39;);</span></a>
<a class="sourceLine" id="cb230-22" data-line-number="22"><span class="st">              $(&#39;#&#39; + message.inputId + &#39; a[href=</span><span class="ch">\&quot;</span><span class="st">#&#39; + newTabId +&#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).tab(&#39;show&#39;);</span></a>
<a class="sourceLine" id="cb230-23" data-line-number="23"><span class="st">            }</span></a>
<a class="sourceLine" id="cb230-24" data-line-number="24"><span class="st">          });</span></a>
<a class="sourceLine" id="cb230-25" data-line-number="25"><span class="st">        });</span></a>
<a class="sourceLine" id="cb230-26" data-line-number="26"><span class="st">        &quot;</span></a>
<a class="sourceLine" id="cb230-27" data-line-number="27">      )</a>
<a class="sourceLine" id="cb230-28" data-line-number="28">    )</a>
<a class="sourceLine" id="cb230-29" data-line-number="29">  ),</a>
<a class="sourceLine" id="cb230-30" data-line-number="30">  <span class="kw">tabler_navbar</span>(</a>
<a class="sourceLine" id="cb230-31" data-line-number="31">    <span class="dt">brand_url =</span> <span class="st">&quot;https://preview-dev.tabler.io&quot;</span>, </a>
<a class="sourceLine" id="cb230-32" data-line-number="32">    <span class="dt">brand_image =</span> <span class="st">&quot;https://preview-dev.tabler.io/static/logo.svg&quot;</span>, </a>
<a class="sourceLine" id="cb230-33" data-line-number="33">    <span class="dt">nav_menu =</span> <span class="kw">tabler_navbar_menu</span>(</a>
<a class="sourceLine" id="cb230-34" data-line-number="34">      <span class="dt">inputId =</span> <span class="st">&quot;tabmenu&quot;</span>,</a>
<a class="sourceLine" id="cb230-35" data-line-number="35">      <span class="kw">tabler_navbar_menu_item</span>(</a>
<a class="sourceLine" id="cb230-36" data-line-number="36">        <span class="dt">text =</span> <span class="st">&quot;Tab 1&quot;</span>,</a>
<a class="sourceLine" id="cb230-37" data-line-number="37">        <span class="dt">icon =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb230-38" data-line-number="38">        <span class="dt">tabName =</span> <span class="st">&quot;tab1&quot;</span>,</a>
<a class="sourceLine" id="cb230-39" data-line-number="39">        <span class="dt">selected =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb230-40" data-line-number="40">      ),</a>
<a class="sourceLine" id="cb230-41" data-line-number="41">      <span class="kw">tabler_navbar_menu_item</span>(</a>
<a class="sourceLine" id="cb230-42" data-line-number="42">        <span class="dt">text =</span> <span class="st">&quot;Tab 2&quot;</span>,</a>
<a class="sourceLine" id="cb230-43" data-line-number="43">        <span class="dt">icon =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb230-44" data-line-number="44">        <span class="dt">tabName =</span> <span class="st">&quot;tab2&quot;</span></a>
<a class="sourceLine" id="cb230-45" data-line-number="45">      )</a>
<a class="sourceLine" id="cb230-46" data-line-number="46">    ),</a>
<a class="sourceLine" id="cb230-47" data-line-number="47">    <span class="kw">tabler_button</span>(<span class="st">&quot;insert&quot;</span>, <span class="st">&quot;Insert Tab&quot;</span>)</a>
<a class="sourceLine" id="cb230-48" data-line-number="48">  ),</a>
<a class="sourceLine" id="cb230-49" data-line-number="49">  <span class="kw">tabler_body</span>(</a>
<a class="sourceLine" id="cb230-50" data-line-number="50">    <span class="kw">tabler_tab_items</span>(</a>
<a class="sourceLine" id="cb230-51" data-line-number="51">      <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb230-52" data-line-number="52">        <span class="dt">tabName =</span> <span class="st">&quot;tab1&quot;</span>,</a>
<a class="sourceLine" id="cb230-53" data-line-number="53">        <span class="kw">p</span>(<span class="st">&quot;Hello World&quot;</span>)</a>
<a class="sourceLine" id="cb230-54" data-line-number="54">      ),</a>
<a class="sourceLine" id="cb230-55" data-line-number="55">      <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb230-56" data-line-number="56">        <span class="dt">tabName =</span> <span class="st">&quot;tab2&quot;</span>,</a>
<a class="sourceLine" id="cb230-57" data-line-number="57">        <span class="kw">p</span>(<span class="st">&quot;Second Tab&quot;</span>)</a>
<a class="sourceLine" id="cb230-58" data-line-number="58">      )</a>
<a class="sourceLine" id="cb230-59" data-line-number="59">    ),</a>
<a class="sourceLine" id="cb230-60" data-line-number="60">    <span class="dt">footer =</span> <span class="kw">tabler_footer</span>(</a>
<a class="sourceLine" id="cb230-61" data-line-number="61">      <span class="dt">left =</span> <span class="st">&quot;Rstats, 2020&quot;</span>, </a>
<a class="sourceLine" id="cb230-62" data-line-number="62">      <span class="dt">right =</span> <span class="kw">a</span>(<span class="dt">href =</span> <span class="st">&quot;https://www.google.com&quot;</span>)</a>
<a class="sourceLine" id="cb230-63" data-line-number="63">    )</a>
<a class="sourceLine" id="cb230-64" data-line-number="64">  )</a>
<a class="sourceLine" id="cb230-65" data-line-number="65">)</a>
<a class="sourceLine" id="cb230-66" data-line-number="66">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb230-67" data-line-number="67">  </a>
<a class="sourceLine" id="cb230-68" data-line-number="68">  output<span class="op">$</span>distPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb230-69" data-line-number="69">    <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>obs))</a>
<a class="sourceLine" id="cb230-70" data-line-number="70">  })</a>
<a class="sourceLine" id="cb230-71" data-line-number="71">  </a>
<a class="sourceLine" id="cb230-72" data-line-number="72">  <span class="kw">observeEvent</span>(input<span class="op">$</span>insert, {</a>
<a class="sourceLine" id="cb230-73" data-line-number="73">    <span class="kw">insert_tabler_tab</span>(</a>
<a class="sourceLine" id="cb230-74" data-line-number="74">      <span class="dt">inputId =</span> <span class="st">&quot;tabmenu&quot;</span>,</a>
<a class="sourceLine" id="cb230-75" data-line-number="75">      <span class="dt">tab =</span> <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb230-76" data-line-number="76">        <span class="dt">tabName =</span> <span class="st">&quot;tab3&quot;</span>,</a>
<a class="sourceLine" id="cb230-77" data-line-number="77">        <span class="kw">sliderInput</span>(<span class="st">&quot;obs&quot;</span>, <span class="st">&quot;Number of observations:&quot;</span>,</a>
<a class="sourceLine" id="cb230-78" data-line-number="78">                    <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1000</span>, <span class="dt">value =</span> <span class="dv">500</span></a>
<a class="sourceLine" id="cb230-79" data-line-number="79">        ),</a>
<a class="sourceLine" id="cb230-80" data-line-number="80">        <span class="kw">plotOutput</span>(<span class="st">&quot;distPlot&quot;</span>)</a>
<a class="sourceLine" id="cb230-81" data-line-number="81">      ),</a>
<a class="sourceLine" id="cb230-82" data-line-number="82">      <span class="dt">target =</span> <span class="st">&quot;tab2&quot;</span>,</a>
<a class="sourceLine" id="cb230-83" data-line-number="83">      <span class="dt">position =</span> <span class="st">&quot;before&quot;</span>,</a>
<a class="sourceLine" id="cb230-84" data-line-number="84">      <span class="dt">select =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb230-85" data-line-number="85">    )</a>
<a class="sourceLine" id="cb230-86" data-line-number="86">  })</a>
<a class="sourceLine" id="cb230-87" data-line-number="87">}</a>
<a class="sourceLine" id="cb230-88" data-line-number="88"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>If the tab is well inserted, we notice that the slider and the plot are not properly shown, as illustrated in Figure <a href="custom-templates-interactivity.html#fig:tabler-insert-tab-fail">15.4</a>.</p>
<div class="figure"><span id="fig:tabler-insert-tab-fail"></span>
<img src="images/practice/tabler-insert-tab-fail.png" alt="The newly inserted tab fails to render its content!" width="540" />
<p class="caption">
Figure 15.4: The newly inserted tab fails to render its content!
</p>
</div>
<p>How could we explain that? It is a dependency issue: the slider input relies on a specific JS <a href="http://ionden.com/a/plugins/ion.rangeSlider/">library</a>, namely ionRangesSlider, as depicted in Figure <a href="custom-templates-interactivity.html#fig:slider-deps">15.5</a>. In our previous example, if you open the HTML inspector, the dependency is not included in the page.</p>
<div class="figure"><span id="fig:slider-deps"></span>
<img src="images/practice/slider-deps.png" alt="Slider dependencies." width="1297" />
<p class="caption">
Figure 15.5: Slider dependencies.
</p>
</div>
<p>Even stranger, when we use <code>renderUI</code> to conditionally render the slider (note: this is a dummy example), the dependency is only included when the go button is pressed. How does Shiny includes them?</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb231-2" data-line-number="2">  shiny<span class="op">::</span><span class="kw">actionButton</span>(<span class="st">&quot;go&quot;</span>, <span class="st">&quot;Go!&quot;</span>, <span class="dt">class =</span> <span class="st">&quot;btn-success&quot;</span>),</a>
<a class="sourceLine" id="cb231-3" data-line-number="3">  <span class="kw">uiOutput</span>(<span class="st">&quot;slider&quot;</span>),</a>
<a class="sourceLine" id="cb231-4" data-line-number="4">  <span class="kw">plotOutput</span>(<span class="st">&quot;distPlot&quot;</span>)</a>
<a class="sourceLine" id="cb231-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb231-6" data-line-number="6"></a>
<a class="sourceLine" id="cb231-7" data-line-number="7"><span class="co"># Server logic</span></a>
<a class="sourceLine" id="cb231-8" data-line-number="8">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb231-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb231-10" data-line-number="10">  output<span class="op">$</span>slider &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</a>
<a class="sourceLine" id="cb231-11" data-line-number="11">    <span class="kw">req</span>(input<span class="op">$</span>go <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb231-12" data-line-number="12">    <span class="kw">sliderInput</span>(</a>
<a class="sourceLine" id="cb231-13" data-line-number="13">      <span class="st">&quot;obs&quot;</span>, </a>
<a class="sourceLine" id="cb231-14" data-line-number="14">      <span class="st">&quot;Number of observations:&quot;</span>,</a>
<a class="sourceLine" id="cb231-15" data-line-number="15">      <span class="dt">min =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb231-16" data-line-number="16">      <span class="dt">max =</span> <span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb231-17" data-line-number="17">      <span class="dt">value =</span> <span class="dv">500</span></a>
<a class="sourceLine" id="cb231-18" data-line-number="18">    )</a>
<a class="sourceLine" id="cb231-19" data-line-number="19">  })</a>
<a class="sourceLine" id="cb231-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb231-21" data-line-number="21">  output<span class="op">$</span>distPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb231-22" data-line-number="22">    <span class="kw">req</span>(input<span class="op">$</span>obs)</a>
<a class="sourceLine" id="cb231-23" data-line-number="23">    <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>obs))</a>
<a class="sourceLine" id="cb231-24" data-line-number="24">  })</a>
<a class="sourceLine" id="cb231-25" data-line-number="25">}</a>
<a class="sourceLine" id="cb231-26" data-line-number="26"></a>
<a class="sourceLine" id="cb231-27" data-line-number="27"><span class="co"># Complete app with UI and server components</span></a>
<a class="sourceLine" id="cb231-28" data-line-number="28"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>Let’s look at <code>renderUI</code>:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1">renderUI &lt;-<span class="st"> </span><span class="cf">function</span> (expr, <span class="dt">env =</span> <span class="kw">parent.frame</span>(), <span class="dt">quoted =</span> <span class="ot">FALSE</span>, <span class="dt">outputArgs =</span> <span class="kw">list</span>()) {</a>
<a class="sourceLine" id="cb232-2" data-line-number="2">    <span class="kw">installExprFunction</span>(expr, <span class="st">&quot;func&quot;</span>, env, quoted)</a>
<a class="sourceLine" id="cb232-3" data-line-number="3">    <span class="kw">createRenderFunction</span>(func, <span class="cf">function</span>(result, shinysession, </a>
<a class="sourceLine" id="cb232-4" data-line-number="4">        name, ...) {</a>
<a class="sourceLine" id="cb232-5" data-line-number="5">        <span class="cf">if</span> (<span class="kw">is.null</span>(result) <span class="op">||</span><span class="st"> </span><span class="kw">length</span>(result) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb232-6" data-line-number="6">            <span class="kw">return</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb232-7" data-line-number="7">        <span class="co">#shiny:::processDeps(result, shinysession)</span></a>
<a class="sourceLine" id="cb232-8" data-line-number="8">      result</a>
<a class="sourceLine" id="cb232-9" data-line-number="9">    }, uiOutput, outputArgs)</a>
<a class="sourceLine" id="cb232-10" data-line-number="10">}</a></code></pre></div>
<p>The last line returned is <code>processDeps(result, shinysession)</code>. This function is responsible to handle dependencies during runtime. <code>processDeps</code> (R side) works with <code>Shiny.renderContent</code> (JS side). The latter takes a tag element as well as an object containing its HTML code and dependencies, for instance:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb233-1" data-line-number="1"><span class="va">exports</span>.<span class="at">renderContent</span>($tag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb233-2" data-line-number="2">  <span class="dt">html</span><span class="op">:</span> <span class="va">$tag</span>.<span class="at">html</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb233-3" data-line-number="3">  <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">tag</span>.<span class="at">deps</span></a>
<a class="sourceLine" id="cb233-4" data-line-number="4"><span class="op">}</span>)<span class="op">;</span> </a></code></pre></div>
<p>In the following, we modify the <code>insert_tabler_tab</code> to include the dependencies processing step.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">insert_tabler_tab &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, tab, target, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>),</a>
<a class="sourceLine" id="cb234-2" data-line-number="2">                              <span class="dt">select =</span> <span class="ot">FALSE</span>, <span class="dt">session =</span> shiny<span class="op">::</span><span class="kw">getDefaultReactiveDomain</span>()) {</a>
<a class="sourceLine" id="cb234-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb234-4" data-line-number="4">  inputId &lt;-<span class="st"> </span>session<span class="op">$</span><span class="kw">ns</span>(inputId)</a>
<a class="sourceLine" id="cb234-5" data-line-number="5">  position &lt;-<span class="st"> </span><span class="kw">match.arg</span>(position)</a>
<a class="sourceLine" id="cb234-6" data-line-number="6">  navbar_menu_item &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">li</span>(</a>
<a class="sourceLine" id="cb234-7" data-line-number="7">    <span class="dt">class =</span> <span class="st">&quot;nav-item&quot;</span>,</a>
<a class="sourceLine" id="cb234-8" data-line-number="8">    <span class="kw">a</span>(</a>
<a class="sourceLine" id="cb234-9" data-line-number="9">      <span class="dt">class =</span> <span class="st">&quot;nav-link&quot;</span>,</a>
<a class="sourceLine" id="cb234-10" data-line-number="10">      <span class="dt">href =</span> <span class="kw">paste0</span>(<span class="st">&quot;#&quot;</span>, session<span class="op">$</span><span class="kw">ns</span>(tab<span class="op">$</span>attribs<span class="op">$</span>id)),</a>
<a class="sourceLine" id="cb234-11" data-line-number="11">      <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;pill&quot;</span>,</a>
<a class="sourceLine" id="cb234-12" data-line-number="12">      <span class="st">`</span><span class="dt">data-value</span><span class="st">`</span> =<span class="st"> </span>tab<span class="op">$</span>attribs<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb234-13" data-line-number="13">      <span class="dt">role =</span> <span class="st">&quot;tab&quot;</span>,</a>
<a class="sourceLine" id="cb234-14" data-line-number="14">      tab<span class="op">$</span>attribs<span class="op">$</span>id</a>
<a class="sourceLine" id="cb234-15" data-line-number="15">    )</a>
<a class="sourceLine" id="cb234-16" data-line-number="16">  )</a>
<a class="sourceLine" id="cb234-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb234-18" data-line-number="18">  message &lt;-<span class="st"> </span>shiny<span class="op">:::</span><span class="kw">dropNulls</span>(</a>
<a class="sourceLine" id="cb234-19" data-line-number="19">    <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb234-20" data-line-number="20">      <span class="dt">inputId =</span> inputId,</a>
<a class="sourceLine" id="cb234-21" data-line-number="21">      <span class="dt">content =</span> shiny<span class="op">:::</span><span class="kw">processDeps</span>(tab, session),</a>
<a class="sourceLine" id="cb234-22" data-line-number="22">      <span class="dt">link =</span> shiny<span class="op">:::</span><span class="kw">processDeps</span>(navbar_menu_item, session),</a>
<a class="sourceLine" id="cb234-23" data-line-number="23">      <span class="dt">target =</span> target,</a>
<a class="sourceLine" id="cb234-24" data-line-number="24">      <span class="dt">position =</span> position,</a>
<a class="sourceLine" id="cb234-25" data-line-number="25">      <span class="dt">select =</span> select</a>
<a class="sourceLine" id="cb234-26" data-line-number="26">    )</a>
<a class="sourceLine" id="cb234-27" data-line-number="27">  )</a>
<a class="sourceLine" id="cb234-28" data-line-number="28">  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;insert-tab&quot;</span>, message)</a>
<a class="sourceLine" id="cb234-29" data-line-number="29">}</a></code></pre></div>
<p>We then apply the <code>Shiny.renderContent</code> method to the tab content and navigation item.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb235-1" data-line-number="1"><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb235-2" data-line-number="2">  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;insert-tab&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb235-3" data-line-number="3">  <span class="co">// define div and li targets</span></a>
<a class="sourceLine" id="cb235-4" data-line-number="4">    <span class="kw">let</span> $divTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="va">content</span>.<span class="at">html</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-5" data-line-number="5">    <span class="kw">let</span> $liTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="va">link</span>.<span class="at">html</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-6" data-line-number="6">    </a>
<a class="sourceLine" id="cb235-7" data-line-number="7">    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;after&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb235-8" data-line-number="8">      <span class="va">$divTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb235-9" data-line-number="9">      <span class="va">$liTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span>   <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb235-10" data-line-number="10">    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;before&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb235-11" data-line-number="11">      <span class="va">$divTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb235-12" data-line-number="12">      <span class="va">$liTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span>   <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb235-13" data-line-number="13">    <span class="op">}</span></a>
<a class="sourceLine" id="cb235-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb235-15" data-line-number="15">      <span class="co">// needed to render input/output in newly added tab. It takes the possible</span></a>
<a class="sourceLine" id="cb235-16" data-line-number="16">      <span class="co">// deps and add them to the tag. Indeed, if we insert a tab, its deps are not</span></a>
<a class="sourceLine" id="cb235-17" data-line-number="17">      <span class="co">// included in the page so it can&#39;t render properly</span></a>
<a class="sourceLine" id="cb235-18" data-line-number="18">      <span class="va">Shiny</span>.<span class="at">renderContent</span>($liTag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span><span class="dt">html</span><span class="op">:</span> <span class="va">$liTag</span>.<span class="at">html</span>()<span class="op">,</span> <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">link</span>.<span class="at">deps</span><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-19" data-line-number="19">      <span class="va">Shiny</span>.<span class="at">renderContent</span>($divTag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span><span class="dt">html</span><span class="op">:</span> <span class="va">$divTag</span>.<span class="at">html</span>()<span class="op">,</span> <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">content</span>.<span class="at">deps</span><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-20" data-line-number="20">    </a>
<a class="sourceLine" id="cb235-21" data-line-number="21">    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">select</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb235-22" data-line-number="22">    <span class="co">// trigger a click on corresponding the new tab button. </span></a>
<a class="sourceLine" id="cb235-23" data-line-number="23">    <span class="kw">let</span> newTabId <span class="op">=</span> <span class="va">$divTag</span>.<span class="at">attr</span>(<span class="st">&#39;id&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-24" data-line-number="24">      <span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">inputId</span> <span class="op">+</span> <span class="st">&#39; a[href=&quot;#&#39;</span> <span class="op">+</span> newTabId   <span class="op">+</span><span class="st">&#39;&quot;]&#39;</span>).<span class="at">tab</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-25" data-line-number="25">    <span class="op">}</span></a>
<a class="sourceLine" id="cb235-26" data-line-number="26">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb235-27" data-line-number="27"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>We check if our approach works as expected.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">tabler_page</span>(</a>
<a class="sourceLine" id="cb236-2" data-line-number="2">  tags<span class="op">$</span><span class="kw">head</span>(</a>
<a class="sourceLine" id="cb236-3" data-line-number="3">    tags<span class="op">$</span><span class="kw">script</span>(</a>
<a class="sourceLine" id="cb236-4" data-line-number="4">      <span class="kw">HTML</span>(</a>
<a class="sourceLine" id="cb236-5" data-line-number="5">        <span class="st">&quot;$(function() {</span></a>
<a class="sourceLine" id="cb236-6" data-line-number="6"><span class="st">          Shiny.addCustomMessageHandler(&#39;insert-tab&#39;, function(message) {</span></a>
<a class="sourceLine" id="cb236-7" data-line-number="7"><span class="st">            console.log(message.content.deps);</span></a>
<a class="sourceLine" id="cb236-8" data-line-number="8"><span class="st">            // define div and li targets</span></a>
<a class="sourceLine" id="cb236-9" data-line-number="9"><span class="st">            let $divTag = $(message.content.html);</span></a>
<a class="sourceLine" id="cb236-10" data-line-number="10"><span class="st">            let $liTag = $(message.link.html);</span></a>
<a class="sourceLine" id="cb236-11" data-line-number="11"><span class="st">            </span></a>
<a class="sourceLine" id="cb236-12" data-line-number="12"><span class="st">            if (message.position === &#39;after&#39;) {</span></a>
<a class="sourceLine" id="cb236-13" data-line-number="13"><span class="st">              $divTag.insertAfter($(&#39;#&#39; + message.target));</span></a>
<a class="sourceLine" id="cb236-14" data-line-number="14"><span class="st">              $liTag.insertAfter($(&#39;[href =</span><span class="ch">\&quot;</span><span class="st">#&#39; + message.target + &#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).parent());</span></a>
<a class="sourceLine" id="cb236-15" data-line-number="15"><span class="st">            } else if (message.position === &#39;before&#39;) {</span></a>
<a class="sourceLine" id="cb236-16" data-line-number="16"><span class="st">              $divTag.insertBefore($(&#39;#&#39; + message.target));</span></a>
<a class="sourceLine" id="cb236-17" data-line-number="17"><span class="st">              $liTag.insertBefore($(&#39;[href =</span><span class="ch">\&quot;</span><span class="st">#&#39; + message.target + &#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).parent());</span></a>
<a class="sourceLine" id="cb236-18" data-line-number="18"><span class="st">            }</span></a>
<a class="sourceLine" id="cb236-19" data-line-number="19"><span class="st">            </span></a>
<a class="sourceLine" id="cb236-20" data-line-number="20"><span class="st">            // needed to render input/output in newly added tab. It takes the possible</span></a>
<a class="sourceLine" id="cb236-21" data-line-number="21"><span class="st">            // deps and add them to the tag. Indeed, if we insert a tab, its deps are not</span></a>
<a class="sourceLine" id="cb236-22" data-line-number="22"><span class="st">            // included in the page so it can&#39;t render properly</span></a>
<a class="sourceLine" id="cb236-23" data-line-number="23"><span class="st">            Shiny.renderContent($liTag[0], {html: $liTag.html(), deps: message.link.deps});</span></a>
<a class="sourceLine" id="cb236-24" data-line-number="24"><span class="st">            Shiny.renderContent($divTag[0], {html: $divTag.html(), deps: message.content.deps});</span></a>
<a class="sourceLine" id="cb236-25" data-line-number="25"><span class="st">            </span></a>
<a class="sourceLine" id="cb236-26" data-line-number="26"><span class="st">            if (message.select) {</span></a>
<a class="sourceLine" id="cb236-27" data-line-number="27"><span class="st">              // trigger a click on corresponding the new tab button. </span></a>
<a class="sourceLine" id="cb236-28" data-line-number="28"><span class="st">              let newTabId = $divTag.attr(&#39;id&#39;);</span></a>
<a class="sourceLine" id="cb236-29" data-line-number="29"><span class="st">              $(&#39;#&#39; + message.inputId + &#39; a[href=</span><span class="ch">\&quot;</span><span class="st">#&#39; + newTabId +&#39;</span><span class="ch">\&quot;</span><span class="st">]&#39;).tab(&#39;show&#39;);</span></a>
<a class="sourceLine" id="cb236-30" data-line-number="30"><span class="st">            }</span></a>
<a class="sourceLine" id="cb236-31" data-line-number="31"><span class="st">          });</span></a>
<a class="sourceLine" id="cb236-32" data-line-number="32"><span class="st">        });</span></a>
<a class="sourceLine" id="cb236-33" data-line-number="33"><span class="st">        &quot;</span></a>
<a class="sourceLine" id="cb236-34" data-line-number="34">      )</a>
<a class="sourceLine" id="cb236-35" data-line-number="35">    )</a>
<a class="sourceLine" id="cb236-36" data-line-number="36">  ),</a>
<a class="sourceLine" id="cb236-37" data-line-number="37">  <span class="kw">tabler_navbar</span>(</a>
<a class="sourceLine" id="cb236-38" data-line-number="38">    <span class="dt">brand_url =</span> <span class="st">&quot;https://preview-dev.tabler.io&quot;</span>, </a>
<a class="sourceLine" id="cb236-39" data-line-number="39">    <span class="dt">brand_image =</span> <span class="st">&quot;https://preview-dev.tabler.io/static/logo.svg&quot;</span>, </a>
<a class="sourceLine" id="cb236-40" data-line-number="40">    <span class="dt">nav_menu =</span> <span class="kw">tabler_navbar_menu</span>(</a>
<a class="sourceLine" id="cb236-41" data-line-number="41">      <span class="dt">inputId =</span> <span class="st">&quot;tabmenu&quot;</span>,</a>
<a class="sourceLine" id="cb236-42" data-line-number="42">      <span class="kw">tabler_navbar_menu_item</span>(</a>
<a class="sourceLine" id="cb236-43" data-line-number="43">        <span class="dt">text =</span> <span class="st">&quot;Tab 1&quot;</span>,</a>
<a class="sourceLine" id="cb236-44" data-line-number="44">        <span class="dt">icon =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb236-45" data-line-number="45">        <span class="dt">tabName =</span> <span class="st">&quot;tab1&quot;</span>,</a>
<a class="sourceLine" id="cb236-46" data-line-number="46">        <span class="dt">selected =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb236-47" data-line-number="47">      ),</a>
<a class="sourceLine" id="cb236-48" data-line-number="48">      <span class="kw">tabler_navbar_menu_item</span>(</a>
<a class="sourceLine" id="cb236-49" data-line-number="49">        <span class="dt">text =</span> <span class="st">&quot;Tab 2&quot;</span>,</a>
<a class="sourceLine" id="cb236-50" data-line-number="50">        <span class="dt">icon =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb236-51" data-line-number="51">        <span class="dt">tabName =</span> <span class="st">&quot;tab2&quot;</span></a>
<a class="sourceLine" id="cb236-52" data-line-number="52">      )</a>
<a class="sourceLine" id="cb236-53" data-line-number="53">    ),</a>
<a class="sourceLine" id="cb236-54" data-line-number="54">    <span class="kw">tabler_button</span>(<span class="st">&quot;insert&quot;</span>, <span class="st">&quot;Insert Tab&quot;</span>)</a>
<a class="sourceLine" id="cb236-55" data-line-number="55">  ),</a>
<a class="sourceLine" id="cb236-56" data-line-number="56">  <span class="kw">tabler_body</span>(</a>
<a class="sourceLine" id="cb236-57" data-line-number="57">    <span class="kw">tabler_tab_items</span>(</a>
<a class="sourceLine" id="cb236-58" data-line-number="58">      <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb236-59" data-line-number="59">        <span class="dt">tabName =</span> <span class="st">&quot;tab1&quot;</span>,</a>
<a class="sourceLine" id="cb236-60" data-line-number="60">        <span class="kw">p</span>(<span class="st">&quot;Hello World&quot;</span>)</a>
<a class="sourceLine" id="cb236-61" data-line-number="61">      ),</a>
<a class="sourceLine" id="cb236-62" data-line-number="62">      <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb236-63" data-line-number="63">        <span class="dt">tabName =</span> <span class="st">&quot;tab2&quot;</span>,</a>
<a class="sourceLine" id="cb236-64" data-line-number="64">        <span class="kw">p</span>(<span class="st">&quot;Second Tab&quot;</span>)</a>
<a class="sourceLine" id="cb236-65" data-line-number="65">      )</a>
<a class="sourceLine" id="cb236-66" data-line-number="66">    ),</a>
<a class="sourceLine" id="cb236-67" data-line-number="67">    <span class="dt">footer =</span> <span class="kw">tabler_footer</span>(</a>
<a class="sourceLine" id="cb236-68" data-line-number="68">      <span class="dt">left =</span> <span class="st">&quot;Rstats, 2020&quot;</span>, </a>
<a class="sourceLine" id="cb236-69" data-line-number="69">      <span class="dt">right =</span> <span class="kw">a</span>(<span class="dt">href =</span> <span class="st">&quot;https://www.google.com&quot;</span>)</a>
<a class="sourceLine" id="cb236-70" data-line-number="70">    )</a>
<a class="sourceLine" id="cb236-71" data-line-number="71">  )</a>
<a class="sourceLine" id="cb236-72" data-line-number="72">)</a>
<a class="sourceLine" id="cb236-73" data-line-number="73">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb236-74" data-line-number="74">  </a>
<a class="sourceLine" id="cb236-75" data-line-number="75">  output<span class="op">$</span>distPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb236-76" data-line-number="76">    <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>obs))</a>
<a class="sourceLine" id="cb236-77" data-line-number="77">  })</a>
<a class="sourceLine" id="cb236-78" data-line-number="78">  </a>
<a class="sourceLine" id="cb236-79" data-line-number="79">  <span class="kw">observeEvent</span>(input<span class="op">$</span>insert, {</a>
<a class="sourceLine" id="cb236-80" data-line-number="80">    <span class="kw">insert_tabler_tab</span>(</a>
<a class="sourceLine" id="cb236-81" data-line-number="81">      <span class="dt">inputId =</span> <span class="st">&quot;tabmenu&quot;</span>,</a>
<a class="sourceLine" id="cb236-82" data-line-number="82">      <span class="dt">tab =</span> <span class="kw">tabler_tab_item</span>(</a>
<a class="sourceLine" id="cb236-83" data-line-number="83">        <span class="dt">tabName =</span> <span class="st">&quot;tab3&quot;</span>,</a>
<a class="sourceLine" id="cb236-84" data-line-number="84">        <span class="kw">sliderInput</span>(<span class="st">&quot;obs&quot;</span>, <span class="st">&quot;Number of observations:&quot;</span>,</a>
<a class="sourceLine" id="cb236-85" data-line-number="85">                    <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1000</span>, <span class="dt">value =</span> <span class="dv">500</span></a>
<a class="sourceLine" id="cb236-86" data-line-number="86">        ),</a>
<a class="sourceLine" id="cb236-87" data-line-number="87">        <span class="kw">plotOutput</span>(<span class="st">&quot;distPlot&quot;</span>)</a>
<a class="sourceLine" id="cb236-88" data-line-number="88">      ),</a>
<a class="sourceLine" id="cb236-89" data-line-number="89">      <span class="dt">target =</span> <span class="st">&quot;tab2&quot;</span>,</a>
<a class="sourceLine" id="cb236-90" data-line-number="90">      <span class="dt">position =</span> <span class="st">&quot;before&quot;</span>,</a>
<a class="sourceLine" id="cb236-91" data-line-number="91">      <span class="dt">select =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb236-92" data-line-number="92">    )</a>
<a class="sourceLine" id="cb236-93" data-line-number="93">  })</a>
<a class="sourceLine" id="cb236-94" data-line-number="94">}</a>
<a class="sourceLine" id="cb236-95" data-line-number="95"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<div class="figure"><span id="fig:process-deps"></span>
<img src="images/practice/process-deps.png" alt="processDeps and Shiny.renderContent in action." width="1297" />
<p class="caption">
Figure 15.6: processDeps and Shiny.renderContent in action.
</p>
</div>
<p>Et voila! As shown in Figure <a href="custom-templates-interactivity.html#fig:process-deps">15.6</a>, everything is properly displayed.</p>
</div>
</div>
<div id="exercises-2" class="section level2">
<h2><span class="header-section-number">15.5</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Taking inspiration on the <code>insert_tabler_tab</code> function, write the <code>remove_tabler_tab</code> function.</li>
<li>Based on the Tabler <a href="https://preview-dev.tabler.io/docs/tooltips.html">documentation</a>, add the <code>tabler_tooltip</code> function. Hint: you may also check the corresponding Bootstrap 4 help.</li>
</ol>

</div>
</div>




</div>
            </section>

          </div>
        </div>
      </div>
<a href="custom-templates-inputs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beautify-with-fresh.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/custom-templates-interactivity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["outstanding-shiny-ui.pdf", "outstanding-shiny-ui.epub", "outstanding-shiny-ui.mobi"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
