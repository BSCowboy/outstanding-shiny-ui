# JavaScript {#survival-kit-javascript}

## Introduction 
JavaScript (JS) was created in 1995 by Brendan Eich and also known as ECMAScript (ES). Interestingly, you might have heard about ActionScript, which is no more than an implementation of ES by Adobe Systems. Nowadays, JavaScript is a centerpiece of the web and included in almost all websites. 

Let's make a little experiment. If you have a personal blog (it is very popular in the RStats community) you probably know Hugo or Jekyll. These tools allow to quickly setup professionnal looking (or at least not too ugly) blogs in literraly few minutes. You can focus on the content and this is what matters! Now, if you open the HTML inspector introduced in Chapter \@ref(survival-kit-html), click on the elements tab (in theory it is the first tab and open by default), and uncollapse the `<head>` tag, you see that a lot of scripts are included, as shown in Figure \@ref(fig:scripts-list). Same remark in the `<body>` tag.

```{r scripts-list, echo=FALSE, fig.cap='A website is full of JavaScript'}
knitr::include_graphics("images/survival-kit/scripts-list.png")
```

There are 2 ways to include scripts:

  - Use the `<script>` tag with the JS code inside
  - Import an external file containing the JS code and only
  
```html
<script type="text/javascript">
// JS code here
</script>
```

```html
<!-- We use the src attribute to link the external file -->
<script type="text/javascript" src="file.js">
```

Whether to choose the first or second method depends on the content of your script. If we consider jQuery, a well known JS library, it contains so much lines of code that it does not make sense to select the first method. 

## Setup
Like R or Python, JavaScript is an interpreted language. It is also executed client side, that is in the navigator. It also means that you cannot run js code without suitable tools. 

### Node
[Node](https://nodejs.org/en/) contains an interpreter for JS as well as a dependencies manager, npm (Node Package Manager). To install Node on your computer, browse to the website and follow the intruction. Once done, open a terminal and check if

```
$ which node
$ node --version
```
returns something. If not, it means that Node is not properly installed. 

### Choose a good IDE
I really like [VSCode](https://code.visualstudio.com) for all the JS things since it contains a Node interpreter and you can seamlessly execute any JS code (the truth is because I'm a big fan of the dracula color theme). But the [Rstudio IDE](https://rstudio.com/products/rstudio/) may also be fine, provided that you have Node installed. Below, we will see how to run a JS code in both IDE.

### First Script
Let's write our first script:

```javascript
console.log("Hello World");
```

You notice that all instruction end by `;`. You can run this script either in Rstudio IDE or VSCode. 

```{r script-vscode, echo=FALSE, fig.cap='Run JS in VSCode'}
knitr::include_graphics("images/survival-kit/script-vscode.png")
```

In VSCode, clicking on the run arrow (top center) of Figure \@ref(fig:script-vscode),
triggers the `node hello.js` command, which tells Node to run my script. We see the result in the right panel (code=0 means the execution is fine and we even have the compute time). To run this script in the RStudio IDE, you need to click on the terminal tab (you could also open a basic terminal) and type `node hello.js` (or `node mycustompath/hello.js` if you are not in the folder containing the script). You should see the Hello World message in the console (see Figure \@ref(fig:script-rstudio)).

```{r script-rstudio, echo=FALSE, fig.cap='Run JS in a terminal'}
knitr::include_graphics("images/survival-kit/script-rstudio.png")
```

## Programming with JS: basis
We are now all set to introduce the basis of JS. As many languages, JS is made of variables and instructions (We saw above that instructions end by `;`).

### JS types
JS defines several types:

  - Number: does not distinguish between integers and others (in R for instance, numeric contains integers and double)
  - String: characters ('blabla')
  - Boolean: true/false
  
To check the type of an element, we may use the `typeof` operator (this is not a function like the `typeof` function in R).

```javascript
typeof 1; // number
typeof 'pouic'; // string
```

### Variables
A variable is defined by:

  - a type
  - a name
  - a value

<br>
<div class="callout callout-danger">
Valid variable names: 
<ul>
<li>don't use an existing name like typeof</li>
<li>son't start with a number (123)</li>
<li>don't include any space (total price)</li>
</ul>
</div>
<br>

Based on the above forbidden items, you can use the camelCase syntax to write your variables in JS. To set a variable we use `let` (there exists `var` but this is not the latest JS norm (ES6). You will see later that we still use `var` in the shiny core and many other R packages):

```javascript
let myVariable = 'welcome';
console.log(myVariable);
```

Then we can use all mathematical operators to manipulate a variable.

```javascript
let myNumber = 1; // affectation
myNumber--; // decrement
console.log(myNumber); // print 0
```

<br>
<div class="callout callout-info">
List of numerical operators in JS: 
<ul>
<li>+</li>
<li>-</li>
<li>*</li>
<li>/</li>
<li>% (modulo)</li>
<li>++ (incrementation)</li>
<li>-- (decrementation)</li>
</ul>
</div>
<br>

To concatenate 2 strings, use `+`.

### Conditions
Below are the operators to check conditions.

<br>
<div class="callout callout-info">
<ul>
<li>== (A equal B)</li>
<li>!= (A not equal to B)</li>
<li>> (>=)</li>
<li>< (<=)</li>
<li>AND (A AND B)</li>
<li>OR (A OR B)</li>
</ul>
</div>
<br>

To test conditions there exists several ways:

  - `if (condition) { console.log('Test passed'); }`
  - `if (condition) { instruction A} else { instruction B }`
  
This is very common to other languages (and R for instance). Whenever a lot of possible conditions need to be evaluated, it is better to choose the `switch`.


```javascript
switch (variable) {
  case val1: // instruction 1
  break; // don't forget the break!
  case val2:  // instruction 2
  break;
  default: // when none of val1 and val2 are satisfied
}
```

### Iterations
